<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reggie's Adventure â€” Redesign v5</title>
<link href="https://fonts.googleapis.com/css2?family=Crimson+Text:ital,wght@0,400;0,600;0,700;1,400&family=Inter:wght@300;400;500&family=JetBrains+Mono:wght@300;400&display=swap" rel="stylesheet">
<style>
*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

:root {
  --void: #0d1117;
  --moss: #2d5a3d;
  --lichen: #7fb069;
  --amber: #d4a574;
  --rust: #8b4513;
  --mist: #b8c4d0;
  --ghost: #5a6670;
  --glow: #e8d5b7;
  --ember: #c75b39;
  --frost: #9bb8d3;
  --water: #4a90d9;
}

html, body {
  width: 100%; height: 100%;
  background: var(--void);
  color: var(--mist);
  font-family: 'Inter', sans-serif;
  font-weight: 300;
  overflow: hidden;
}

/* â”€â”€ Tab Navigation â”€â”€ */
.tab-nav {
  position: fixed; top: 0; left: 0; right: 0; z-index: 100;
  display: flex; justify-content: center; gap: 2px;
  padding: 16px 24px;
  background: linear-gradient(to bottom, rgba(13,17,23,0.95) 60%, transparent);
  pointer-events: none;
}
.tab-nav button {
  pointer-events: all;
  font-family: 'Crimson Text', serif;
  font-size: 14px; letter-spacing: 2px; text-transform: uppercase;
  color: var(--ghost);
  background: none; border: none; cursor: pointer;
  padding: 8px 20px;
  transition: color 0.6s, border-color 0.6s;
  border-bottom: 1px solid transparent;
  position: relative;
}
.tab-nav button:hover { color: var(--amber); }
.tab-nav button.active {
  color: var(--glow);
  border-bottom-color: var(--amber);
}

/* â”€â”€ Type Selector (floating UI) â”€â”€ */
.type-selector {
  position: fixed; bottom: 20px; right: 20px; z-index: 200;
  display: flex; gap: 6px;
  background: rgba(13,17,23,0.85);
  border: 1px solid rgba(232,213,183,0.1);
  border-radius: 30px;
  padding: 6px 10px;
  backdrop-filter: blur(8px);
}
.type-selector button {
  font-family: 'JetBrains Mono', monospace;
  font-size: 10px; letter-spacing: 1px; text-transform: uppercase;
  color: var(--ghost);
  background: none; border: 1px solid transparent;
  padding: 6px 14px; border-radius: 20px;
  cursor: pointer; transition: all 0.4s;
}
.type-selector button:hover { color: var(--mist); }
.type-selector button.active {
  color: var(--glow);
  border-color: rgba(232,213,183,0.2);
  background: rgba(232,213,183,0.06);
}

/* â”€â”€ Screens â”€â”€ */
.screen {
  position: absolute; inset: 0;
  opacity: 0; pointer-events: none;
  transition: opacity 0.8s ease-in-out;
  overflow: hidden;
}
.screen.active { opacity: 1; pointer-events: all; }

/* â”€â”€ Background image layers â”€â”€ */
.screen-bg {
  position: absolute; inset: 0; z-index: 0;
}
.screen-bg img {
  position: absolute; inset: 0;
  width: 100%; height: 100%;
  object-fit: cover;
  transition: opacity 1.5s ease;
}
.screen-bg-overlay {
  position: absolute; inset: 0; z-index: 1;
  background: rgba(13,17,23,0.4);
  pointer-events: none;
}

/* â”€â”€ Reggie Sprite â”€â”€ */
.reggie-sprite {
  image-rendering: auto;
  filter: drop-shadow(0 0 20px rgba(232,213,183,0.3));
  animation: spriteBreath 5s ease-in-out infinite;
}
@keyframes spriteBreath {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.02); }
}

/* â”€â”€ Vignette â”€â”€ */
.vignette {
  position: absolute; inset: 0; pointer-events: none; z-index: 10;
  background: radial-gradient(ellipse at center, transparent 40%, rgba(13,17,23,0.7) 100%);
}

/* â”€â”€ Particle Canvas â”€â”€ */
.particle-canvas {
  position: absolute; inset: 0; z-index: 1; pointer-events: none;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SCREEN 1 â€” UMBRAL (Title)
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#umbral {
  display: flex; flex-direction: column;
  align-items: center; justify-content: center;
}
#umbral .screen-bg-overlay {
  background: linear-gradient(to top,
    rgba(10,14,19,0.85) 0%,
    rgba(13,17,23,0.5) 40%,
    rgba(13,17,23,0.6) 100%
  );
}

/* Landscape layers */
.umbral-landscape {
  position: absolute; bottom: 0; left: 0; right: 0; height: 55%;
  z-index: 2;
}
.umbral-layer {
  position: absolute; bottom: 0; left: 0; right: 0;
}
.umbral-far {
  height: 40%;
  background:
    linear-gradient(85deg, transparent 10%, #151e28 10%, #151e28 12%, transparent 12%),
    linear-gradient(92deg, transparent 30%, #131b24 30%, #131b24 33%, transparent 33%),
    linear-gradient(88deg, transparent 55%, #141c26 55%, #141c26 58%, transparent 58%),
    linear-gradient(95deg, transparent 75%, #151e28 75%, #151e28 77%, transparent 77%),
    linear-gradient(to top, #121922 0%, transparent 100%);
  opacity: 0.8;
}
.umbral-mid {
  height: 28%;
  background: linear-gradient(to top, #0e151d 0%, transparent 70%);
  opacity: 0.9;
}
.umbral-veg {
  position: absolute; bottom: 28%; left: 0; right: 0; height: 15%;
  z-index: 3;
}
.umbral-veg::before, .umbral-veg::after {
  content: ''; position: absolute; bottom: 0;
  border-radius: 50% 50% 0 0;
}
.umbral-veg::before {
  left: 9%; width: 30px; height: 50px;
  background: radial-gradient(ellipse at bottom, rgba(45,90,61,0.3), transparent);
}
.umbral-veg::after {
  left: 54%; width: 40px; height: 60px;
  background: radial-gradient(ellipse at bottom, rgba(45,90,61,0.25), transparent);
}
.umbral-near {
  height: 12%;
  background: linear-gradient(to top, var(--void) 30%, #0e151d 100%);
}
.umbral-fog {
  position: absolute; bottom: 10%; left: 0; right: 0; height: 40%;
  background: linear-gradient(to top, transparent, rgba(184,196,208,0.04) 40%, rgba(184,196,208,0.06) 60%, transparent);
  animation: fogDrift 12s ease-in-out infinite alternate;
  z-index: 4;
}
@keyframes fogDrift {
  0% { transform: translateX(-3%); opacity: 0.7; }
  100% { transform: translateX(3%); opacity: 1; }
}

/* Title */
.umbral-title {
  position: relative; z-index: 20;
  font-family: 'Crimson Text', serif;
  font-size: clamp(48px, 5vw, 80px);
  font-weight: 400;
  color: var(--glow);
  letter-spacing: 4px;
  text-align: center;
  margin-bottom: 12px;
  animation: titleFadeIn 2.5s ease-out both;
  text-shadow: 0 0 60px rgba(232,213,183,0.15), 0 0 120px rgba(212,165,116,0.08);
}
.umbral-subtitle {
  position: relative; z-index: 20;
  font-family: 'JetBrains Mono', monospace;
  font-size: 12px; font-weight: 300;
  color: var(--ghost);
  letter-spacing: 6px; text-transform: uppercase;
  margin-bottom: 60px;
  animation: titleFadeIn 2.5s 0.5s ease-out both;
  opacity: 0;
}
@keyframes titleFadeIn {
  0% { opacity: 0; transform: translateY(20px); }
  100% { opacity: 1; transform: translateY(0); }
}
.btn-comenzar {
  position: relative; z-index: 20;
  font-family: 'Crimson Text', serif;
  font-size: 18px; letter-spacing: 3px;
  color: var(--amber);
  background: rgba(212,165,116,0.06);
  border: 1px solid rgba(212,165,116,0.15);
  padding: 14px 48px;
  cursor: pointer;
  border-radius: 40px;
  transition: all 0.6s ease;
  animation: titleFadeIn 2.5s 1s ease-out both;
  opacity: 0;
}
.btn-comenzar:hover {
  background: rgba(212,165,116,0.12);
  border-color: rgba(212,165,116,0.3);
  box-shadow: 0 0 40px rgba(212,165,116,0.1);
  transform: scale(1.03);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SCREEN 2 â€” EL MUNDO (Home)
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#mundo {
  background: var(--void);
}

/* 4-state crossfade background system */
.mundo-bg-states {
  position: absolute; inset: 0; z-index: 0;
}
.mundo-bg-states img {
  position: absolute; inset: 0;
  width: 100%; height: 100%;
  object-fit: cover;
  opacity: 0;
  transition: opacity 1.5s ease;
}
.mundo-bg-states img.bg-active { opacity: 1; }
.mundo-bg-overlay {
  position: absolute; inset: 0; z-index: 1;
  background: linear-gradient(to top,
    rgba(13,17,23,0.7) 0%,
    rgba(13,17,23,0.3) 40%,
    rgba(13,17,23,0.4) 100%
  );
  pointer-events: none;
}

/* Regen slider */
.regen-slider-container {
  position: absolute; bottom: 30px; left: 50%;
  transform: translateX(-50%);
  z-index: 25;
  display: flex; align-items: center; gap: 12px;
  background: rgba(13,17,23,0.7);
  border: 1px solid rgba(232,213,183,0.1);
  border-radius: 30px;
  padding: 8px 20px;
  backdrop-filter: blur(6px);
}
.regen-slider-label {
  font-family: 'JetBrains Mono', monospace;
  font-size: 9px; letter-spacing: 2px; text-transform: uppercase;
  color: var(--ghost);
  white-space: nowrap;
}
.regen-slider {
  -webkit-appearance: none; appearance: none;
  width: 160px; height: 3px;
  background: rgba(232,213,183,0.15);
  border-radius: 2px; outline: none;
  cursor: pointer;
}
.regen-slider::-webkit-slider-thumb {
  -webkit-appearance: none; appearance: none;
  width: 14px; height: 14px; border-radius: 50%;
  background: var(--amber);
  box-shadow: 0 0 10px rgba(212,165,116,0.4);
  cursor: pointer;
}
.regen-slider::-moz-range-thumb {
  width: 14px; height: 14px; border-radius: 50%;
  background: var(--amber); border: none;
  box-shadow: 0 0 10px rgba(212,165,116,0.4);
  cursor: pointer;
}
.regen-value {
  font-family: 'JetBrains Mono', monospace;
  font-size: 11px; color: var(--glow);
  min-width: 30px; text-align: right;
}

.mundo-parallax {
  position: absolute; inset: 0;
  perspective: 1000px;
  transform-style: preserve-3d;
  z-index: 2;
}
.mundo-layer {
  position: absolute; inset: -40px;
  transition: transform 0.3s ease-out;
  will-change: transform;
}
.mundo-sky {
  background: transparent;
}
.mundo-ruins { z-index: 1; }
.ruin {
  position: absolute; bottom: 30%;
  background: rgba(20,28,38,0.6);
  opacity: 0.6;
}
.ruin-1 { left: 5%; width: 60px; height: 180px; clip-path: polygon(10% 100%, 0 20%, 30% 0, 60% 5%, 100% 30%, 90% 100%); }
.ruin-2 { left: 20%; width: 40px; height: 120px; clip-path: polygon(0 100%, 0 10%, 50% 0, 100% 15%, 100% 100%); }
.ruin-3 { right: 15%; width: 80px; height: 200px; clip-path: polygon(0 100%, 5% 15%, 25% 0, 45% 5%, 60% 0, 80% 10%, 100% 20%, 95% 100%); }
.ruin-4 { right: 35%; width: 50px; height: 140px; clip-path: polygon(0 100%, 0 20%, 40% 0, 100% 25%, 100% 100%); }
.ruin::after {
  content: ''; position: absolute; top: -10px; left: 20%; right: 20%;
  height: 30px;
  background: radial-gradient(ellipse at bottom, rgba(45,90,61,0.4), transparent);
  border-radius: 50% 50% 0 0;
}
.code-ruin {
  position: absolute;
  font-family: 'JetBrains Mono', monospace;
  font-size: 11px; font-weight: 300;
  color: rgba(90,102,112,0.2);
  white-space: nowrap;
  z-index: 2;
}
.code-ruin-1 { bottom: 38%; left: 8%; transform: rotate(-2deg); }
.code-ruin-2 { bottom: 42%; right: 18%; transform: rotate(1deg); }
.code-ruin-3 { bottom: 35%; left: 45%; transform: rotate(-1deg); }
.mundo-veg { z-index: 3; }
.veg-cluster {
  position: absolute; bottom: 18%;
  width: 100px; height: 80px;
  background: radial-gradient(ellipse at bottom, rgba(45,90,61,0.35), transparent 70%);
  border-radius: 50% 50% 20% 20%;
}
.veg-1 { left: 0; width: 150px; height: 100px; }
.veg-2 { left: 25%; width: 80px; height: 60px; }
.veg-3 { right: 5%; width: 130px; height: 90px; }
.veg-4 { left: 55%; width: 100px; height: 70px; }
.mundo-ground {
  z-index: 4;
  background: linear-gradient(to top, rgba(13,17,23,0.8) 0%, rgba(14,21,29,0.4) 40%, transparent 100%);
  top: auto !important; bottom: -40px; height: 35%;
}
.mundo-tint {
  position: absolute; inset: 0; z-index: 5; pointer-events: none;
  background: radial-gradient(ellipse at center 60%, rgba(199,91,57,0.04) 0%, transparent 60%);
}

/* Reggie container with sprite */
.reggie-container {
  position: absolute; top: 50%; left: 50%;
  transform: translate(-50%, -50%);
  z-index: 20;
  display: flex; align-items: center; justify-content: center;
}
.reggie-sprite-mundo {
  width: 120px; height: 120px;
  object-fit: contain;
  animation: spriteBreath 5s ease-in-out infinite;
  filter: drop-shadow(0 0 30px rgba(212,165,116,0.4)) drop-shadow(0 0 60px rgba(199,91,57,0.2));
  position: relative; z-index: 2;
}
.reggie-aura {
  position: absolute; top: 50%; left: 50%;
  transform: translate(-50%, -50%);
  width: 200px; height: 200px;
  border-radius: 50%;
  background: radial-gradient(circle, rgba(212,165,116,0.08) 0%, transparent 70%);
  animation: reggieBreathe 5s ease-in-out infinite reverse;
  z-index: 1;
}
@keyframes reggieBreathe {
  0%, 100% { transform: translate(-50%,-50%) scale(1); opacity: 0.6; }
  50% { transform: translate(-50%,-50%) scale(1.15); opacity: 1; }
}
.reggie-particle {
  position: absolute; width: 3px; height: 3px;
  border-radius: 50%;
  background: var(--amber);
  opacity: 0;
  animation: reggieParticle 4s ease-in-out infinite;
}
@keyframes reggieParticle {
  0% { opacity: 0; transform: translate(0, 0) scale(0.5); }
  30% { opacity: 0.7; }
  100% { opacity: 0; transform: translate(var(--px), var(--py)) scale(0); }
}
.reggie-particle:nth-child(3) { --px: -30px; --py: -50px; animation-delay: 0s; top: 50%; left: 50%; }
.reggie-particle:nth-child(4) { --px: 40px; --py: -40px; animation-delay: 0.8s; top: 50%; left: 50%; }
.reggie-particle:nth-child(5) { --px: -20px; --py: 45px; animation-delay: 1.6s; top: 50%; left: 50%; }
.reggie-particle:nth-child(6) { --px: 35px; --py: 30px; animation-delay: 2.4s; top: 50%; left: 50%; }
.reggie-particle:nth-child(7) { --px: -45px; --py: -10px; animation-delay: 3.2s; top: 50%; left: 50%; }
.reggie-particle:nth-child(8) { --px: 10px; --py: -55px; animation-delay: 1.2s; top: 50%; left: 50%; }

/* Stats */
.breath-stats {
  position: absolute; bottom: 80px; left: 50%;
  transform: translateX(-50%);
  display: flex; gap: 60px;
  z-index: 20;
}
.breath-stat {
  display: flex; flex-direction: column; align-items: center; gap: 10px;
}
.breath-stat-orb {
  width: 10px; height: 10px; border-radius: 50%;
  animation: breathPulse 4.5s ease-in-out infinite;
}
.breath-stat-orb.calor { background: var(--ember); box-shadow: 0 0 15px rgba(199,91,57,0.4); }
.breath-stat-orb.vida { background: var(--lichen); box-shadow: 0 0 15px rgba(127,176,105,0.4); animation-delay: 0.5s; }
.breath-stat-orb.luz { background: var(--amber); box-shadow: 0 0 15px rgba(212,165,116,0.4); animation-delay: 1s; }
@keyframes breathPulse {
  0%, 100% { transform: scale(1); opacity: 0.6; }
  50% { transform: scale(1.4); opacity: 1; }
}
.breath-stat-label {
  font-family: 'JetBrains Mono', monospace;
  font-size: 10px; letter-spacing: 2px; text-transform: uppercase;
  color: var(--ghost);
}

.mundo-nav {
  position: absolute; bottom: 150px; left: 50%;
  transform: translateX(-50%);
  display: flex; gap: 40px;
  z-index: 20;
}
.mundo-nav-item {
  font-family: 'Crimson Text', serif;
  font-size: 15px; letter-spacing: 2px;
  color: var(--ghost);
  cursor: pointer;
  padding: 10px 20px;
  border: 1px solid rgba(90,102,112,0.15);
  border-radius: 30px;
  background: rgba(13,17,23,0.5);
  transition: all 0.5s ease;
}
.mundo-nav-item:hover {
  color: var(--amber);
  border-color: rgba(212,165,116,0.2);
  background: rgba(212,165,116,0.04);
}

.type-badge {
  position: absolute; top: 70px; right: 40px;
  z-index: 20;
  font-family: 'JetBrains Mono', monospace;
  font-size: 10px; letter-spacing: 3px; text-transform: uppercase;
  color: var(--ember);
  opacity: 0.5;
  display: flex; align-items: center; gap: 8px;
}
.type-badge::before {
  content: '';
  width: 6px; height: 6px; border-radius: 50%;
  background: var(--ember);
  animation: breathPulse 4s ease-in-out infinite;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SCREEN 3 â€” DIÃLOGO (Chat)
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#dialogo {
  display: flex; align-items: center; justify-content: center;
}
#dialogo .screen-bg-overlay {
  background: linear-gradient(to top, rgba(10,14,19,0.85), rgba(17,26,36,0.7) 50%, rgba(13,17,23,0.8));
}
.dialogo-container {
  position: relative; z-index: 10;
  width: 600px; max-width: 90%;
  display: flex; flex-direction: column; gap: 28px;
  padding: 40px 0;
  max-height: 80vh;
}
.dialogo-reggie-float {
  position: absolute; top: 60px; left: 40px; z-index: 15;
  width: 60px; height: 60px;
  animation: spriteBreath 5s ease-in-out infinite;
  filter: drop-shadow(0 0 15px rgba(212,165,116,0.3));
  object-fit: contain;
  opacity: 0.7;
}
.msg {
  padding: 18px 24px;
  border-radius: 20px;
  max-width: 85%;
  line-height: 1.8;
  font-size: 14px;
  animation: msgAppear 0.8s ease-out both;
}
@keyframes msgAppear {
  0% { opacity: 0; transform: translateY(12px); }
  100% { opacity: 1; transform: translateY(0); }
}
.msg-user {
  align-self: flex-end;
  background: rgba(45,90,61,0.12);
  border: 1px solid rgba(45,90,61,0.15);
  color: var(--mist);
  margin-left: auto;
}
.msg-reggie {
  align-self: flex-start;
  background: rgba(232,213,183,0.04);
  border: 1px solid rgba(232,213,183,0.08);
  color: var(--glow);
  font-family: 'JetBrains Mono', monospace;
  font-size: 13px; font-weight: 300;
  letter-spacing: 0.5px;
}
.msg-reggie .cursor {
  display: inline-block;
  width: 7px; height: 14px;
  background: var(--amber);
  opacity: 0;
  animation: cursorBlink 1.2s ease-in-out infinite;
  vertical-align: text-bottom;
  margin-left: 2px;
}
@keyframes cursorBlink {
  0%, 100% { opacity: 0; }
  50% { opacity: 0.6; }
}
.msg-reggie-label {
  font-family: 'JetBrains Mono', monospace;
  font-size: 10px; letter-spacing: 2px;
  color: var(--ghost);
  margin-bottom: 4px; margin-left: 4px;
}
.dialogo-input {
  margin-top: 20px;
  display: flex; gap: 12px; align-items: center;
}
.dialogo-input input {
  flex: 1;
  font-family: 'Inter', sans-serif;
  font-size: 14px; font-weight: 300;
  color: var(--mist);
  background: rgba(184,196,208,0.04);
  border: 1px solid rgba(184,196,208,0.1);
  border-radius: 30px;
  padding: 14px 24px;
  outline: none;
  transition: border-color 0.4s;
}
.dialogo-input input::placeholder { color: var(--ghost); opacity: 0.5; }
.dialogo-input input:focus { border-color: rgba(212,165,116,0.2); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SCREEN 4 â€” FRACTURA
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#fractura {
  display: flex; align-items: center; justify-content: center;
  overflow: hidden;
}
.fractura-bg-states {
  position: absolute; inset: 0; z-index: 0;
}
.fractura-bg-states img {
  position: absolute; inset: 0;
  width: 100%; height: 100%;
  object-fit: cover;
  transition: opacity 2s ease;
  opacity: 0;
}
.fractura-bg-states img:first-child { opacity: 1; }
.fractura-bg-overlay {
  position: absolute; inset: 0; z-index: 1;
  background: rgba(13,17,23,0.5);
  transition: background 3s ease;
  pointer-events: none;
}
.fractura-bg-overlay.awakened {
  background: rgba(13,17,23,0.15);
}

.fractura-crack {
  position: absolute; top: 0; left: 50%;
  transform: translateX(-50%);
  width: 4px; height: 0;
  z-index: 10;
  background: linear-gradient(to bottom, var(--glow), var(--amber), transparent);
  transition: height 2s ease-out, width 1.5s ease-out 1s;
  box-shadow: 0 0 30px rgba(232,213,183,0.3), 0 0 80px rgba(212,165,116,0.15);
}
.fractura-crack.cracked {
  height: 100%;
  width: 6px;
}
.fractura-light {
  position: absolute; top: 50%; left: 50%;
  transform: translate(-50%, -50%);
  width: 0; height: 0;
  border-radius: 50%;
  background: radial-gradient(circle, rgba(232,213,183,0.15) 0%, rgba(127,176,105,0.05) 50%, transparent 70%);
  transition: width 3s ease-out 1.5s, height 3s ease-out 1.5s;
  z-index: 5;
}
.fractura-light.flooded {
  width: 200vw; height: 200vh;
}
.fractura-growth {
  position: absolute; bottom: 30%; left: 50%;
  transform: translateX(-50%);
  z-index: 12;
  display: flex; gap: 20px; align-items: flex-end;
}
.fractura-vine {
  width: 3px;
  height: 0;
  background: linear-gradient(to top, var(--moss), var(--lichen));
  border-radius: 2px;
  transition: height 2.5s ease-out;
  position: relative;
}
.fractura-vine::after {
  content: '';
  position: absolute; top: -8px; left: 50%;
  transform: translateX(-50%);
  width: 0; height: 0;
  background: radial-gradient(circle, var(--lichen), transparent);
  border-radius: 50%;
  transition: width 1s ease-out, height 1s ease-out;
}
.fractura-growth.grown .fractura-vine:nth-child(1) { height: 100px; transition-delay: 2s; }
.fractura-growth.grown .fractura-vine:nth-child(2) { height: 160px; transition-delay: 2.2s; }
.fractura-growth.grown .fractura-vine:nth-child(3) { height: 80px; transition-delay: 2.5s; }
.fractura-growth.grown .fractura-vine:nth-child(4) { height: 130px; transition-delay: 2.3s; }
.fractura-growth.grown .fractura-vine:nth-child(5) { height: 60px; transition-delay: 2.7s; }
.fractura-growth.grown .fractura-vine::after { width: 16px; height: 16px; transition-delay: 3.5s; }

.fractura-reggie {
  position: absolute; bottom: 35%; left: 50%;
  transform: translateX(-50%);
  z-index: 15;
  width: 80px; height: 80px;
  object-fit: contain;
  animation: spriteBreath 5s ease-in-out infinite;
  filter: drop-shadow(0 0 25px rgba(212,165,116,0.4));
  opacity: 0;
  transition: opacity 2s ease-out 3s;
}
.fractura-reggie.visible { opacity: 1; }

.fractura-text {
  position: relative; z-index: 30;
  text-align: center;
}
.fractura-text h2 {
  font-family: 'Crimson Text', serif;
  font-size: clamp(32px, 4vw, 56px);
  font-weight: 400;
  color: var(--glow);
  opacity: 0;
  transform: translateY(20px);
  transition: opacity 1.5s ease-out 3.5s, transform 1.5s ease-out 3.5s;
  text-shadow: 0 0 40px rgba(232,213,183,0.2);
}
.fractura-text.visible h2 {
  opacity: 1; transform: translateY(0);
}
.fractura-text p {
  font-family: 'JetBrains Mono', monospace;
  font-size: 12px; font-weight: 300;
  color: var(--ghost);
  letter-spacing: 3px;
  margin-top: 16px;
  opacity: 0;
  transition: opacity 1.5s ease-out 4.5s;
}
.fractura-text.visible p { opacity: 0.7; }

.fractura-burst-particle {
  position: absolute;
  width: 4px; height: 4px;
  border-radius: 50%;
  top: 50%; left: 50%;
  opacity: 0;
  z-index: 15;
}
.fractura-burst-particle.burst {
  animation: burstOut 3s ease-out forwards;
}
@keyframes burstOut {
  0% { opacity: 0; transform: translate(0,0) scale(1); }
  10% { opacity: 1; }
  100% { opacity: 0; transform: translate(var(--bx), var(--by)) scale(0); }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SCREEN 5 â€” DESPERTAR (Loading)
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#despertar {
  display: flex; flex-direction: column;
  align-items: center; justify-content: center;
}
#despertar .screen-bg-overlay {
  background: linear-gradient(to top, rgba(8,11,16,0.9) 0%, rgba(10,14,19,0.7) 40%, rgba(13,17,23,0.8) 100%);
}
.despertar-root-track {
  position: relative; z-index: 20;
  width: 400px; height: 6px;
  background: rgba(45,90,61,0.1);
  border-radius: 3px;
  overflow: hidden;
  margin-bottom: 60px;
}
.despertar-root-fill {
  height: 100%;
  width: 0%;
  background: linear-gradient(to right, var(--moss), var(--lichen));
  border-radius: 3px;
  position: relative;
  transition: width 0.3s ease-out;
  box-shadow: 0 0 12px rgba(127,176,105,0.3);
}
.despertar-root-fill::after {
  content: ''; position: absolute; right: -4px; top: -3px;
  width: 12px; height: 12px; border-radius: 50%;
  background: radial-gradient(circle, var(--lichen), transparent);
}
.despertar-tendril {
  position: absolute; z-index: 19;
  width: 2px; border-radius: 1px;
  background: linear-gradient(to top, var(--moss), transparent);
  opacity: 0; transition: opacity 1s, height 2s ease-out;
}
.despertar-whisper {
  position: relative; z-index: 20;
  text-align: center;
  opacity: 0;
  transition: opacity 1.5s ease-out;
}
.despertar-whisper.visible { opacity: 1; }
.despertar-whisper p {
  font-family: 'Crimson Text', serif;
  font-size: 16px; color: var(--ghost);
  letter-spacing: 1px; line-height: 1.8;
  margin-bottom: 40px;
}
.despertar-btns {
  display: flex; gap: 24px; justify-content: center;
}
.despertar-btn {
  font-family: 'Crimson Text', serif;
  font-size: 15px; letter-spacing: 2px;
  color: var(--amber);
  background: rgba(212,165,116,0.06);
  border: 1px solid rgba(212,165,116,0.12);
  padding: 12px 36px; border-radius: 30px;
  cursor: pointer; transition: all 0.5s ease;
}
.despertar-btn:hover {
  background: rgba(212,165,116,0.1);
  border-color: rgba(212,165,116,0.25);
  box-shadow: 0 0 30px rgba(212,165,116,0.08);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SCREEN 6 â€” EL ORIGEN (Story/Lore)
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#origen {
  display: flex; align-items: center; justify-content: center;
}
#origen .screen-bg-overlay {
  background: linear-gradient(to top, rgba(10,14,19,0.85) 0%, rgba(17,26,36,0.6) 50%, rgba(13,17,23,0.7) 100%);
}
.origen-lines {
  position: relative; z-index: 20;
  max-width: 700px; padding: 0 40px;
  display: flex; flex-direction: column; gap: 32px;
}
.origen-line {
  font-family: 'JetBrains Mono', monospace;
  font-size: 14px; font-weight: 300;
  color: var(--glow);
  letter-spacing: 0.5px;
  line-height: 2;
  opacity: 0;
  transform: translateY(16px);
  transition: opacity 1.2s ease-out, transform 1.2s ease-out;
  text-shadow: 0 0 40px rgba(232,213,183,0.1);
}
.origen-line.visible {
  opacity: 1; transform: translateY(0);
}
.origen-continuar {
  font-family: 'Crimson Text', serif;
  font-size: 16px; letter-spacing: 3px;
  color: var(--amber);
  background: none; border: 1px solid rgba(212,165,116,0.12);
  padding: 12px 40px; border-radius: 30px;
  cursor: pointer; opacity: 0;
  transition: opacity 1.5s ease-out, background 0.4s, border-color 0.4s;
  align-self: center; margin-top: 20px;
}
.origen-continuar.visible { opacity: 1; }
.origen-continuar:hover {
  background: rgba(212,165,116,0.08);
  border-color: rgba(212,165,116,0.25);
}
.origen-particle {
  position: absolute; width: 3px; height: 3px;
  border-radius: 50%;
  background: var(--glow);
  opacity: 0;
  animation: origenFloat 5s ease-in-out infinite;
  pointer-events: none;
}
@keyframes origenFloat {
  0% { opacity: 0; transform: translate(0, 0); }
  30% { opacity: 0.4; }
  100% { opacity: 0; transform: translate(var(--ofx, 30px), var(--ofy, -50px)); }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SCREEN 7 â€” ACCESO (Login overlay)
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#acceso {
  display: flex; align-items: center; justify-content: center;
}
#acceso .screen-bg-overlay {
  background: radial-gradient(ellipse at center, rgba(13,17,23,0.5) 0%, rgba(13,17,23,0.85) 70%);
}
.acceso-mist {
  position: absolute; inset: 0; z-index: 5;
  background: radial-gradient(ellipse at center, rgba(184,196,208,0.06) 0%, rgba(13,17,23,0.9) 70%);
  animation: fogDrift 10s ease-in-out infinite alternate;
}
.acceso-container {
  position: relative; z-index: 20;
  display: flex; flex-direction: column; align-items: center; gap: 32px;
  padding: 60px;
}
.acceso-title {
  font-family: 'Crimson Text', serif;
  font-size: clamp(28px, 3vw, 42px);
  color: var(--glow);
  letter-spacing: 3px;
  text-shadow: 0 0 50px rgba(232,213,183,0.12);
  margin-bottom: 16px;
}
.acceso-subtitle {
  font-family: 'JetBrains Mono', monospace;
  font-size: 11px; font-weight: 300;
  color: var(--ghost); letter-spacing: 3px;
  margin-bottom: 20px;
}
.acceso-options {
  display: flex; flex-direction: column; gap: 16px;
  width: 320px;
}
.acceso-btn {
  font-family: 'Inter', sans-serif;
  font-size: 14px; font-weight: 300;
  color: var(--mist);
  background: rgba(184,196,208,0.04);
  border: 1px solid rgba(184,196,208,0.1);
  padding: 16px 28px;
  border-radius: 30px;
  cursor: pointer;
  transition: all 0.5s ease;
  display: flex; align-items: center; gap: 12px;
  justify-content: center;
  letter-spacing: 1px;
}
.acceso-btn:hover {
  background: rgba(184,196,208,0.08);
  border-color: rgba(184,196,208,0.2);
  box-shadow: 0 0 30px rgba(184,196,208,0.05);
}
.acceso-btn .btn-icon {
  font-size: 18px; opacity: 0.7;
}
.acceso-explorar {
  font-family: 'Crimson Text', serif;
  font-size: 15px; letter-spacing: 2px;
  color: var(--amber);
  background: rgba(212,165,116,0.04);
  border: 1px solid rgba(212,165,116,0.1);
  padding: 14px 36px; border-radius: 30px;
  cursor: pointer; margin-top: 16px;
  transition: all 0.5s ease;
}
.acceso-explorar:hover {
  background: rgba(212,165,116,0.1);
  border-color: rgba(212,165,116,0.2);
  box-shadow: 0 0 30px rgba(212,165,116,0.08);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SCREEN 8 â€” ELECCIÃ“N (Choose companion)
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#eleccion {
  display: flex; flex-direction: column;
  align-items: center; justify-content: center;
}
#eleccion .screen-bg-overlay {
  background: linear-gradient(to top, rgba(10,14,19,0.85), rgba(13,17,23,0.6) 40%, rgba(17,26,36,0.7));
}
.eleccion-title {
  position: relative; z-index: 20;
  font-family: 'Crimson Text', serif;
  font-size: clamp(28px, 3vw, 44px);
  color: var(--glow); letter-spacing: 3px;
  margin-bottom: 60px;
  text-shadow: 0 0 50px rgba(232,213,183,0.12);
  animation: titleFadeIn 2s ease-out both;
}
.eleccion-essences {
  position: relative; z-index: 20;
  display: flex; gap: 80px;
  margin-bottom: 60px;
}
.eleccion-essence {
  display: flex; flex-direction: column; align-items: center; gap: 24px;
  cursor: pointer; padding: 30px; border-radius: 20px;
  border: 1px solid transparent;
  transition: all 0.6s ease;
  width: 240px;
}
.eleccion-essence:hover {
  border-color: rgba(232,213,183,0.08);
  background: rgba(232,213,183,0.02);
}
.eleccion-essence.selected {
  border-color: rgba(232,213,183,0.15);
  background: rgba(232,213,183,0.03);
}
/* Sprite containers for eleccion */
.essence-sprite-container {
  width: 100px; height: 100px;
  position: relative;
  display: flex; align-items: center; justify-content: center;
}
.essence-sprite-container img {
  width: 80px; height: 80px;
  object-fit: contain;
  animation: spriteBreath 5s ease-in-out infinite;
  transition: filter 0.6s, transform 0.6s;
}
.eleccion-essence:hover .essence-sprite-container img {
  transform: scale(1.08);
}
.essence-sprite-container .essence-glow {
  position: absolute; inset: -10px;
  border-radius: 50%;
  opacity: 0.4;
  animation: reggieBreathe 5s ease-in-out infinite;
  pointer-events: none;
}
.essence-glow-brasa {
  background: radial-gradient(circle, rgba(199,91,57,0.3), transparent 70%);
}
.essence-glow-niebla {
  background: radial-gradient(circle, rgba(184,196,208,0.25), transparent 70%);
}
.essence-glow-cristal {
  background: radial-gradient(circle, rgba(155,184,211,0.3), transparent 70%);
}
.essence-sprite-container img.sprite-brasa {
  filter: drop-shadow(0 0 20px rgba(199,91,57,0.5)) drop-shadow(0 0 40px rgba(212,165,116,0.3));
}
.essence-sprite-container img.sprite-niebla {
  filter: drop-shadow(0 0 20px rgba(184,196,208,0.4)) drop-shadow(0 0 40px rgba(184,196,208,0.2));
}
.essence-sprite-container img.sprite-cristal {
  filter: drop-shadow(0 0 20px rgba(155,184,211,0.5)) drop-shadow(0 0 40px rgba(155,184,211,0.3));
}

.essence-name {
  font-family: 'Crimson Text', serif;
  font-size: 20px; color: var(--glow);
  letter-spacing: 2px;
}
.essence-quote {
  font-family: 'JetBrains Mono', monospace;
  font-size: 11px; font-weight: 300;
  color: var(--ghost); line-height: 1.7;
  text-align: center; letter-spacing: 0.3px;
  max-width: 200px;
}
.eleccion-name-input {
  position: relative; z-index: 20;
  display: flex; flex-direction: column; align-items: center; gap: 12px;
  margin-bottom: 40px;
}
.eleccion-name-input label {
  font-family: 'JetBrains Mono', monospace;
  font-size: 10px; letter-spacing: 3px; text-transform: uppercase;
  color: var(--ghost);
}
.eleccion-name-input input {
  font-family: 'Inter', sans-serif;
  font-size: 16px; font-weight: 300;
  color: var(--mist);
  background: rgba(184,196,208,0.04);
  border: 1px solid rgba(184,196,208,0.1);
  border-radius: 30px;
  padding: 14px 32px;
  text-align: center;
  outline: none; width: 280px;
  transition: border-color 0.4s;
}
.eleccion-name-input input::placeholder { color: var(--ghost); opacity: 0.4; }
.eleccion-name-input input:focus { border-color: rgba(212,165,116,0.2); }
.btn-despertar {
  position: relative; z-index: 20;
  font-family: 'Crimson Text', serif;
  font-size: 18px; letter-spacing: 3px;
  color: var(--amber);
  background: rgba(212,165,116,0.06);
  border: 1px solid rgba(212,165,116,0.15);
  padding: 14px 48px; border-radius: 40px;
  cursor: pointer;
  transition: all 0.6s ease;
}
.btn-despertar:hover {
  background: rgba(212,165,116,0.12);
  border-color: rgba(212,165,116,0.3);
  box-shadow: 0 0 40px rgba(212,165,116,0.1);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SCREEN 9 â€” NACIMIENTO (Birth transition)
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#nacimiento {
  display: flex; align-items: center; justify-content: center;
  background: var(--void);
  overflow: hidden;
}
.nacimiento-dark {
  position: absolute; inset: 0; z-index: 1;
  background: var(--void);
  transition: opacity 3s ease-out;
}
.nacimiento-text {
  position: relative; z-index: 20;
  font-family: 'JetBrains Mono', monospace;
  font-size: 14px; font-weight: 300;
  color: var(--ghost);
  letter-spacing: 4px;
  opacity: 0;
  transition: opacity 2s ease-out;
}
.nacimiento-text.visible { opacity: 1; }
.nacimiento-text.fade-out { opacity: 0; transition: opacity 1.5s ease-in; }
.nacimiento-light {
  position: absolute; top: 50%; left: 50%;
  transform: translate(-50%, -50%);
  width: 0; height: 0; border-radius: 50%;
  background: radial-gradient(circle, rgba(232,213,183,0.3) 0%, rgba(212,165,116,0.15) 30%, rgba(199,91,57,0.05) 60%, transparent 70%);
  z-index: 10;
  transition: width 4s ease-out, height 4s ease-out;
}
.nacimiento-light.grow {
  width: 600px; height: 600px;
}
.nacimiento-light.burst {
  width: 300vw; height: 300vh;
  transition: width 2s ease-out, height 2s ease-out;
}
.nacimiento-sprite {
  position: absolute; top: 50%; left: 50%;
  transform: translate(-50%, -50%);
  z-index: 15;
  width: 100px; height: 100px;
  object-fit: contain;
  opacity: 0;
  transition: opacity 2s ease-out, transform 2s ease-out;
  animation: spriteBreath 5s ease-in-out infinite;
  filter: drop-shadow(0 0 40px rgba(232,213,183,0.5));
}
.nacimiento-sprite.reveal {
  opacity: 1;
  transform: translate(-50%, -50%) scale(1.1);
}
.nacimiento-converge {
  position: absolute; width: 4px; height: 4px;
  border-radius: 50%; z-index: 15;
  opacity: 0;
}
.nacimiento-converge.active {
  animation: converge 3s ease-in forwards;
}
@keyframes converge {
  0% { opacity: 0; }
  20% { opacity: 0.8; }
  100% { opacity: 0; transform: translate(var(--cx), var(--cy)) scale(0); }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SCREEN 10 â€” CAPTURA (Camera + Result)
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#captura {
  display: flex; align-items: center; justify-content: center;
}
#captura .screen-bg-overlay {
  background: linear-gradient(to top, rgba(10,14,19,0.85), rgba(17,26,36,0.6) 50%, rgba(13,17,23,0.7));
}
.captura-container {
  position: relative; z-index: 10;
  width: 700px; max-width: 90%;
  display: flex; flex-direction: column; gap: 32px;
  align-items: center;
}
.captura-reggie-float {
  position: absolute; top: -20px; right: -20px; z-index: 15;
  width: 50px; height: 50px;
  object-fit: contain;
  animation: spriteBreath 5s ease-in-out infinite;
  filter: drop-shadow(0 0 12px rgba(212,165,116,0.3));
  opacity: 0.6;
}
.captura-header {
  font-family: 'Crimson Text', serif;
  font-size: clamp(24px, 3vw, 36px);
  color: var(--glow); letter-spacing: 2px;
  text-shadow: 0 0 40px rgba(232,213,183,0.1);
}
.captura-prompt {
  font-family: 'JetBrains Mono', monospace;
  font-size: 13px; font-weight: 300;
  color: var(--ghost); line-height: 2;
  text-align: center; letter-spacing: 0.5px;
  max-width: 500px;
}
.captura-buttons {
  display: flex; gap: 24px;
}
.captura-btn {
  font-family: 'Crimson Text', serif;
  font-size: 15px; letter-spacing: 2px;
  color: var(--mist);
  background: rgba(184,196,208,0.04);
  border: 1px solid rgba(184,196,208,0.1);
  padding: 14px 32px; border-radius: 30px;
  cursor: pointer; transition: all 0.5s ease;
}
.captura-btn:hover {
  background: rgba(184,196,208,0.08);
  border-color: rgba(184,196,208,0.2);
}
.captura-result {
  width: 100%;
  display: flex; gap: 28px; align-items: flex-start;
  padding: 28px;
  background: rgba(232,213,183,0.02);
  border: 1px solid rgba(232,213,183,0.06);
  border-radius: 20px;
}
.captura-image {
  width: 200px; height: 200px; flex-shrink: 0;
  border-radius: 16px; overflow: hidden;
  background: linear-gradient(135deg, #1a2332, #0f1922, #1a2332);
  position: relative;
  filter: saturate(0.7) contrast(1.1) sepia(0.2);
}
.captura-image::after {
  content: 'ğŸŒ¿'; position: absolute; top: 50%; left: 50%;
  transform: translate(-50%, -50%);
  font-size: 40px; opacity: 0.3;
}
.captura-image-frame {
  position: absolute; inset: 0;
  border: 2px solid rgba(232,213,183,0.08);
  border-radius: 16px;
  pointer-events: none;
}
.captura-details {
  flex: 1; display: flex; flex-direction: column; gap: 20px;
}
.captura-reaction {
  font-family: 'JetBrains Mono', monospace;
  font-size: 12px; font-weight: 300;
  color: var(--glow);
  padding: 12px 16px;
  background: rgba(232,213,183,0.04);
  border-radius: 12px;
  animation: glowMoment 4s ease-in-out infinite;
}
@keyframes glowMoment {
  0%, 100% { box-shadow: 0 0 0 rgba(232,213,183,0); }
  50% { box-shadow: 0 0 20px rgba(232,213,183,0.08); }
}
.captura-stats {
  display: flex; gap: 20px;
}
.captura-stat {
  font-family: 'JetBrains Mono', monospace;
  font-size: 11px; font-weight: 300;
  color: var(--lichen);
  opacity: 0;
  animation: statFloat 2s ease-out forwards;
}
.captura-stat:nth-child(1) { animation-delay: 0.5s; }
.captura-stat:nth-child(2) { animation-delay: 0.8s; }
.captura-stat:nth-child(3) { animation-delay: 1.1s; }
@keyframes statFloat {
  0% { opacity: 0; transform: translateY(10px); }
  100% { opacity: 0.7; transform: translateY(0); }
}
.captura-diary {
  font-family: 'Crimson Text', serif;
  font-size: 14px; color: var(--mist);
  font-style: italic; line-height: 1.8;
  border-left: 2px solid rgba(45,90,61,0.2);
  padding-left: 16px;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SCREEN 11 â€” LA RED (Social)
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#lared {
  display: flex; align-items: center; justify-content: center;
}
#lared .screen-bg-overlay {
  background: linear-gradient(to top, rgba(10,14,19,0.85), rgba(15,22,32,0.6) 40%, rgba(13,17,23,0.7));
}
.lared-container {
  position: relative; z-index: 10;
  width: 700px; max-width: 90%;
  display: flex; flex-direction: column; gap: 40px;
}
.lared-title {
  font-family: 'Crimson Text', serif;
  font-size: clamp(24px, 3vw, 36px);
  color: var(--glow); letter-spacing: 2px;
  text-align: center;
  text-shadow: 0 0 40px rgba(232,213,183,0.1);
}
.lared-subtitle {
  font-family: 'JetBrains Mono', monospace;
  font-size: 11px; font-weight: 300;
  color: var(--ghost); letter-spacing: 3px;
  text-align: center; margin-top: -24px;
}
.lared-feed {
  display: flex; flex-direction: column; gap: 20px;
}
.lared-whisper {
  font-family: 'JetBrains Mono', monospace;
  font-size: 12px; font-weight: 300;
  color: var(--ghost);
  padding: 16px 24px;
  background: rgba(184,196,208,0.02);
  border: 1px solid rgba(184,196,208,0.04);
  border-radius: 16px;
  line-height: 1.8;
  letter-spacing: 0.3px;
  opacity: 0;
  animation: whisperIn 1.2s ease-out forwards;
}
.lared-whisper:nth-child(1) { animation-delay: 0.2s; }
.lared-whisper:nth-child(2) { animation-delay: 0.6s; }
.lared-whisper:nth-child(3) { animation-delay: 1.0s; }
.lared-whisper:nth-child(4) { animation-delay: 1.4s; }
@keyframes whisperIn {
  0% { opacity: 0; transform: translateY(8px); }
  100% { opacity: 0.6; transform: translateY(0); }
}
.lared-presence {
  display: flex; align-items: center; gap: 20px;
  padding: 20px 24px;
  background: rgba(232,213,183,0.02);
  border: 1px solid rgba(232,213,183,0.06);
  border-radius: 16px;
}
.lared-mini-reggie {
  width: 40px; height: 40px;
  object-fit: contain;
  animation: spriteBreath 5s ease-in-out infinite;
  filter: drop-shadow(0 0 12px rgba(212,165,116,0.3));
  flex-shrink: 0;
}
.lared-presence-text {
  font-family: 'JetBrains Mono', monospace;
  font-size: 11px; font-weight: 300;
  color: var(--mist); letter-spacing: 1px;
}
.lared-pulse-section {
  text-align: center;
}
.lared-pulse-label {
  font-family: 'JetBrains Mono', monospace;
  font-size: 10px; letter-spacing: 3px; text-transform: uppercase;
  color: var(--ghost); margin-bottom: 16px;
}
.lared-pulse-btn {
  font-family: 'Crimson Text', serif;
  font-size: 15px; letter-spacing: 2px;
  color: var(--amber);
  background: rgba(212,165,116,0.04);
  border: 1px solid rgba(212,165,116,0.1);
  padding: 12px 36px; border-radius: 30px;
  cursor: pointer; transition: all 0.5s ease;
}
.lared-pulse-btn:hover {
  background: rgba(212,165,116,0.1);
  border-color: rgba(212,165,116,0.2);
  box-shadow: 0 0 40px rgba(212,165,116,0.08);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SCREEN 12 â€” OTRO VIAJERO (Public profile)
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#viajero {
  display: flex; align-items: center; justify-content: center;
}
#viajero .screen-bg-overlay {
  background: linear-gradient(to top, rgba(10,14,19,0.85), rgba(15,22,32,0.6) 40%, rgba(13,17,23,0.7));
}
.viajero-container {
  position: relative; z-index: 10;
  width: 600px; max-width: 90%;
  display: flex; flex-direction: column; align-items: center; gap: 32px;
}
.viajero-note {
  font-family: 'JetBrains Mono', monospace;
  font-size: 11px; font-weight: 300;
  color: var(--ghost); letter-spacing: 2px;
  opacity: 0.6;
}
.viajero-reggie {
  width: 80px; height: 80px;
  object-fit: contain;
  animation: spriteBreath 6s ease-in-out infinite;
  filter: drop-shadow(0 0 20px rgba(155,184,211,0.4)) drop-shadow(0 0 40px rgba(155,184,211,0.2));
}
.viajero-name {
  font-family: 'Crimson Text', serif;
  font-size: 24px; color: var(--glow);
  letter-spacing: 2px;
}
.viajero-type {
  font-family: 'JetBrains Mono', monospace;
  font-size: 10px; letter-spacing: 3px; text-transform: uppercase;
  color: var(--frost); opacity: 0.6;
}
.viajero-world {
  width: 100%; height: 120px;
  border-radius: 16px; overflow: hidden;
  position: relative;
  border: 1px solid rgba(155,184,211,0.06);
}
.viajero-world img {
  position: absolute; inset: 0;
  width: 100%; height: 100%;
  object-fit: cover;
  filter: saturate(1.4) brightness(0.7);
}
.viajero-world-ground {
  position: absolute; bottom: 0; left: 0; right: 0; height: 30%;
  background: linear-gradient(to top, #0a0e13, transparent);
  z-index: 1;
}
.viajero-progress {
  width: 100%; display: flex; align-items: center; gap: 16px;
}
.viajero-progress-bar {
  flex: 1; height: 3px; border-radius: 2px;
  background: rgba(155,184,211,0.1);
  overflow: hidden;
}
.viajero-progress-fill {
  width: 68%; height: 100%;
  background: linear-gradient(to right, var(--frost), var(--glow));
  border-radius: 2px;
}
.viajero-progress-label {
  font-family: 'JetBrains Mono', monospace;
  font-size: 10px; color: var(--ghost); letter-spacing: 1px;
}
.viajero-actions {
  display: flex; gap: 20px;
}
.viajero-action {
  font-family: 'Crimson Text', serif;
  font-size: 14px; letter-spacing: 2px;
  color: var(--mist);
  background: rgba(184,196,208,0.04);
  border: 1px solid rgba(184,196,208,0.08);
  padding: 12px 28px; border-radius: 30px;
  cursor: pointer; transition: all 0.5s ease;
}
.viajero-action:hover {
  background: rgba(184,196,208,0.08);
  border-color: rgba(184,196,208,0.15);
  box-shadow: 0 0 25px rgba(184,196,208,0.05);
}
.viajero-back {
  font-family: 'JetBrains Mono', monospace;
  font-size: 11px; font-weight: 300;
  color: var(--ghost); letter-spacing: 2px;
  background: none; border: none;
  cursor: pointer; padding: 8px 16px;
  transition: color 0.4s;
}
.viajero-back:hover { color: var(--amber); }

/* â”€â”€ Ambient particles (spores) â”€â”€ */
.spore {
  position: absolute;
  width: var(--size, 3px); height: var(--size, 3px);
  border-radius: 50%;
  background: var(--spore-color, rgba(232,213,183,0.3));
  opacity: 0;
  animation: sporeDrift var(--dur, 8s) ease-in-out infinite;
  animation-delay: var(--delay, 0s);
  z-index: 6;
}
@keyframes sporeDrift {
  0% { opacity: 0; transform: translate(0, 0); }
  20% { opacity: var(--max-opacity, 0.5); }
  80% { opacity: var(--max-opacity, 0.5); }
  100% { opacity: 0; transform: translate(var(--dx, 20px), var(--dy, -60px)); }
}
</style>
</head>
<body>

<!-- Tab Navigation -->
<nav class="tab-nav">
  <button data-screen="despertar">Despertar</button>
  <button data-screen="origen">Origen</button>
  <button data-screen="acceso">Acceso</button>
  <button class="active" data-screen="umbral">Umbral</button>
  <button data-screen="eleccion">ElecciÃ³n</button>
  <button data-screen="nacimiento">Nacimiento</button>
  <button data-screen="mundo">El Mundo</button>
  <button data-screen="dialogo">DiÃ¡logo</button>
  <button data-screen="captura">Captura</button>
  <button data-screen="lared">La Red</button>
  <button data-screen="viajero">Viajero</button>
  <button data-screen="fractura">Fractura</button>
</nav>

<!-- Type Selector -->
<div class="type-selector">
  <button class="active" data-type="brasa" onclick="switchType('brasa')">ğŸ”¥ Brasa</button>
  <button data-type="niebla" onclick="switchType('niebla')">ğŸŒ«ï¸ Niebla</button>
  <button data-type="cristal" onclick="switchType('cristal')">ğŸ’ Cristal</button>
</div>

<!-- â•â•â• SCREEN 1: UMBRAL â•â•â• -->
<section id="umbral" class="screen active">
  <div class="screen-bg">
    <img src="assets/backgrounds/brasa/state-1.webp" alt="" class="bg-umbral">
    <div class="screen-bg-overlay"></div>
  </div>
  <div class="umbral-landscape">
    <div class="umbral-layer umbral-far"></div>
    <div class="umbral-layer umbral-mid"></div>
    <div class="umbral-veg"></div>
    <div class="umbral-layer umbral-near"></div>
    <div class="umbral-fog"></div>
  </div>
  <canvas class="particle-canvas" id="umbral-particles"></canvas>
  <h1 class="umbral-title">Reggie's Adventure</h1>
  <span class="umbral-subtitle">un viaje de regeneraciÃ³n</span>
  <button class="btn-comenzar" onclick="switchScreen('mundo')">Comenzar</button>
  <div class="vignette"></div>
</section>

<!-- â•â•â• SCREEN 2: EL MUNDO â•â•â• -->
<section id="mundo" class="screen">
  <div class="mundo-bg-states" id="mundo-bg-states">
    <img src="assets/backgrounds/brasa/state-1.webp" alt="" data-state="1" class="bg-active">
    <img src="assets/backgrounds/brasa/state-2.webp" alt="" data-state="2">
    <img src="assets/backgrounds/brasa/state-3.webp" alt="" data-state="3">
    <img src="assets/backgrounds/brasa/state-4.webp" alt="" data-state="4">
    <div class="mundo-bg-overlay"></div>
  </div>
  <div class="mundo-parallax" id="mundo-parallax">
    <div class="mundo-layer mundo-sky" data-depth="0.02"></div>
    <div class="mundo-layer mundo-ruins" data-depth="0.05">
      <div class="ruin ruin-1"></div>
      <div class="ruin ruin-2"></div>
      <div class="ruin ruin-3"></div>
      <div class="ruin ruin-4"></div>
      <span class="code-ruin code-ruin-1">// here we dreamed</span>
      <span class="code-ruin code-ruin-2">/* the old world */</span>
      <span class="code-ruin code-ruin-3">return hope;</span>
    </div>
    <div class="mundo-layer mundo-veg" data-depth="0.08">
      <div class="veg-cluster veg-1"></div>
      <div class="veg-cluster veg-2"></div>
      <div class="veg-cluster veg-3"></div>
      <div class="veg-cluster veg-4"></div>
    </div>
    <div class="mundo-layer mundo-ground" data-depth="0.12"></div>
  </div>
  <div class="mundo-tint"></div>
  <canvas class="particle-canvas" id="mundo-particles"></canvas>
  <div class="reggie-container">
    <div class="reggie-aura"></div>
    <img src="assets/reggie/brasa.webp" alt="Reggie" class="reggie-sprite-mundo" id="reggie-mundo-sprite">
    <div class="reggie-particle"></div>
    <div class="reggie-particle"></div>
    <div class="reggie-particle"></div>
    <div class="reggie-particle"></div>
    <div class="reggie-particle"></div>
    <div class="reggie-particle"></div>
  </div>
  <div class="type-badge" id="mundo-type-badge">ğŸ”¥ Brasa</div>
  <div class="mundo-nav">
    <div class="mundo-nav-item" onclick="switchScreen('dialogo')">DiÃ¡logo</div>
    <div class="mundo-nav-item" onclick="switchScreen('captura')">Captura</div>
    <div class="mundo-nav-item" onclick="switchScreen('lared')">La Red</div>
  </div>
  <div class="breath-stats">
    <div class="breath-stat">
      <div class="breath-stat-orb calor"></div>
      <span class="breath-stat-label">Calor</span>
    </div>
    <div class="breath-stat">
      <div class="breath-stat-orb vida"></div>
      <span class="breath-stat-label">Vida</span>
    </div>
    <div class="breath-stat">
      <div class="breath-stat-orb luz"></div>
      <span class="breath-stat-label">Luz</span>
    </div>
  </div>
  <div class="regen-slider-container">
    <span class="regen-slider-label">RegeneraciÃ³n</span>
    <input type="range" class="regen-slider" id="regen-slider" min="0" max="100" value="0">
    <span class="regen-value" id="regen-value">0%</span>
  </div>
  <div class="vignette"></div>
</section>

<!-- â•â•â• SCREEN 3: DIÃLOGO â•â•â• -->
<section id="dialogo" class="screen">
  <div class="screen-bg">
    <img src="assets/backgrounds/brasa/state-2.webp" alt="" class="bg-dialogo">
    <div class="screen-bg-overlay"></div>
  </div>
  <img src="assets/reggie/brasa.webp" alt="Reggie" class="dialogo-reggie-float" id="dialogo-reggie-sprite">
  <div class="dialogo-container">
    <div>
      <div class="msg-reggie-label">reggie</div>
      <div class="msg msg-reggie">
        <span class="terminal-text" data-text="has vuelto. el mundo notÃ³ tu ausencia â€” las hojas se inclinaron hacia donde solÃ­as estar."></span>
        <span class="cursor"></span>
      </div>
    </div>
    <div class="msg msg-user" style="animation-delay: 0.3s">Â¿Me extraÃ±aste?</div>
    <div>
      <div class="msg-reggie-label">reggie</div>
      <div class="msg msg-reggie" style="animation-delay: 0.6s">
        <span class="terminal-text" data-text="extraÃ±ar es un concepto humano. yo simplemente... pesaba mÃ¡s sin ti."></span>
        <span class="cursor"></span>
      </div>
    </div>
    <div class="msg msg-user" style="animation-delay: 0.9s">Â¿QuÃ© hiciste mientras no estuve?</div>
    <div>
      <div class="msg-reggie-label">reggie</div>
      <div class="msg msg-reggie" style="animation-delay: 1.2s">
        <span class="terminal-text" data-text="escuchÃ© crecer el musgo. es mÃ¡s elocuente de lo que imaginas."></span>
        <span class="cursor"></span>
      </div>
    </div>
    <div class="dialogo-input">
      <input type="text" placeholder="habla con reggie..." disabled>
    </div>
  </div>
  <div class="vignette"></div>
</section>

<!-- â•â•â• SCREEN 4: FRACTURA â•â•â• -->
<section id="fractura" class="screen">
  <div class="fractura-bg-states" id="fractura-bg-states">
    <img src="assets/backgrounds/brasa/state-1.webp" alt="" data-state="1">
    <img src="assets/backgrounds/brasa/state-4.webp" alt="" data-state="4">
  </div>
  <div class="fractura-bg-overlay" id="fractura-bg-overlay"></div>
  <div class="fractura-crack" id="fractura-crack"></div>
  <div class="fractura-light" id="fractura-light"></div>
  <div class="fractura-growth" id="fractura-growth">
    <div class="fractura-vine"></div>
    <div class="fractura-vine"></div>
    <div class="fractura-vine"></div>
    <div class="fractura-vine"></div>
    <div class="fractura-vine"></div>
  </div>
  <img src="assets/reggie/brasa.webp" alt="Reggie" class="fractura-reggie" id="fractura-reggie-sprite">
  <div id="fractura-burst"></div>
  <div class="fractura-text" id="fractura-text">
    <h2>Lo viejo cede. Lo nuevo crece.</h2>
    <p>fractura III</p>
  </div>
  <canvas class="particle-canvas" id="fractura-particles"></canvas>
  <div class="vignette"></div>
</section>

<!-- â•â•â• SCREEN 5: DESPERTAR â•â•â• -->
<section id="despertar" class="screen">
  <div class="screen-bg">
    <img src="assets/backgrounds/brasa/state-1.webp" alt="" class="bg-despertar">
    <div class="screen-bg-overlay"></div>
  </div>
  <canvas class="particle-canvas" id="despertar-particles"></canvas>
  <div class="despertar-root-track">
    <div class="despertar-root-fill" id="despertar-root"></div>
  </div>
  <div class="despertar-whisper" id="despertar-whisper">
    <p>Este viaje se vive mejor a pantalla completa</p>
    <div class="despertar-btns">
      <button class="despertar-btn" onclick="document.documentElement.requestFullscreen?.()">Expandir</button>
      <button class="despertar-btn" onclick="switchScreen('origen')">Continuar asÃ­</button>
    </div>
  </div>
  <div class="vignette"></div>
</section>

<!-- â•â•â• SCREEN 6: EL ORIGEN â•â•â• -->
<section id="origen" class="screen">
  <div class="screen-bg">
    <img src="assets/backgrounds/brasa/state-1.webp" alt="" class="bg-origen">
    <div class="screen-bg-overlay"></div>
  </div>
  <canvas class="particle-canvas" id="origen-particles"></canvas>
  <div class="origen-lines" id="origen-lines">
    <div class="origen-line">Hubo un tiempo en que el mundo recordaba.</div>
    <div class="origen-line">Los circuitos cantaban con la lluvia.</div>
    <div class="origen-line">Las raÃ­ces bebÃ­an datos como agua.</div>
    <div class="origen-line">Entonces, el silencio.</div>
    <div class="origen-line">La gran desconexiÃ³n.</div>
    <div class="origen-line">Ahora, algo despierta entre las ruinas...</div>
    <button class="origen-continuar" id="origen-continuar" onclick="switchScreen('acceso')">Continuar</button>
  </div>
  <div class="vignette"></div>
</section>

<!-- â•â•â• SCREEN 7: ACCESO â•â•â• -->
<section id="acceso" class="screen">
  <div class="screen-bg">
    <img src="assets/backgrounds/brasa/state-2.webp" alt="" class="bg-acceso">
    <div class="screen-bg-overlay"></div>
  </div>
  <div class="acceso-mist"></div>
  <canvas class="particle-canvas" id="acceso-particles"></canvas>
  <div class="acceso-container">
    <h2 class="acceso-title">Reggie's Adventure</h2>
    <span class="acceso-subtitle">entra al viaje</span>
    <div class="acceso-options">
      <button class="acceso-btn"><span class="btn-icon">â—‰</span> Continuar con Google</button>
      <button class="acceso-btn"><span class="btn-icon">âœ‰</span> Correo electrÃ³nico</button>
      <button class="acceso-btn"><span class="btn-icon">ğŸ”‘</span> Passkey</button>
    </div>
    <button class="acceso-explorar" onclick="switchScreen('eleccion')">Explorar sin cuenta</button>
  </div>
  <div class="vignette"></div>
</section>

<!-- â•â•â• SCREEN 8: ELECCIÃ“N â•â•â• -->
<section id="eleccion" class="screen">
  <div class="screen-bg">
    <img src="assets/backgrounds/brasa/state-2.webp" alt="" class="bg-eleccion">
    <div class="screen-bg-overlay"></div>
  </div>
  <canvas class="particle-canvas" id="eleccion-particles"></canvas>
  <h2 class="eleccion-title">Elige a tu compaÃ±ero</h2>
  <div class="eleccion-essences">
    <div class="eleccion-essence" onclick="selectEssence(this, 'brasa')">
      <div class="essence-sprite-container">
        <div class="essence-glow essence-glow-brasa"></div>
        <img src="assets/reggie/brasa.webp" alt="Brasa" class="sprite-brasa">
      </div>
      <span class="essence-name">Brasa</span>
      <span class="essence-quote">Lo que queda despuÃ©s del fuego aÃºn calienta.</span>
    </div>
    <div class="eleccion-essence" onclick="selectEssence(this, 'niebla')">
      <div class="essence-sprite-container">
        <div class="essence-glow essence-glow-niebla"></div>
        <img src="assets/reggie/niebla.webp" alt="Niebla" class="sprite-niebla">
      </div>
      <span class="essence-name">Niebla</span>
      <span class="essence-quote">Lo esencial se revela cuando lo demÃ¡s se oculta.</span>
    </div>
    <div class="eleccion-essence" onclick="selectEssence(this, 'cristal')">
      <div class="essence-sprite-container">
        <div class="essence-glow essence-glow-cristal"></div>
        <img src="assets/reggie/cristal.webp" alt="Cristal" class="sprite-cristal">
      </div>
      <span class="essence-name">Cristal</span>
      <span class="essence-quote">La presiÃ³n crea lo que el tiempo no puede destruir.</span>
    </div>
  </div>
  <div class="eleccion-name-input">
    <label>Nombre de tu compaÃ±ero</label>
    <input type="text" placeholder="..." maxlength="20">
  </div>
  <button class="btn-despertar" onclick="switchScreen('nacimiento')">Despertar</button>
  <div class="vignette"></div>
</section>

<!-- â•â•â• SCREEN 9: NACIMIENTO â•â•â• -->
<section id="nacimiento" class="screen">
  <div class="nacimiento-dark" id="nacimiento-dark"></div>
  <div class="nacimiento-light" id="nacimiento-light"></div>
  <div id="nacimiento-converge-container"></div>
  <img src="assets/reggie/brasa.webp" alt="Reggie" class="nacimiento-sprite" id="nacimiento-sprite">
  <div class="nacimiento-text" id="nacimiento-text">EstÃ¡ despertando...</div>
  <canvas class="particle-canvas" id="nacimiento-particles"></canvas>
  <div class="vignette"></div>
</section>

<!-- â•â•â• SCREEN 10: CAPTURA â•â•â• -->
<section id="captura" class="screen">
  <div class="screen-bg">
    <img src="assets/backgrounds/brasa/state-3.webp" alt="" class="bg-captura">
    <div class="screen-bg-overlay"></div>
  </div>
  <div class="captura-container">
    <img src="assets/reggie/brasa.webp" alt="Reggie" class="captura-reggie-float" id="captura-reggie-sprite">
    <h2 class="captura-header">Reggie quiere ver tu mundo</h2>
    <p class="captura-prompt">Hay algo allÃ¡ afuera que brilla sin electricidad... Â¿me lo mostrarÃ­as?</p>
    <div class="captura-buttons">
      <button class="captura-btn">ğŸ“¸ Capturar</button>
      <button class="captura-btn">ğŸ–¼ï¸ GalerÃ­a</button>
    </div>
    <div class="captura-result">
      <div class="captura-image">
        <div class="captura-image-frame"></div>
      </div>
      <div class="captura-details">
        <div class="captura-reaction">âœ¦ reggie observa con curiosidad... su luz se intensifica</div>
        <div class="captura-stats">
          <span class="captura-stat">+3 calor</span>
          <span class="captura-stat">+2 vida</span>
          <span class="captura-stat">+1 luz</span>
        </div>
        <div class="captura-diary">"EncontrÃ© algo verde entre el concreto. Reggie temblÃ³ un poco â€” creo que lo reconociÃ³."</div>
      </div>
    </div>
  </div>
  <div class="vignette"></div>
</section>

<!-- â•â•â• SCREEN 11: LA RED â•â•â• -->
<section id="lared" class="screen">
  <div class="screen-bg">
    <img src="assets/backgrounds/brasa/state-3.webp" alt="" class="bg-lared">
    <div class="screen-bg-overlay"></div>
  </div>
  <canvas class="particle-canvas" id="lared-particles"></canvas>
  <div class="lared-container">
    <h2 class="lared-title">La Red</h2>
    <span class="lared-subtitle">Huellas de otros viajeros</span>
    <div class="lared-feed">
      <div class="lared-whisper">Un viajero de Niebla regenerÃ³ su mundo... las siluetas se aclararon un poco.</div>
      <div class="lared-whisper">Alguien enviÃ³ un pulso de luz desde un lugar que olÃ­a a lluvia.</div>
      <div class="lared-whisper">Un compaÃ±ero de Cristal creciÃ³ una faceta nueva hoy.</div>
      <div class="lared-whisper">Dos viajeros se encontraron en silencio. El mundo se iluminÃ³ brevemente.</div>
    </div>
    <div class="lared-presence">
      <img src="assets/reggie/brasa.webp" alt="Reggie" class="lared-mini-reggie" id="lared-reggie-sprite">
      <span class="lared-presence-text">Tu Brasa late suavemente... estÃ¡s conectado a la red.</span>
    </div>
    <div class="lared-pulse-section">
      <div class="lared-pulse-label">enviar un pulso</div>
      <button class="lared-pulse-btn">Enviar luz</button>
    </div>
  </div>
  <div class="vignette"></div>
</section>

<!-- â•â•â• SCREEN 12: OTRO VIAJERO â•â•â• -->
<section id="viajero" class="screen">
  <div class="screen-bg">
    <img src="assets/backgrounds/cristal/state-3.webp" alt="" class="bg-viajero">
    <div class="screen-bg-overlay"></div>
  </div>
  <canvas class="particle-canvas" id="viajero-particles"></canvas>
  <div class="viajero-container">
    <span class="viajero-note">EstÃ¡s visitando el viaje de alguien mÃ¡s.</span>
    <img src="assets/reggie/cristal.webp" alt="Lumina" class="viajero-reggie">
    <span class="viajero-name">Lumina</span>
    <span class="viajero-type">ğŸ’ Cristal</span>
    <div class="viajero-world">
      <img src="assets/backgrounds/cristal/state-3.webp" alt="">
      <div class="viajero-world-ground"></div>
    </div>
    <div class="viajero-progress">
      <div class="viajero-progress-bar">
        <div class="viajero-progress-fill"></div>
      </div>
      <span class="viajero-progress-label">68% regenerado</span>
    </div>
    <div class="viajero-actions">
      <button class="viajero-action">Alimentar</button>
      <button class="viajero-action">Regalar</button>
      <button class="viajero-action">Enviar pulso</button>
    </div>
    <button class="viajero-back" onclick="switchScreen('lared')">â† volver</button>
  </div>
  <div class="vignette"></div>
</section>

<script>
// â”€â”€ State â”€â”€
let currentScreen = 'umbral';
let currentType = 'brasa';
const typeEmojis = { brasa: 'ğŸ”¥', niebla: 'ğŸŒ«ï¸', cristal: 'ğŸ’' };

// â”€â”€ Tab Navigation â”€â”€
const tabs = document.querySelectorAll('.tab-nav button');
const screens = document.querySelectorAll('.screen');

function switchScreen(id) {
  currentScreen = id;
  screens.forEach(s => s.classList.remove('active'));
  tabs.forEach(t => t.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  document.querySelector(`[data-screen="${id}"]`).classList.add('active');

  if (id === 'fractura') startFractura();
  if (id === 'dialogo') startTerminalWhisper();
  if (id === 'despertar') startDespertar();
  if (id === 'origen') startOrigen();
  if (id === 'nacimiento') startNacimiento();
}

tabs.forEach(t => t.addEventListener('click', () => switchScreen(t.dataset.screen)));

// â”€â”€ Type Switcher â”€â”€
function switchType(type) {
  currentType = type;
  // Update type selector buttons
  document.querySelectorAll('.type-selector button').forEach(b => {
    b.classList.toggle('active', b.dataset.type === type);
  });

  const spritePath = `assets/reggie/${type}.webp`;

  // Update all Reggie sprites
  const spriteIds = ['reggie-mundo-sprite', 'dialogo-reggie-sprite', 'fractura-reggie-sprite', 'nacimiento-sprite', 'captura-reggie-sprite', 'lared-reggie-sprite'];
  spriteIds.forEach(id => {
    const el = document.getElementById(id);
    if (el) el.src = spritePath;
  });

  // Update type badge
  const badge = document.getElementById('mundo-type-badge');
  if (badge) badge.textContent = `${typeEmojis[type]} ${type.charAt(0).toUpperCase() + type.slice(1)}`;

  // Update all background images
  updateBackgrounds(type);
}

function updateBackgrounds(type) {
  // Screen backgrounds (single images)
  const bgMap = {
    'bg-umbral': `assets/backgrounds/${type}/state-1.webp`,
    'bg-despertar': `assets/backgrounds/${type}/state-1.webp`,
    'bg-origen': `assets/backgrounds/${type}/state-1.webp`,
    'bg-acceso': `assets/backgrounds/${type}/state-2.webp`,
    'bg-eleccion': `assets/backgrounds/${type}/state-2.webp`,
    'bg-dialogo': `assets/backgrounds/${type}/state-2.webp`,
    'bg-captura': `assets/backgrounds/${type}/state-3.webp`,
    'bg-lared': `assets/backgrounds/${type}/state-3.webp`,
  };
  Object.entries(bgMap).forEach(([cls, src]) => {
    const el = document.querySelector(`.${cls}`);
    if (el) el.src = src;
  });

  // El Mundo 4-state backgrounds
  const mundoBg = document.getElementById('mundo-bg-states');
  if (mundoBg) {
    mundoBg.querySelectorAll('img').forEach(img => {
      const state = img.dataset.state;
      if (state) img.src = `assets/backgrounds/${type}/state-${state}.webp`;
    });
  }

  // Fractura backgrounds
  const fracturaBg = document.getElementById('fractura-bg-states');
  if (fracturaBg) {
    const imgs = fracturaBg.querySelectorAll('img');
    if (imgs[0]) imgs[0].src = `assets/backgrounds/${type}/state-1.webp`;
    if (imgs[1]) imgs[1].src = `assets/backgrounds/${type}/state-4.webp`;
  }
}

// â”€â”€ Regeneration Slider (El Mundo) â”€â”€
const regenSlider = document.getElementById('regen-slider');
const regenValue = document.getElementById('regen-value');

regenSlider.addEventListener('input', () => {
  const val = parseInt(regenSlider.value);
  regenValue.textContent = val + '%';
  updateMundoBackground(val);
});

function updateMundoBackground(progress) {
  const mundoBg = document.getElementById('mundo-bg-states');
  const imgs = mundoBg.querySelectorAll('img[data-state]');

  // Map 0-100 to states 1-4 with crossfade
  // 0-33: state1 â†’ state2, 33-66: state2 â†’ state3, 66-100: state3 â†’ state4
  const segment = progress / 33.33;
  const lower = Math.floor(segment); // 0,1,2
  const frac = segment - lower;

  imgs.forEach((img, i) => {
    if (i === lower && lower < 3) {
      img.style.opacity = 1 - frac;
      img.classList.toggle('bg-active', true);
    } else if (i === lower + 1 && lower < 3) {
      img.style.opacity = frac;
      img.classList.toggle('bg-active', frac > 0);
    } else if (lower >= 3 && i === 3) {
      img.style.opacity = 1;
      img.classList.toggle('bg-active', true);
    } else {
      img.style.opacity = 0;
      img.classList.remove('bg-active');
    }
  });
}

// â”€â”€ Particle System (organic spores) â”€â”€
function initParticles(canvasId, config = {}) {
  const canvas = document.getElementById(canvasId);
  if (!canvas) return;
  const ctx = canvas.getContext('2d');
  const particles = [];
  const count = config.count || 40;
  const colors = config.colors || ['rgba(232,213,183,', 'rgba(212,165,116,', 'rgba(184,196,208,'];

  function resize() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
  }
  resize();
  window.addEventListener('resize', resize);

  for (let i = 0; i < count; i++) {
    particles.push({
      x: Math.random() * canvas.width,
      y: Math.random() * canvas.height,
      size: Math.random() * 2.5 + 0.5,
      speedX: (Math.random() - 0.5) * 0.3,
      speedY: -Math.random() * 0.4 - 0.1,
      opacity: 0,
      maxOpacity: Math.random() * 0.4 + 0.1,
      phase: Math.random() * Math.PI * 2,
      color: colors[Math.floor(Math.random() * colors.length)]
    });
  }

  function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    for (const p of particles) {
      p.x += p.speedX + Math.sin(p.phase) * 0.1;
      p.y += p.speedY;
      p.phase += 0.008;
      p.opacity = p.maxOpacity * (0.5 + 0.5 * Math.sin(p.phase));
      if (p.y < -10) { p.y = canvas.height + 10; p.x = Math.random() * canvas.width; }
      if (p.x < -10) p.x = canvas.width + 10;
      if (p.x > canvas.width + 10) p.x = -10;

      ctx.beginPath();
      ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
      ctx.fillStyle = p.color + p.opacity + ')';
      ctx.fill();
    }
    requestAnimationFrame(draw);
  }
  draw();
}

initParticles('umbral-particles', { count: 50, colors: ['rgba(232,213,183,', 'rgba(184,196,208,'] });
initParticles('mundo-particles', { count: 35, colors: ['rgba(199,91,57,', 'rgba(212,165,116,', 'rgba(232,213,183,'] });
initParticles('fractura-particles', { count: 25, colors: ['rgba(127,176,105,', 'rgba(232,213,183,'] });
initParticles('despertar-particles', { count: 30, colors: ['rgba(232,213,183,', 'rgba(184,196,208,'] });
initParticles('origen-particles', { count: 20, colors: ['rgba(232,213,183,', 'rgba(212,165,116,'] });
initParticles('acceso-particles', { count: 25, colors: ['rgba(184,196,208,', 'rgba(232,213,183,'] });
initParticles('eleccion-particles', { count: 30, colors: ['rgba(232,213,183,', 'rgba(184,196,208,'] });
initParticles('nacimiento-particles', { count: 15, colors: ['rgba(232,213,183,', 'rgba(212,165,116,'] });
initParticles('lared-particles', { count: 20, colors: ['rgba(184,196,208,', 'rgba(232,213,183,'] });
initParticles('viajero-particles', { count: 20, colors: ['rgba(155,184,211,', 'rgba(232,213,183,'] });

// â”€â”€ Parallax (El Mundo) â”€â”€
document.addEventListener('mousemove', (e) => {
  if (currentScreen !== 'mundo') return;
  const cx = (e.clientX / window.innerWidth - 0.5) * 2;
  const cy = (e.clientY / window.innerHeight - 0.5) * 2;
  document.querySelectorAll('.mundo-layer').forEach(layer => {
    const depth = parseFloat(layer.dataset.depth) || 0;
    layer.style.transform = `translate(${cx * depth * -60}px, ${cy * depth * -40}px)`;
  });
});

// â”€â”€ Terminal Whisper (DiÃ¡logo) â”€â”€
let whisperStarted = false;
function startTerminalWhisper() {
  if (whisperStarted) return;
  whisperStarted = true;
  const elements = document.querySelectorAll('.terminal-text');
  elements.forEach((el, i) => {
    const text = el.dataset.text;
    el.textContent = '';
    const delay = i * 2500;
    setTimeout(() => {
      let idx = 0;
      const interval = setInterval(() => {
        el.textContent += text[idx];
        idx++;
        if (idx >= text.length) clearInterval(interval);
      }, 35);
    }, delay + 800);
  });
}

// â”€â”€ Fractura Animation â”€â”€
let fracturaStarted = false;
function startFractura() {
  if (fracturaStarted) return;
  fracturaStarted = true;

  const burst = document.getElementById('fractura-burst');
  for (let i = 0; i < 30; i++) {
    const p = document.createElement('div');
    p.className = 'fractura-burst-particle';
    const angle = Math.random() * Math.PI * 2;
    const dist = 100 + Math.random() * 300;
    p.style.setProperty('--bx', `${Math.cos(angle) * dist}px`);
    p.style.setProperty('--by', `${Math.sin(angle) * dist}px`);
    p.style.background = Math.random() > 0.5 ? 'var(--lichen)' : 'var(--glow)';
    p.style.width = p.style.height = (2 + Math.random() * 4) + 'px';
    burst.appendChild(p);
  }

  // Start with state-1 visible
  const fracturaBg = document.getElementById('fractura-bg-states');
  const imgs = fracturaBg.querySelectorAll('img');
  imgs[0].style.opacity = 1;
  imgs[1].style.opacity = 0;

  setTimeout(() => {
    document.getElementById('fractura-crack').classList.add('cracked');
  }, 500);
  setTimeout(() => {
    document.getElementById('fractura-light').classList.add('flooded');
    document.getElementById('fractura-bg-overlay').classList.add('awakened');
    // Dramatic crossfade from state-1 to state-4
    imgs[0].style.opacity = 0;
    imgs[1].style.opacity = 1;
    burst.querySelectorAll('.fractura-burst-particle').forEach((p, i) => {
      setTimeout(() => p.classList.add('burst'), i * 50);
    });
  }, 1500);
  setTimeout(() => {
    document.getElementById('fractura-growth').classList.add('grown');
  }, 2000);
  setTimeout(() => {
    document.getElementById('fractura-text').classList.add('visible');
    document.getElementById('fractura-reggie-sprite').classList.add('visible');
  }, 2500);
}

// â”€â”€ Despertar (Loading) â”€â”€
let despertarStarted = false;
function startDespertar() {
  if (despertarStarted) return;
  despertarStarted = true;
  const root = document.getElementById('despertar-root');
  let progress = 0;
  const interval = setInterval(() => {
    progress += Math.random() * 3 + 0.5;
    if (progress >= 100) {
      progress = 100;
      clearInterval(interval);
      setTimeout(() => {
        document.getElementById('despertar-whisper').classList.add('visible');
      }, 800);
    }
    root.style.width = progress + '%';
  }, 120);
}

// â”€â”€ El Origen (Lore) â”€â”€
let origenStarted = false;
function startOrigen() {
  if (origenStarted) return;
  origenStarted = true;
  const lines = document.querySelectorAll('.origen-line');
  lines.forEach((line, i) => {
    setTimeout(() => line.classList.add('visible'), i * 1800 + 400);
  });
  setTimeout(() => {
    document.getElementById('origen-continuar').classList.add('visible');
  }, lines.length * 1800 + 1200);
}

// â”€â”€ ElecciÃ³n â”€â”€
function selectEssence(el, type) {
  document.querySelectorAll('.eleccion-essence').forEach(e => e.classList.remove('selected'));
  el.classList.add('selected');
  switchType(type);
}

// â”€â”€ Nacimiento â”€â”€
let nacimientoStarted = false;
function startNacimiento() {
  if (nacimientoStarted) return;
  nacimientoStarted = true;
  const text = document.getElementById('nacimiento-text');
  const light = document.getElementById('nacimiento-light');
  const container = document.getElementById('nacimiento-converge-container');
  const sprite = document.getElementById('nacimiento-sprite');

  for (let i = 0; i < 20; i++) {
    const p = document.createElement('div');
    p.className = 'nacimiento-converge';
    const angle = Math.random() * Math.PI * 2;
    const dist = 200 + Math.random() * 300;
    const sx = Math.cos(angle) * dist;
    const sy = Math.sin(angle) * dist;
    p.style.left = `calc(50% + ${sx}px)`;
    p.style.top = `calc(50% + ${sy}px)`;
    p.style.setProperty('--cx', `${-sx}px`);
    p.style.setProperty('--cy', `${-sy}px`);
    p.style.background = Math.random() > 0.5 ? 'var(--glow)' : 'var(--amber)';
    p.style.width = p.style.height = (2 + Math.random() * 3) + 'px';
    container.appendChild(p);
  }

  setTimeout(() => text.classList.add('visible'), 500);
  setTimeout(() => {
    container.querySelectorAll('.nacimiento-converge').forEach((p, i) => {
      setTimeout(() => p.classList.add('active'), i * 80);
    });
  }, 1500);
  setTimeout(() => light.classList.add('grow'), 2000);
  setTimeout(() => {
    text.classList.add('fade-out');
    sprite.classList.add('reveal');
  }, 4000);
  setTimeout(() => light.classList.add('burst'), 5500);
}
</script>
</body>
</html>
