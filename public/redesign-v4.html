<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Reggie's Adventure â€” Redesign v4 Preview</title>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
<style>
/* ===== RESET & BASE ===== */
* { margin: 0; padding: 0; box-sizing: border-box; }

:root {
  /* Dark palette */
  --bg-void: #0a0a0f;
  --cyan: #00f0ff;
  --purple: #b44aff;
  --gold: #f5c542;
  --text-primary: #e0e0e0;
  --text-dim: #8a8a8a; /* WCAG 4.5:1 on #0a0a0f */
  --surface: #1a1a2a;
  --surface-2: #12121f;
  --border: #222233;
  --red: #ff3b5c;
  --green: #00ff88;

  /* Light palette */
  --bg-papiro: #f4e8c1;
  --ink-dark: #8b6914;
  --ink-red: #8b2500;
  --border-papiro: #c4a56a;
  --surface-papiro: #efe0b9;
  --ink-green: #4a6b2a;

  /* Type colors */
  --type-rayo: #00f0ff;
  --type-flama: #ff6b35;
  --type-hielo: #b44aff;

  /* Font sizes â€” rem, scales proportionally across devices */
  --fs-xs: 0.5rem;
  --fs-sm: 0.625rem;
  --fs-base: 0.75rem;
  --fs-lg: 0.875rem;
  --fs-xl: 1rem;
  --fs-2xl: 1.375rem;
  --fs-3xl: 1.75rem;
}

body {
  font-family: 'Press Start 2P', monospace;
  background: var(--bg-void);
  color: var(--text-primary);
  image-rendering: pixelated;
  overflow-x: hidden;
  min-height: 100vh;
}

/* ===== SCANLINES ===== */
body::after {
  content: '';
  position: fixed; inset: 0; z-index: 9998;
  background: repeating-linear-gradient(0deg, transparent 0px, transparent 2px, rgba(0,0,0,0.06) 2px, rgba(0,0,0,0.06) 4px);
  pointer-events: none;
}

/* ===== VIGNETTE OVERLAY ===== */
.vignette {
  position: absolute; inset: 0;
  background: radial-gradient(ellipse at center, transparent 50%, rgba(0,0,0,0.4) 100%);
  pointer-events: none;
  z-index: 0;
}
body.light .vignette {
  background: radial-gradient(ellipse at center, transparent 60%, rgba(100,70,20,0.12) 100%);
}

/* ===== PREVIEW NAV ===== */
.preview-nav {
  position: fixed; top: 0; left: 0; right: 0; z-index: 9999;
  background: var(--bg-void);
  border-bottom: 1px solid var(--border);
  display: flex; gap: 4px; padding: 8px 12px;
  overflow-x: auto; flex-wrap: nowrap; align-items: center;
  box-shadow: 0 2px 20px rgba(0,240,255,0.05);
}
.preview-nav button {
  font-family: inherit; font-size: var(--fs-xs); padding: 6px 10px;
  background: transparent; color: var(--text-dim); border: 1px solid var(--border);
  cursor: pointer; white-space: nowrap; transition: all 0.3s;
}
.preview-nav button:hover {
  color: var(--cyan); border-color: rgba(0,240,255,0.4);
  text-shadow: 0 0 8px rgba(0,240,255,0.3);
}
.preview-nav button.active {
  color: var(--cyan); border-color: var(--cyan);
  background: rgba(0,240,255,0.05);
  text-shadow: 0 0 10px rgba(0,240,255,0.4);
  box-shadow: 0 0 10px rgba(0,240,255,0.1), inset 0 0 10px rgba(0,240,255,0.05);
}
.theme-toggle {
  margin-left: auto;
  font-family: inherit; font-size: var(--fs-xs); padding: 6px 12px;
  background: transparent; color: var(--purple); border: 1px solid rgba(180,74,255,0.4);
  cursor: pointer; white-space: nowrap; transition: all 0.3s;
}
.theme-toggle:hover {
  background: rgba(180,74,255,0.1); border-color: var(--purple);
  text-shadow: 0 0 8px rgba(180,74,255,0.4);
}

/* ===== SCREEN CONTAINER ===== */
.screen {
  display: none;
  min-height: 100vh;
  padding-top: 3rem;
  position: relative;
}
.screen.active { display: flex; }

/* ===== SHARED COMPONENTS â€” NES STYLE ===== */

/* NES Pixel Container â€” thick borders, solid shadow, no blur */
.pixel-container {
  background: var(--surface);
  border: 4px solid var(--text-primary);
  padding: 1.25rem;
  position: relative;
  box-shadow: 4px 4px 0 rgba(0,240,255,0.15);
}
.pixel-container::after {
  content: '';
  position: absolute; inset: 3px;
  border: 2px solid var(--border);
  pointer-events: none;
}

/* ===== RUNIC CORNER DECORATIONS ===== */
.rune-corners { position: relative; }
.rune-corners .rune-tl,
.rune-corners .rune-tr,
.rune-corners .rune-bl,
.rune-corners .rune-br {
  position: absolute;
  font-family: serif;
  font-size: 1rem;
  color: var(--cyan);
  opacity: 0.1;
  pointer-events: none;
  z-index: 3;
  line-height: 1;
}
.rune-corners .rune-tl { top: 6px; left: 8px; }
.rune-corners .rune-tr { top: 6px; right: 8px; }
.rune-corners .rune-bl { bottom: 6px; left: 8px; }
.rune-corners .rune-br { bottom: 6px; right: 8px; }
body.light .rune-corners .rune-tl,
body.light .rune-corners .rune-tr,
body.light .rune-corners .rune-bl,
body.light .rune-corners .rune-br {
  color: var(--ink-dark);
  opacity: 0.12;
}

/* NES Button â€” em padding scales with font-size */
.glow-btn {
  font-family: inherit;
  font-size: var(--fs-base);
  padding: 0.85em 1.75em;
  background: var(--surface);
  color: var(--cyan);
  border: 4px solid var(--text-primary);
  cursor: pointer;
  transition: all 0.1s;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  box-shadow: 4px 4px 0 #000;
}
.glow-btn:hover {
  background: var(--surface-2);
  color: #fff;
  text-shadow: 0 0 8px var(--cyan);
}
.glow-btn:active {
  box-shadow: 0px 0px 0 #000;
  transform: translate(4px, 4px);
}
.glow-btn.purple { color: var(--purple); }
.glow-btn.purple:hover { text-shadow: 0 0 8px var(--purple); }
.glow-btn.gold { color: var(--gold); }
.glow-btn.gold:hover { text-shadow: 0 0 8px var(--gold); }
.glow-btn.disabled { opacity: 0.3; pointer-events: none; }

/* NES Dialog Box */
.nes-dialog {
  background: #111119;
  border: 4px solid #fff;
  padding: 1.25rem;
  position: relative;
  box-shadow: 6px 6px 0 rgba(0,0,0,0.6);
}
.nes-dialog::after {
  content: '';
  position: absolute; inset: 3px;
  border: 2px solid #444;
  pointer-events: none;
}

/* NES Card */
.nes-card {
  background: var(--surface-2);
  border: 4px solid var(--border);
  padding: 1.25rem;
  box-shadow: 4px 4px 0 rgba(0,0,0,0.4);
  transition: border-color 0.3s;
}
.nes-card:hover { border-color: var(--text-dim); }

/* ===== FRAGMENT PARTICLES (diamond shards) ===== */
@keyframes float-fragment {
  0%, 100% { transform: translateY(0) translateX(0) rotate(45deg); opacity: 0.2; }
  25% { transform: translateY(-25px) translateX(6px) rotate(45deg); opacity: 0.6; }
  50% { transform: translateY(-50px) translateX(-4px) rotate(45deg); opacity: 0.4; }
  75% { transform: translateY(-70px) translateX(3px) rotate(45deg); opacity: 0.15; }
}

.fragment-particle {
  position: absolute;
  width: 5px; height: 5px;
  background: var(--cyan);
  transform: rotate(45deg);
  animation: float-fragment 5s infinite ease-in-out;
  box-shadow: 0 0 6px var(--cyan), 0 0 12px rgba(0,240,255,0.2);
}
body.light .fragment-particle {
  background: var(--ink-dark);
  box-shadow: 0 0 4px rgba(139,105,20,0.3);
}

.fragment-particles {
  position: absolute; inset: 0;
  overflow: hidden;
  pointer-events: none;
  z-index: 0;
}

/* Legacy particle compat */
.particle {
  position: absolute;
  width: 5px; height: 5px;
  background: var(--cyan);
  transform: rotate(45deg);
  animation: float-fragment 5s infinite ease-in-out;
  box-shadow: 0 0 6px var(--cyan), 0 0 12px rgba(0,240,255,0.2);
}
body.light .particle {
  background: var(--ink-dark);
  box-shadow: 0 0 4px rgba(139,105,20,0.3);
}

/* ===== ANIMATIONS ===== */
@keyframes pulse-glow {
  0%, 100% { opacity: 0.5; text-shadow: 0 0 10px rgba(0,240,255,0.3); }
  50% { opacity: 1; text-shadow: 0 0 30px rgba(0,240,255,0.8), 0 0 60px rgba(0,240,255,0.3); }
}

@keyframes blink {
  0%, 100% { opacity: 1; }
  50% { opacity: 0; }
}

@keyframes glitch-shift {
  0%, 100% { transform: translate(0); }
  20% { transform: translate(-2px, 1px); }
  40% { transform: translate(2px, -1px); }
  60% { transform: translate(-1px, -1px); }
  80% { transform: translate(1px, 2px); }
}

@keyframes typewriter-cursor {
  0%, 100% { border-color: var(--cyan); }
  50% { border-color: transparent; }
}

@keyframes spin-slow {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

@keyframes spin-slow-reverse {
  0% { transform: rotate(360deg); }
  100% { transform: rotate(0deg); }
}

@keyframes fade-in {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes slide-up {
  from { opacity: 0; transform: translateY(30px); }
  to { opacity: 1; transform: translateY(0); }
}

@keyframes breathe {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-6px); }
}

@keyframes bar-fill {
  from { width: 0%; }
}

@keyframes energy-pulse {
  0%, 100% { box-shadow: 0 0 20px rgba(0,240,255,0.1); }
  50% { box-shadow: 0 0 40px rgba(0,240,255,0.3), 0 0 80px rgba(180,74,255,0.1); }
}

@keyframes dots {
  0% { content: '.'; }
  33% { content: '..'; }
  66% { content: '...'; }
}

@keyframes transmission-pulse {
  0%, 100% { border-color: rgba(255,255,255,0.9); }
  50% { border-color: rgba(255,255,255,0.5); }
}

@keyframes bar-glow-pulse {
  0%, 100% { box-shadow: 0 0 4px rgba(0,240,255,0.3); }
  50% { box-shadow: 0 0 12px rgba(0,240,255,0.6), 0 0 20px rgba(0,240,255,0.2); }
}

@keyframes spark-fly {
  0% { opacity: 1; transform: translate(0, 0) rotate(45deg) scale(1); }
  100% { opacity: 0; transform: translate(var(--sx, 10px), var(--sy, -20px)) rotate(45deg) scale(0); }
}

@keyframes flash-pulse {
  0%, 100% { opacity: 0; }
  50% { opacity: 0.6; }
}

@keyframes fracture-line {
  0% { opacity: 0; transform: scaleX(0); }
  30% { opacity: 0.4; transform: scaleX(1); }
  100% { opacity: 0; transform: scaleX(1); }
}

/* Type-specific particle animations */
@keyframes electric-jitter {
  0%, 100% { transform: translateY(0) translateX(0) rotate(45deg); opacity: 0.5; }
  10% { transform: translateY(-3px) translateX(8px) rotate(45deg); opacity: 0.9; }
  20% { transform: translateY(2px) translateX(-5px) rotate(45deg); opacity: 0.3; }
  40% { transform: translateY(-8px) translateX(3px) rotate(45deg); opacity: 0.8; }
  60% { transform: translateY(4px) translateX(-7px) rotate(45deg); opacity: 0.4; }
  80% { transform: translateY(-6px) translateX(6px) rotate(45deg); opacity: 0.7; }
}

@keyframes flame-rise {
  0% { transform: translateY(0) rotate(45deg); opacity: 0.6; }
  50% { transform: translateY(-30px) rotate(45deg); opacity: 0.8; }
  100% { transform: translateY(-60px) rotate(45deg); opacity: 0; }
}

@keyframes crystal-float {
  0%, 100% { transform: translateY(0) translateX(0) rotate(45deg); opacity: 0.3; }
  50% { transform: translateY(-15px) translateX(5px) rotate(45deg); opacity: 0.6; }
}

/* =========================================
   P1 â€” LOADING NES
   ========================================= */
.screen-loading {
  flex-direction: column;
  align-items: center;
  justify-content: center;
  background: var(--bg-void);
  gap: 1.875rem;
}

.loading-logo {
  font-size: var(--fs-2xl);
  color: var(--cyan);
  text-shadow: 3px 3px 0 #003a3f;
  text-align: center;
  line-height: 1.6;
  animation: nes-pulse 2s infinite;
  z-index: 1;
}
@keyframes nes-pulse {
  0%, 100% { opacity: 0.85; }
  50% { opacity: 1; }
}
.loading-logo .sub {
  display: block;
  font-size: var(--fs-lg);
  color: var(--purple);
  text-shadow: 2px 2px 0 #1a003f;
  margin-top: 0.5rem;
}

.loading-bar-container {
  width: 17.5rem;
  height: 1rem;
  border: 4px solid #fff;
  background: #111;
  position: relative;
  overflow: hidden;
  box-shadow: 4px 4px 0 rgba(0,0,0,0.5);
  z-index: 1;
}
.loading-bar-fill {
  height: 100%;
  background: var(--cyan);
  width: 0%;
  animation: bar-fill 2.5s ease-out forwards, bar-glow-pulse 1s infinite;
  position: relative;
}
.loading-bar-container::after {
  content: '';
  position: absolute; inset: 0;
  background: repeating-linear-gradient(90deg, transparent 0px, transparent 8px, rgba(0,0,0,0.5) 8px, rgba(0,0,0,0.5) 10px);
  z-index: 1;
}

/* Loading sparks container */
.loading-sparks {
  position: absolute; top: 0; left: 0; right: 0; bottom: 0;
  pointer-events: none; z-index: 2;
  overflow: visible;
}
.loading-spark {
  position: absolute;
  width: 3px; height: 3px;
  background: #fff;
  transform: rotate(45deg);
  opacity: 0;
  animation: spark-fly 0.6s ease-out forwards;
}

.loading-text {
  font-size: var(--fs-xs);
  color: var(--text-dim);
  letter-spacing: 0.125em;
  z-index: 1;
}

.loading-particles {
  position: absolute; inset: 0;
  overflow: hidden;
  pointer-events: none;
}

/* =========================================
   P2 â€” LOADING + FULLSCREEN
   ========================================= */
.screen-fullscreen {
  flex-direction: column;
  align-items: center;
  justify-content: center;
  background: var(--bg-void);
  gap: 1.5rem;
}

.fullscreen-icon {
  font-size: 2rem;
  animation: breathe 3s infinite;
  z-index: 1;
}

.fullscreen-title {
  font-size: var(--fs-lg);
  color: var(--text-primary);
  text-align: center;
  line-height: 1.8;
  z-index: 1;
}

.fullscreen-subtitle {
  font-size: var(--fs-sm);
  color: var(--text-dim);
  text-align: center;
  line-height: 2;
  max-width: 20rem;
  z-index: 1;
}

.fullscreen-buttons {
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
  margin-top: 0.625rem;
  z-index: 1;
}

/* =========================================
   P3 â€” TITLE
   ========================================= */
.screen-title {
  flex-direction: column;
  align-items: center;
  justify-content: center;
  background: var(--bg-void);
  position: relative;
  overflow: hidden;
}

.title-bg-runes {
  position: absolute;
  width: 280px; height: 280px;
  display: flex; align-items: center; justify-content: center;
  pointer-events: none;
  animation: spin-slow 90s linear infinite;
  z-index: 0;
}
.title-bg-runes .rune-circle-char {
  position: absolute;
  font-family: serif;
  font-size: 24px;
  color: rgba(0,240,255,0.04);
  transform-origin: 0 140px;
}
body.light .title-bg-runes .rune-circle-char {
  color: rgba(139,105,20,0.06);
}

.title-vignette {
  position: absolute; inset: 0;
  background: radial-gradient(ellipse at center, transparent 40%, rgba(0,0,0,0.5) 100%);
  pointer-events: none;
  z-index: 0;
}
body.light .title-vignette {
  background: radial-gradient(ellipse at center, transparent 50%, rgba(100,70,20,0.15) 100%);
}

.title-main {
  font-size: var(--fs-3xl);
  color: var(--cyan);
  text-shadow: 4px 4px 0 #0a3a3f, -1px -1px 0 #006070;
  text-align: center;
  line-height: 1.5;
  position: relative;
  z-index: 2;
}
/* Glitch only on hover â€” subtle, not constant */
.title-main:hover { animation: glitch-shift 0.3s; }
.title-main .adventure {
  display: block;
  font-size: var(--fs-xl);
  color: var(--purple);
  text-shadow: 3px 3px 0 #2a0a3f;
  margin-top: 8px;
}

.title-decorative-regenmons {
  display: flex;
  gap: 2.5rem;
  margin: 1.875rem 0;
  opacity: 0.5;
  font-size: 1.5rem;
  z-index: 1;
}

.title-press-start {
  font-size: var(--fs-base);
  color: var(--gold);
  animation: blink 1.2s infinite;
  cursor: pointer;
  padding: 1em 2em;
  border: 1px solid transparent;
  transition: all 0.3s;
  z-index: 2;
  margin-top: 1.25rem;
}
.title-press-start:hover {
  border-color: var(--gold);
  background: rgba(245,197,66,0.05);
  text-shadow: 0 0 15px rgba(245,197,66,0.5);
}

.title-music-toggle {
  position: absolute;
  top: 3.75rem; right: 1rem;
  font-size: var(--fs-sm);
  color: var(--text-dim);
  background: none; border: 1px solid var(--border);
  padding: 0.5em;
  cursor: pointer;
  transition: all 0.3s;
  z-index: 3;
}
.title-music-toggle:hover {
  color: var(--cyan); border-color: var(--cyan);
}

.title-version {
  position: absolute;
  bottom: 1rem; right: 1rem;
  font-size: var(--fs-xs);
  color: var(--text-dim);
  opacity: 0.4;
  z-index: 2;
}

/* =========================================
   P4 â€” TYPEWRITER (HISTORIA)
   ========================================= */
.screen-typewriter {
  flex-direction: column;
  align-items: center;
  justify-content: center;
  background: var(--bg-void);
  padding: 3rem 1.25rem;
}

.typewriter-box {
  max-width: 31.25rem;
  width: 100%;
  background: #111119;
  border: 3px solid #fff;
  padding: 1.5rem;
  position: relative;
  box-shadow: 4px 4px 0 rgba(0,0,0,0.6);
  animation: transmission-pulse 3s infinite ease-in-out;
  z-index: 1;
}
/* Inner double border */
.typewriter-box .inner-border {
  position: absolute; inset: 3px;
  border: 2px solid #444;
  pointer-events: none;
}
/* Rune decoration bottom-right */
.typewriter-box::after {
  content: 'â—†';
  position: absolute;
  bottom: 6px; right: 10px;
  font-size: 0.5rem;
  color: var(--cyan);
  opacity: 0.15;
  pointer-events: none;
}
.typewriter-box::before {
  content: 'â—† â–¶ TRANSMISSION';
  position: absolute; top: -0.625rem; left: 0.75rem;
  font-size: var(--fs-xs);
  color: var(--cyan);
  background: var(--bg-void);
  padding: 0 0.5rem;
  letter-spacing: 0.05em;
  z-index: 2;
}
/* Rune corner decorations on typewriter */
.typewriter-rune-tl {
  position: absolute; top: 6px; left: 8px;
  font-family: serif; font-size: 0.8rem;
  color: var(--cyan); opacity: 0.1;
  pointer-events: none; z-index: 3;
}

.typewriter-text {
  font-size: var(--fs-sm);
  line-height: 2.4;
  color: var(--cyan);
  text-shadow: 0 0 5px rgba(0,240,255,0.3);
  min-height: 9.375rem;
}

.typewriter-cursor {
  display: inline-block;
  width: 0.5em; height: 1em;
  background: var(--cyan);
  margin-left: 0.25em;
  animation: blink 0.8s infinite;
  vertical-align: middle;
  box-shadow: 0 0 8px var(--cyan);
}

.typewriter-continue {
  margin-top: 1.25rem;
  text-align: right;
  opacity: 0;
  transition: opacity 0.5s;
  z-index: 1;
}
.typewriter-continue.visible { opacity: 1; }

/* =========================================
   P5 â€” INICIAR SESIÃ“N (PRIVY)
   ========================================= */
.screen-login {
  flex-direction: column;
  align-items: center;
  justify-content: center;
  background: rgba(10,10,15,0.95);
}

.login-modal {
  max-width: 23.75rem;
  width: 90%;
  background: #111119;
  border: 4px solid #fff;
  padding: 2rem 1.5rem;
  box-shadow: 6px 6px 0 rgba(0,0,0,0.6);
  position: relative;
  z-index: 1;
}
/* Inner double border */
.login-modal::after {
  content: '';
  position: absolute; inset: 4px;
  border: 2px solid var(--purple);
  pointer-events: none;
}

.login-title {
  font-size: var(--fs-lg);
  color: var(--purple);
  text-align: center;
  margin-bottom: 0.5rem;
  text-shadow: 0 0 8px rgba(180,74,255,0.4);
}

.login-subtitle {
  font-size: var(--fs-sm);
  color: var(--text-dim);
  text-align: center;
  margin-bottom: 1.5rem;
  line-height: 2;
}

.login-options {
  display: flex;
  flex-direction: column;
  gap: 0.625rem;
}

.login-btn {
  font-family: inherit;
  font-size: var(--fs-sm);
  padding: 0.875em;
  background: var(--surface);
  color: var(--text-primary);
  border: 3px solid var(--text-dim);
  cursor: pointer;
  transition: all 0.1s;
  display: flex;
  align-items: center;
  gap: 0.625rem;
  box-shadow: 3px 3px 0 #000;
}
.login-btn:hover {
  border-color: var(--purple);
  color: #fff;
}
.login-btn:active {
  box-shadow: 0 0 0 #000;
  transform: translate(3px, 3px);
}
.login-btn .icon { font-size: 1rem; }

.login-divider {
  text-align: center;
  font-size: var(--fs-xs);
  color: var(--text-dim);
  margin: 1rem 0;
  position: relative;
}
.login-divider::before, .login-divider::after {
  content: '';
  position: absolute;
  top: 50%;
  width: 30%;
  height: 1px;
  background: var(--border);
}
.login-divider::before { left: 0; }
.login-divider::after { right: 0; }

.login-demo {
  font-family: inherit;
  font-size: var(--fs-xs);
  padding: 0.75em;
  background: transparent;
  color: var(--text-dim);
  border: 2px dashed var(--text-dim);
  cursor: pointer;
  transition: all 0.1s;
  text-align: center;
  width: 100%;
}
.login-demo:hover {
  color: var(--gold); border-color: var(--gold);
}
.login-demo:active {
  transform: translate(2px, 2px);
}

/* =========================================
   P6 â€” CREACIÃ“N
   ========================================= */
.screen-creation {
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  background: var(--bg-void);
  padding: 3.75rem 1.25rem 2.5rem;
  gap: 1.25rem;
}

.creation-title {
  font-size: var(--fs-xl);
  color: var(--cyan);
  text-shadow: 0 0 20px rgba(0,240,255,0.4);
  text-align: center;
  z-index: 1;
}

.creation-subtitle {
  font-size: var(--fs-xs);
  color: var(--text-dim);
  text-align: center;
  line-height: 2;
  max-width: 25rem;
  z-index: 1;
}

/* Carousel */
.creation-carousel {
  display: flex;
  align-items: center;
  gap: 1rem;
  width: 100%;
  max-width: 25rem;
  justify-content: center;
  z-index: 1;
}

.carousel-arrow {
  font-family: inherit;
  font-size: var(--fs-xl);
  color: var(--text-dim);
  background: var(--surface);
  border: 3px solid var(--text-dim);
  width: 2.75rem; height: 2.75rem;
  display: flex; align-items: center; justify-content: center;
  cursor: pointer;
  transition: all 0.1s;
  box-shadow: 3px 3px 0 #000;
}
.carousel-arrow:hover {
  color: var(--cyan); border-color: var(--cyan);
}
.carousel-arrow:active {
  box-shadow: 0 0 0 #000;
  transform: translate(3px, 3px);
}

.carousel-card {
  flex: 1;
  max-width: 16.25rem;
  text-align: center;
  padding: 1.5rem 1rem;
  background: #111119;
  border: 4px solid var(--text-dim);
  transition: all 0.3s;
  position: relative;
  box-shadow: 4px 4px 0 rgba(0,0,0,0.5);
  overflow: visible;
}
.carousel-card.type-rayo {
  border-color: var(--type-rayo);
  box-shadow: 4px 4px 0 #003a3f;
}
.carousel-card.type-flama {
  border-color: var(--type-flama);
  box-shadow: 4px 4px 0 #3f1a00;
}
.carousel-card.type-hielo {
  border-color: var(--type-hielo);
  box-shadow: 4px 4px 0 #1a003f;
}

/* Type-specific floating particles on carousel */
.type-particles {
  position: absolute; inset: -20px;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.5s;
}
.carousel-card .type-particles { opacity: 1; }

.type-particle {
  position: absolute;
  width: 5px; height: 5px;
  transform: rotate(45deg);
}

/* Rayo particles */
.type-rayo-particles .type-particle {
  background: var(--type-rayo);
  box-shadow: 0 0 6px var(--type-rayo);
  animation: electric-jitter 1.5s infinite;
}
.type-rayo-particles .type-particle:nth-child(1) { top: 10%; left: -8px; animation-delay: 0s; }
.type-rayo-particles .type-particle:nth-child(2) { top: 50%; right: -8px; animation-delay: 0.4s; }
.type-rayo-particles .type-particle:nth-child(3) { bottom: 20%; left: -8px; animation-delay: 0.8s; }
.type-rayo-particles .type-particle:nth-child(4) { top: 30%; right: -8px; animation-delay: 1.2s; }

/* Flama particles */
.type-flama-particles .type-particle {
  background: var(--type-flama);
  box-shadow: 0 0 6px var(--type-flama);
  animation: flame-rise 2s infinite;
}
.type-flama-particles .type-particle:nth-child(1) { bottom: 0; left: 15%; animation-delay: 0s; }
.type-flama-particles .type-particle:nth-child(2) { bottom: 0; left: 45%; animation-delay: 0.5s; }
.type-flama-particles .type-particle:nth-child(3) { bottom: 0; right: 15%; animation-delay: 1s; }
.type-flama-particles .type-particle:nth-child(4) { bottom: 0; left: 70%; animation-delay: 1.5s; }

/* Hielo particles */
.type-hielo-particles .type-particle {
  background: var(--type-hielo);
  box-shadow: 0 0 6px var(--type-hielo);
  animation: crystal-float 4s infinite;
}
.type-hielo-particles .type-particle:nth-child(1) { top: 20%; left: -8px; animation-delay: 0s; }
.type-hielo-particles .type-particle:nth-child(2) { top: 60%; right: -8px; animation-delay: 1s; }
.type-hielo-particles .type-particle:nth-child(3) { bottom: 10%; left: -8px; animation-delay: 2s; }
.type-hielo-particles .type-particle:nth-child(4) { top: 40%; right: -8px; animation-delay: 3s; }

.carousel-sprite {
  font-size: 3rem;
  display: block;
  margin-bottom: 0.75rem;
  animation: breathe 3s infinite;
}

.carousel-type-name {
  font-size: var(--fs-lg);
  margin-bottom: 0.25rem;
}
.type-rayo .carousel-type-name { color: var(--type-rayo); text-shadow: 0 0 10px rgba(0,240,255,0.4); }
.type-flama .carousel-type-name { color: var(--type-flama); text-shadow: 0 0 10px rgba(255,107,53,0.4); }
.type-hielo .carousel-type-name { color: var(--type-hielo); text-shadow: 0 0 10px rgba(180,74,255,0.4); }

.carousel-type-title {
  font-size: var(--fs-xs);
  color: var(--gold);
  margin-bottom: 0.5rem;
}

.carousel-type-desc {
  font-size: var(--fs-xs);
  color: var(--text-dim);
  line-height: 2;
}

/* Dots */
.carousel-dots {
  display: flex;
  gap: 0.625rem;
  justify-content: center;
  z-index: 1;
}
.carousel-dot {
  width: 8px; height: 8px;
  border: 1px solid var(--text-dim);
  background: transparent;
  cursor: pointer;
  transition: all 0.3s;
}
.carousel-dot.active {
  background: var(--cyan);
  border-color: var(--cyan);
  box-shadow: 0 0 8px var(--cyan);
}

/* Name input */
.creation-name-wrapper {
  width: 100%;
  max-width: 21.875rem;
  z-index: 1;
}

.creation-name-input {
  font-family: inherit;
  font-size: var(--fs-base);
  width: 100%;
  padding: 0.875em;
  background: #111;
  color: var(--text-primary);
  border: 4px solid var(--text-dim);
  outline: none;
  transition: all 0.1s;
  text-align: center;
  box-shadow: inset 3px 3px 0 rgba(0,0,0,0.5);
}
.creation-name-input::placeholder { color: var(--text-dim); }
.creation-name-input:focus {
  border-color: var(--cyan);
}

.creation-char-count {
  text-align: right;
  font-size: var(--fs-xs);
  color: var(--text-dim);
  margin-top: 0.25rem;
  transition: color 0.3s;
}
.creation-char-count.valid { color: var(--green); }
.creation-char-count.invalid { color: var(--red); }

/* =========================================
   P7 â€” TRANSICIÃ“N
   ========================================= */
.screen-transition {
  flex-direction: column;
  align-items: center;
  justify-content: center;
  background: var(--bg-void);
  gap: 1.25rem;
  animation: energy-pulse 2s infinite;
}

/* Flash pulse overlay */
.transition-flash {
  position: absolute; inset: 0;
  background: rgba(0,240,255,0.05);
  animation: flash-pulse 2s infinite;
  pointer-events: none;
  z-index: 0;
}

.transition-sprite {
  font-size: 3.5rem;
  animation: breathe 1.5s infinite;
  filter: brightness(1.5);
  text-shadow: 0 0 40px rgba(0,240,255,0.5);
  z-index: 2;
  position: relative;
}

/* Fracture lines radiating from sprite */
.fracture-lines {
  position: absolute;
  width: 200px; height: 200px;
  pointer-events: none;
  z-index: 1;
}
.fracture-line {
  position: absolute;
  top: 50%; left: 50%;
  width: 80px; height: 1px;
  background: rgba(0,240,255,0.3);
  transform-origin: 0 0;
  animation: fracture-line 3s infinite;
}
.fracture-line:nth-child(1) { transform: rotate(0deg); animation-delay: 0s; }
.fracture-line:nth-child(2) { transform: rotate(45deg); animation-delay: 0.3s; }
.fracture-line:nth-child(3) { transform: rotate(90deg); animation-delay: 0.6s; }
.fracture-line:nth-child(4) { transform: rotate(135deg); animation-delay: 0.9s; }
.fracture-line:nth-child(5) { transform: rotate(180deg); animation-delay: 1.2s; }
.fracture-line:nth-child(6) { transform: rotate(225deg); animation-delay: 1.5s; }
.fracture-line:nth-child(7) { transform: rotate(270deg); animation-delay: 1.8s; }
.fracture-line:nth-child(8) { transform: rotate(315deg); animation-delay: 2.1s; }

.transition-text {
  font-size: var(--fs-lg);
  color: var(--cyan);
  text-shadow: 0 0 20px rgba(0,240,255,0.5);
  text-align: center;
  z-index: 2;
}

.transition-dots {
  font-size: var(--fs-lg);
  color: var(--purple);
  z-index: 2;
}
.transition-dots .dot {
  animation: blink 1s infinite;
}
.transition-dots .dot:nth-child(2) { animation-delay: 0.3s; }
.transition-dots .dot:nth-child(3) { animation-delay: 0.6s; }

.transition-energy-ring {
  width: 9.375rem; height: 9.375rem;
  border: 3px solid rgba(0,240,255,0.25);
  border-radius: 50%;
  position: absolute;
  animation: spin-slow 4s linear infinite;
  box-shadow: 0 0 30px rgba(0,240,255,0.1);
}
.transition-energy-ring .ring-runes {
  position: absolute; inset: -6px;
  font-family: serif; font-size: 10px;
  color: rgba(0,240,255,0.2);
  text-align: center;
}
.transition-energy-ring .ring-rune {
  position: absolute;
  transform-origin: center;
}
.transition-energy-ring:nth-child(2) {
  width: 200px; height: 200px;
  border-color: rgba(180,74,255,0.2);
  border-width: 3px;
  animation: spin-slow-reverse 6s linear infinite;
  box-shadow: 0 0 30px rgba(180,74,255,0.1);
}

/* =========================================
   LIGHT THEME OVERRIDES
   ========================================= */
body.light {
  background: var(--bg-papiro);
  color: var(--ink-dark);
}
body.light::after {
  background: repeating-linear-gradient(0deg, transparent 0px, transparent 3px, rgba(139,105,20,0.04) 3px, rgba(139,105,20,0.04) 6px);
}

/* Nav light */
body.light .preview-nav {
  background: var(--bg-papiro);
  border-bottom-color: var(--border-papiro);
  box-shadow: 0 2px 10px rgba(139,105,20,0.1);
}
body.light .preview-nav button {
  color: var(--border-papiro); border-color: var(--border-papiro);
}
body.light .preview-nav button:hover {
  color: var(--ink-red); border-color: var(--ink-red);
  text-shadow: none;
}
body.light .preview-nav button.active {
  color: var(--ink-red); border-color: var(--ink-red);
  background: rgba(139,37,0,0.05);
  text-shadow: none; box-shadow: none;
}
body.light .theme-toggle {
  color: var(--ink-red); border-color: var(--border-papiro);
}

/* P1 Loading light */
body.light .screen-loading { background: var(--bg-papiro); }
body.light .loading-logo {
  color: var(--ink-red);
  text-shadow: 2px 2px 0 rgba(139,105,20,0.2);
  animation: none;
}
body.light .loading-logo .sub { color: var(--ink-dark); text-shadow: none; }
body.light .loading-bar-container {
  border-color: var(--ink-dark); box-shadow: none;
}
body.light .loading-bar-fill {
  background: linear-gradient(90deg, var(--ink-red), var(--ink-dark));
  box-shadow: none;
  animation: bar-fill 2.5s ease-out forwards;
}
body.light .loading-text { color: var(--border-papiro); }

/* P2 Fullscreen light */
body.light .screen-fullscreen { background: var(--bg-papiro); }
body.light .fullscreen-title { color: var(--ink-dark); }
body.light .fullscreen-subtitle { color: var(--border-papiro); }
body.light .glow-btn {
  color: var(--ink-red); border-color: var(--ink-red);
}
body.light .glow-btn:hover {
  background: rgba(139,37,0,0.05);
  box-shadow: none; text-shadow: none;
}
body.light .glow-btn.purple {
  color: var(--ink-dark); border-color: var(--ink-dark);
}
body.light .glow-btn.purple:hover {
  background: rgba(139,105,20,0.05);
}

/* P3 Title light */
body.light .screen-title { background: var(--bg-papiro); }
body.light .title-main {
  color: var(--ink-red);
  text-shadow: 3px 3px 0 rgba(139,105,20,0.2);
  animation: none;
}
body.light .title-main .adventure {
  color: var(--ink-dark);
  text-shadow: 2px 2px 0 rgba(196,165,106,0.3);
}
body.light .title-press-start { color: var(--ink-dark); }
body.light .title-press-start:hover {
  border-color: var(--ink-dark);
  background: rgba(139,105,20,0.05);
  text-shadow: none;
}
body.light .title-music-toggle {
  color: var(--border-papiro); border-color: var(--border-papiro);
}
body.light .title-version { color: var(--border-papiro); }

/* P4 Typewriter light */
body.light .screen-typewriter { background: var(--bg-papiro); }
body.light .typewriter-box {
  background: var(--surface-papiro);
  border-color: var(--border-papiro);
  box-shadow: 2px 2px 0 rgba(139,105,20,0.2);
  animation: none;
}
body.light .typewriter-box::before {
  content: 'ðŸ“œ PERGAMINO ANCESTRAL';
  color: var(--ink-dark);
  background: var(--bg-papiro);
}
body.light .typewriter-box::after {
  color: var(--ink-dark);
}
body.light .typewriter-rune-tl { color: var(--ink-dark); }
body.light .typewriter-text {
  color: var(--ink-dark);
  text-shadow: none;
}
body.light .typewriter-cursor {
  background: var(--ink-dark);
  box-shadow: none;
}

/* P5 Login light */
body.light .screen-login { background: rgba(244,232,193,0.97); }
body.light .login-modal {
  background: rgba(239,224,185,0.98);
  border-color: var(--border-papiro);
  backdrop-filter: none;
  box-shadow: 3px 3px 0 rgba(139,105,20,0.2);
}
body.light .login-modal::before, body.light .login-modal::after {
  color: var(--ink-red); text-shadow: none;
}
body.light .login-title { color: var(--ink-red); text-shadow: none; }
body.light .login-subtitle { color: var(--border-papiro); }
body.light .login-btn {
  background: var(--bg-papiro); color: var(--ink-dark); border-color: var(--border-papiro);
}
body.light .login-btn:hover {
  border-color: var(--ink-red); background: rgba(139,37,0,0.03);
  box-shadow: none;
}
body.light .login-divider { color: var(--border-papiro); }
body.light .login-divider::before, body.light .login-divider::after { background: var(--border-papiro); }
body.light .login-demo { color: var(--border-papiro); border-color: var(--border-papiro); }
body.light .login-demo:hover { color: var(--ink-dark); border-color: var(--ink-dark); }

/* P6 Creation light */
body.light .screen-creation { background: var(--bg-papiro); }
body.light .creation-title {
  color: var(--ink-red);
  text-shadow: 2px 2px 0 rgba(139,105,20,0.2);
}
body.light .creation-subtitle { color: var(--border-papiro); }
body.light .carousel-arrow {
  color: var(--border-papiro); border-color: var(--border-papiro);
}
body.light .carousel-arrow:hover {
  color: var(--ink-red); border-color: var(--ink-red);
  box-shadow: none;
}
body.light .carousel-card {
  background: var(--surface-papiro);
  border-color: var(--border-papiro);
}
body.light .carousel-card.type-rayo {
  border-color: var(--ink-dark); box-shadow: 2px 2px 0 rgba(139,105,20,0.15);
}
body.light .carousel-card.type-flama {
  border-color: var(--ink-red); box-shadow: 2px 2px 0 rgba(139,37,0,0.15);
}
body.light .carousel-card.type-hielo {
  border-color: var(--ink-dark); box-shadow: 2px 2px 0 rgba(139,105,20,0.15);
}
body.light .type-rayo .carousel-type-name { color: var(--ink-dark); text-shadow: none; }
body.light .type-flama .carousel-type-name { color: var(--ink-red); text-shadow: none; }
body.light .type-hielo .carousel-type-name { color: var(--ink-dark); text-shadow: none; }
body.light .carousel-type-title { color: var(--ink-red); }
body.light .carousel-type-desc { color: var(--border-papiro); }
body.light .carousel-dot { border-color: var(--border-papiro); }
body.light .carousel-dot.active {
  background: var(--ink-red); border-color: var(--ink-red); box-shadow: none;
}
body.light .creation-name-input {
  background: var(--bg-papiro); color: var(--ink-dark); border-color: var(--border-papiro);
}
body.light .creation-name-input:focus {
  border-color: var(--ink-red); box-shadow: none;
}
body.light .creation-name-input::placeholder { color: var(--border-papiro); }
body.light .creation-char-count { color: var(--border-papiro); }
body.light .creation-char-count.valid { color: var(--ink-green); }
body.light .creation-char-count.invalid { color: var(--ink-red); }

/* P7 Transition light */
body.light .screen-transition {
  background: var(--bg-papiro);
  animation: none;
}
body.light .transition-flash { display: none; }
body.light .transition-text {
  color: var(--ink-dark); text-shadow: none;
}
body.light .transition-sprite { filter: none; text-shadow: none; }
body.light .transition-dots .dot { color: var(--ink-red); }
body.light .transition-energy-ring {
  border-color: rgba(139,105,20,0.15); box-shadow: none;
}
body.light .transition-energy-ring .ring-runes { color: rgba(139,105,20,0.15); }
body.light .fracture-line { background: rgba(139,105,20,0.15); }

/* Light type particles */
body.light .type-rayo-particles .type-particle { background: var(--ink-dark); box-shadow: none; }
body.light .type-flama-particles .type-particle { background: var(--ink-red); box-shadow: none; }
body.light .type-hielo-particles .type-particle { background: var(--ink-dark); box-shadow: none; }

/* ===========================================
   RESPONSIVE â€” MOBILE FIRST (375px base)
   =========================================== */

/* ===== MOBILE BASE (375px) â€” base styles ARE mobile ===== */
.preview-nav { padding: 0.375rem 0.5rem; gap: 0.1875rem; }
.preview-nav button { font-size: 0.4rem; padding: 0.3rem 0.4rem; }

/* Buttons: full width on mobile */
.glow-btn { width: 100%; max-width: 20rem; }

/* --- Medium Devices / Tablets (641px+) --- */
@media (min-width: 641px) {
  :root {
    --fs-xs: 0.625rem;
    --fs-sm: 0.75rem;
    --fs-base: 0.875rem;
    --fs-lg: 1rem;
    --fs-xl: 1.25rem;
    --fs-2xl: 1.625rem;
    --fs-3xl: 2.125rem;
  }
  .preview-nav { padding: 0.5rem 0.75rem; gap: 0.25rem; }
  .preview-nav button { font-size: var(--fs-xs); padding: 0.375rem 0.625rem; }

  .loading-bar-container { width: 18.75rem; }

  .title-decorative-regenmons { gap: 2.75rem; font-size: 2.75rem; }

  .typewriter-box { padding: 1.75rem; max-width: 32.5rem; }

  .login-modal { max-width: 25rem; padding: 2rem 1.5rem; }

  .carousel-card { padding: 1.75rem 1.25rem; }
  .carousel-sprite { font-size: 4.5rem; }

  .glow-btn { width: auto; max-width: none; }
  .fullscreen-buttons { width: auto; }

  .transition-sprite { font-size: 5.5rem; }
}

/* --- Large Devices / Desktops (1025px+) --- */
@media (min-width: 1025px) {
  :root {
    --fs-xs: 0.75rem;
    --fs-sm: 0.875rem;
    --fs-base: 1rem;
    --fs-lg: 1.125rem;
    --fs-xl: 1.375rem;
    --fs-2xl: 1.75rem;
    --fs-3xl: 2.25rem;
  }
  .loading-bar-container { width: 21.25rem; }
  .typewriter-box { max-width: 37.5rem; }
  .login-modal { max-width: 27.5rem; }
  .carousel-card { max-width: 20rem; padding: 2rem 1.5rem; }
  .carousel-sprite { font-size: 5rem; }
  .transition-sprite { font-size: 6rem; }
}

/* =========================================
   BLOCK 2+3 â€” SCREENS 8-19
   ========================================= */

/* ===== P8 â€” TUTORIAL ===== */
.screen-tutorial {
  flex-direction: column;
  align-items: center;
  justify-content: center;
  background: rgba(10,10,15,0.92);
}
.tutorial-modal {
  max-width: 26rem; width: 90%;
  background: #111119; border: 4px solid #fff;
  padding: 1.75rem 1.25rem;
  box-shadow: 6px 6px 0 rgba(0,0,0,0.6);
  position: relative; z-index: 1;
}
.tutorial-modal::after {
  content: ''; position: absolute; inset: 3px;
  border: 2px solid #444; pointer-events: none;
}
.tutorial-step-title {
  font-size: var(--fs-lg); color: var(--cyan);
  text-align: center; margin-bottom: 0.5rem;
}
.tutorial-step-badge {
  display: inline-block; font-size: var(--fs-xs);
  background: var(--gold); color: #000;
  padding: 0.15em 0.5em; margin-left: 0.5em;
  border: 2px solid #000;
}
.tutorial-step-icon {
  font-size: 2.5rem; text-align: center;
  display: block; margin: 0.75rem 0;
  animation: breathe 3s infinite;
}
.tutorial-step-desc {
  font-size: var(--fs-xs); color: var(--text-dim);
  text-align: center; line-height: 2.2;
  margin-bottom: 1rem;
}
.tutorial-dots {
  display: flex; gap: 0.5rem; justify-content: center;
  margin-bottom: 1rem;
}
.tutorial-dot {
  width: 8px; height: 8px;
  border: 1px solid var(--text-dim);
  background: transparent; cursor: pointer;
  transition: all 0.3s;
}
.tutorial-dot.active {
  background: var(--cyan); border-color: var(--cyan);
  box-shadow: 0 0 8px var(--cyan);
}
.tutorial-dot.completed { background: var(--text-dim); }
.tutorial-nav {
  display: flex; justify-content: space-between;
  align-items: center; gap: 0.5rem;
}
.tutorial-skip {
  font-family: inherit; font-size: var(--fs-xs);
  background: transparent; color: var(--text-dim);
  border: 1px dashed var(--text-dim);
  padding: 0.5em 1em; cursor: pointer;
  transition: all 0.2s;
}
.tutorial-skip:hover { color: var(--gold); border-color: var(--gold); }

/* ===== P9 â€” WORLD/HOME ===== */
.screen-world {
  flex-direction: column;
  background: var(--bg-void);
  position: relative; overflow: hidden;
}
.world-hud {
  display: flex; justify-content: space-between;
  align-items: center; padding: 0.5rem 0.75rem;
  background: var(--surface-2); border-bottom: 3px solid var(--border);
  font-size: var(--fs-xs); z-index: 2;
}
.world-hud-left, .world-hud-right {
  display: flex; gap: 0.75rem; align-items: center;
}
.world-hud-item { color: var(--text-dim); }
.world-hud-item span { color: var(--cyan); }
.world-landscape {
  flex: 1; display: flex; flex-direction: column;
  align-items: center; justify-content: center;
  position: relative; min-height: 14rem;
  background: linear-gradient(180deg, #0a0a2f 0%, #0f1535 40%, #1a1a2a 100%);
}
.world-landscape-label {
  position: absolute; top: 0.5rem; left: 0.75rem;
  font-size: var(--fs-xs); color: var(--text-dim);
  opacity: 0.5;
}
.world-sprite {
  font-size: 4rem; animation: breathe 3s infinite;
  z-index: 1; cursor: pointer;
  transition: transform 0.1s;
}
.world-sprite:active { transform: scale(0.9); }
.world-stats {
  display: flex; flex-direction: column; gap: 0.5rem;
  padding: 0.75rem; background: var(--surface-2);
  border-top: 3px solid var(--border);
  border-bottom: 3px solid var(--border);
  z-index: 2;
}
.stat-bar-row {
  display: flex; align-items: center; gap: 0.5rem;
  font-size: var(--fs-xs);
}
.stat-bar-label { width: 5.5rem; color: var(--text-dim); }
.stat-bar-track {
  flex: 1; height: 0.75rem;
  background: #111; border: 2px solid var(--border);
  position: relative; overflow: hidden;
}
.stat-bar-fill {
  height: 100%; transition: width 0.5s;
}
.stat-bar-fill.spirit { background: var(--purple); }
.stat-bar-fill.pulse { background: var(--gold); }
.stat-bar-fill.essence { background: var(--green); }
.stat-bar-value { font-size: var(--fs-xs); color: var(--text-dim); width: 2rem; text-align: right; }

.world-actions {
  display: flex; justify-content: center; gap: 0.5rem;
  padding: 0.5rem; z-index: 2;
}
.world-action-btn {
  font-family: inherit; font-size: var(--fs-xs);
  padding: 0.5em 0.75em; background: var(--surface);
  color: var(--text-dim); border: 3px solid var(--border);
  cursor: pointer; box-shadow: 3px 3px 0 #000;
  transition: all 0.1s;
}
.world-action-btn:hover { color: var(--cyan); border-color: var(--cyan); }
.world-action-btn:active { box-shadow: 0 0 0; transform: translate(3px,3px); }

.world-bottom-nav {
  display: flex; z-index: 2;
  border-top: 3px solid var(--border);
  background: var(--surface-2);
}
.world-nav-btn {
  flex: 1; font-family: inherit; font-size: var(--fs-xs);
  padding: 0.75em 0.5em; background: transparent;
  color: var(--text-dim); border: none;
  border-right: 2px solid var(--border);
  cursor: pointer; transition: all 0.2s;
  text-align: center;
}
.world-nav-btn:last-child { border-right: none; }
.world-nav-btn:hover { color: var(--cyan); background: rgba(0,240,255,0.03); }
.world-nav-btn.active-tab { color: var(--cyan); background: rgba(0,240,255,0.05); }

/* ===== P10 â€” SETTINGS ===== */
.screen-settings {
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  background: var(--bg-void);
  padding: 3.75rem 1rem 2rem;
}
.settings-panel {
  max-width: 24rem; width: 100%;
  background: #111119; border: 4px solid var(--purple);
  padding: 1.5rem; position: relative;
  box-shadow: 6px 6px 0 rgba(180,74,255,0.15);
}
.settings-panel::after {
  content: ''; position: absolute; inset: 3px;
  border: 2px solid rgba(180,74,255,0.2);
  pointer-events: none;
}
.settings-title {
  font-size: var(--fs-lg); color: var(--purple);
  text-align: center; margin-bottom: 1rem;
}
.settings-group {
  margin-bottom: 1rem;
}
.settings-row {
  display: flex; justify-content: space-between;
  align-items: center; padding: 0.6em 0;
  border-bottom: 1px solid var(--border);
  font-size: var(--fs-xs);
}
.settings-row:last-child { border-bottom: none; }
.settings-label { color: var(--text-dim); }
.settings-toggle {
  width: 2.5rem; height: 1.25rem;
  background: var(--surface); border: 3px solid var(--text-dim);
  cursor: pointer; position: relative;
  transition: all 0.2s;
}
.settings-toggle.on {
  border-color: var(--cyan);
  background: rgba(0,240,255,0.15);
}
.settings-toggle::after {
  content: ''; position: absolute;
  width: 0.6rem; height: 0.6rem;
  background: var(--text-dim); top: 50%;
  left: 2px; transform: translateY(-50%);
  transition: all 0.2s;
}
.settings-toggle.on::after {
  left: calc(100% - 0.6rem - 2px);
  background: var(--cyan);
}
.settings-action-btn {
  font-family: inherit; font-size: var(--fs-xs);
  padding: 0.6em 1em; width: 100%;
  background: var(--surface); color: var(--text-dim);
  border: 3px solid var(--border);
  cursor: pointer; margin-bottom: 0.4rem;
  box-shadow: 3px 3px 0 #000;
  transition: all 0.1s; text-align: left;
}
.settings-action-btn:hover { color: var(--purple); border-color: var(--purple); }
.settings-action-btn:active { box-shadow: 0 0 0; transform: translate(3px,3px); }
.settings-action-btn.danger { color: var(--red); }
.settings-action-btn.danger:hover { border-color: var(--red); }

/* ===== P11 â€” HISTORY ===== */
.screen-history {
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  background: var(--bg-void);
  padding: 3.75rem 1rem 2rem;
}
.history-title {
  font-size: var(--fs-lg); color: var(--cyan);
  margin-bottom: 1rem; text-align: center;
}
.history-list {
  max-width: 24rem; width: 100%;
  display: flex; flex-direction: column; gap: 0.4rem;
}
.history-item {
  display: flex; align-items: center; gap: 0.5rem;
  padding: 0.6em 0.75em; background: var(--surface-2);
  border: 3px solid var(--border);
  font-size: var(--fs-xs);
  box-shadow: 3px 3px 0 rgba(0,0,0,0.3);
}
.history-icon { font-size: 1rem; }
.history-desc { flex: 1; color: var(--text-dim); line-height: 1.8; }
.history-delta { color: var(--green); white-space: nowrap; }
.history-delta.negative { color: var(--red); }
.history-time { color: var(--text-dim); opacity: 0.5; font-size: 0.4rem; white-space: nowrap; }

/* ===== P12 â€” CHAT ===== */
.screen-chat {
  flex-direction: column;
  background: var(--bg-void);
}
.chat-header {
  display: flex; justify-content: space-between;
  align-items: center; padding: 0.5rem 0.75rem;
  background: var(--surface-2); border-bottom: 3px solid var(--border);
  z-index: 2;
}
.chat-header-title { font-size: var(--fs-sm); color: var(--cyan); }
.chat-header-actions { display: flex; gap: 0.5rem; }
.chat-header-btn {
  font-family: inherit; font-size: var(--fs-sm);
  background: transparent; color: var(--text-dim);
  border: 2px solid var(--border); padding: 0.3em 0.5em;
  cursor: pointer; transition: all 0.2s;
}
.chat-header-btn:hover { color: var(--cyan); border-color: var(--cyan); }
.chat-compact-stats {
  display: flex; gap: 0.75rem; padding: 0.3rem 0.75rem;
  background: var(--surface); border-bottom: 2px solid var(--border);
  font-size: var(--fs-xs); color: var(--text-dim);
}
.chat-compact-stats span { color: var(--cyan); }
.chat-messages {
  flex: 1; overflow-y: auto; padding: 0.75rem;
  display: flex; flex-direction: column; gap: 0.5rem;
}
.chat-bubble {
  max-width: 80%; padding: 0.6em 0.75em;
  font-size: var(--fs-xs); line-height: 2;
  border: 3px solid; position: relative;
  box-shadow: 3px 3px 0 rgba(0,0,0,0.3);
}
.chat-bubble.bot {
  align-self: flex-start;
  background: var(--surface-2); border-color: var(--border);
  color: var(--text-primary);
}
.chat-bubble.user {
  align-self: flex-end;
  background: rgba(0,240,255,0.08); border-color: rgba(0,240,255,0.3);
  color: var(--cyan);
}
.chat-typing {
  font-size: var(--fs-xs); color: var(--text-dim);
  padding: 0.3em 0.75em;
}
.chat-typing-dots span {
  animation: blink 1s infinite;
}
.chat-typing-dots span:nth-child(2) { animation-delay: 0.3s; }
.chat-typing-dots span:nth-child(3) { animation-delay: 0.6s; }
.chat-input-bar {
  display: flex; gap: 0.4rem; padding: 0.5rem;
  background: var(--surface-2); border-top: 3px solid var(--border);
}
.chat-input {
  flex: 1; font-family: inherit; font-size: var(--fs-xs);
  padding: 0.6em; background: #111; color: var(--text-primary);
  border: 3px solid var(--border); outline: none;
}
.chat-input:focus { border-color: var(--cyan); }
.chat-send-btn {
  font-family: inherit; font-size: var(--fs-xs);
  padding: 0.6em 1em; background: var(--surface);
  color: var(--cyan); border: 3px solid var(--cyan);
  cursor: pointer; box-shadow: 3px 3px 0 #000;
  transition: all 0.1s;
}
.chat-send-btn:active { box-shadow: 0 0 0; transform: translate(3px,3px); }

/* ===== P13 â€” CAMERA ===== */
.screen-camera {
  flex-direction: column;
  align-items: center;
  justify-content: center;
  background: var(--bg-void);
  padding: 3.75rem 1.25rem 2rem;
  gap: 1rem;
}
.camera-frame {
  max-width: 22rem; width: 100%;
  background: #111119; border: 4px solid var(--cyan);
  padding: 1.5rem; text-align: center;
  box-shadow: 6px 6px 0 rgba(0,240,255,0.15);
  position: relative; z-index: 1;
}
.camera-frame::after {
  content: ''; position: absolute; inset: 3px;
  border: 2px solid rgba(0,240,255,0.2);
  pointer-events: none;
}
.camera-icon { font-size: 2.5rem; margin-bottom: 0.75rem; }
.camera-prompt {
  font-size: var(--fs-sm); color: var(--cyan);
  line-height: 2.2; margin-bottom: 0.75rem;
}
.camera-mission {
  background: var(--surface); border: 3px solid var(--gold);
  padding: 0.6em; font-size: var(--fs-xs);
  color: var(--gold); margin-bottom: 1rem;
  box-shadow: 3px 3px 0 rgba(245,197,66,0.15);
}
.camera-buttons {
  display: flex; flex-direction: column; gap: 0.5rem;
}
.camera-privacy {
  font-size: 0.4rem; color: var(--text-dim);
  line-height: 2; text-align: center;
  margin-top: 0.75rem; max-width: 20rem;
  z-index: 1;
}

/* ===== P14 â€” POST-PHOTO ===== */
.screen-postphoto {
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  background: var(--bg-void);
  padding: 3.75rem 1.25rem 2rem;
  gap: 1rem;
}
.postphoto-result {
  max-width: 24rem; width: 100%;
  background: #111119; border: 4px solid var(--green);
  padding: 1.25rem; text-align: center;
  box-shadow: 6px 6px 0 rgba(0,255,136,0.15);
  position: relative; z-index: 1;
}
.postphoto-result::after {
  content: ''; position: absolute; inset: 3px;
  border: 2px solid rgba(0,255,136,0.2);
  pointer-events: none;
}
.postphoto-title {
  font-size: var(--fs-lg); color: var(--green);
  margin-bottom: 0.5rem;
}
.postphoto-sprite {
  font-size: 3rem; animation: breathe 2s infinite;
  margin: 0.5rem 0;
}
.postphoto-reaction {
  font-size: var(--fs-xs); color: var(--cyan);
  margin-bottom: 0.75rem; line-height: 2;
}
.postphoto-deltas {
  display: flex; justify-content: center; gap: 1rem;
  margin-bottom: 0.75rem;
}
.postphoto-delta {
  font-size: var(--fs-sm); padding: 0.3em 0.5em;
  border: 2px solid var(--border); background: var(--surface);
}
.postphoto-delta.positive { color: var(--green); border-color: rgba(0,255,136,0.3); }
.postphoto-delta.negative { color: var(--red); border-color: rgba(255,59,92,0.3); }
.postphoto-diary {
  font-size: var(--fs-xs); color: var(--text-dim);
  line-height: 2.2; text-align: left;
  padding: 0.75em; background: var(--surface);
  border: 2px solid var(--border);
  margin-bottom: 0.75rem;
}
.postphoto-buttons {
  display: flex; gap: 0.5rem; justify-content: center;
  flex-wrap: wrap;
}

/* ===== P15 â€” FRACTURA ===== */
.screen-fractura {
  flex-direction: column;
  align-items: center;
  justify-content: center;
  background: var(--bg-void);
  position: relative; overflow: hidden;
}
@keyframes fractura-flash {
  0% { opacity: 0; }
  10% { opacity: 0.8; }
  30% { opacity: 0.1; }
  50% { opacity: 0.6; }
  70% { opacity: 0; }
  100% { opacity: 0; }
}
@keyframes fractura-shake {
  0%, 100% { transform: translate(0); }
  10% { transform: translate(-4px, 2px); }
  20% { transform: translate(3px, -3px); }
  30% { transform: translate(-2px, 4px); }
  40% { transform: translate(4px, -2px); }
  50% { transform: translate(-3px, 3px); }
  60% { transform: translate(2px, -4px); }
  70% { transform: translate(-4px, 2px); }
  80% { transform: translate(3px, -3px); }
  90% { transform: translate(-2px, 4px); }
}
@keyframes fractura-explode {
  0% { transform: translate(0) rotate(45deg) scale(1); opacity: 1; }
  100% { transform: translate(var(--ex,30px), var(--ey,-40px)) rotate(45deg) scale(0); opacity: 0; }
}
.fractura-flash-overlay {
  position: absolute; inset: 0;
  background: rgba(0,240,255,0.5);
  animation: fractura-flash 3s ease-out forwards;
  z-index: 3; pointer-events: none;
}
.fractura-sprite-area {
  animation: fractura-shake 0.8s ease-out 0.5s;
  font-size: 5rem; z-index: 2;
  position: relative; margin: 1rem 0;
}
.fractura-particle-burst {
  position: absolute; inset: -3rem;
  pointer-events: none; z-index: 1;
}
.fractura-particle {
  position: absolute; width: 6px; height: 6px;
  background: var(--cyan); transform: rotate(45deg);
  animation: fractura-explode 1.5s ease-out forwards;
  box-shadow: 0 0 8px var(--cyan);
}
.fractura-narrative {
  font-size: var(--fs-sm); color: var(--purple);
  text-align: center; line-height: 2.4;
  max-width: 22rem; z-index: 2;
  animation: fade-in 1s 1.5s both;
}
.fractura-continue {
  z-index: 2;
  animation: fade-in 1s 2.5s both;
  margin-top: 1rem;
}

/* ===== P16 â€” SOCIAL ===== */
.screen-social {
  flex-direction: column;
  background: var(--bg-void);
  position: relative;
}
.social-tabs {
  display: flex; border-bottom: 3px solid var(--border);
  background: var(--surface-2);
}
.social-tab {
  flex: 1; font-family: inherit; font-size: var(--fs-xs);
  padding: 0.6em; background: transparent;
  color: var(--text-dim); border: none;
  border-bottom: 3px solid transparent;
  cursor: pointer; text-align: center;
  transition: all 0.2s;
}
.social-tab:hover { color: var(--cyan); }
.social-tab.active-tab {
  color: var(--cyan); border-bottom-color: var(--cyan);
}
.social-content {
  flex: 1; overflow-y: auto; padding: 0.75rem;
}
.social-register-prompt {
  text-align: center; padding: 2rem 1rem;
}
.social-register-prompt p {
  font-size: var(--fs-xs); color: var(--text-dim);
  line-height: 2.2; margin-bottom: 1rem;
}
.social-section {
  margin-bottom: 1rem;
}
.social-section-title {
  font-size: var(--fs-xs); color: var(--purple);
  margin-bottom: 0.5rem;
  padding-bottom: 0.25rem;
  border-bottom: 1px solid var(--border);
}
.social-feed-item {
  padding: 0.5em; background: var(--surface-2);
  border: 2px solid var(--border); margin-bottom: 0.3rem;
  font-size: var(--fs-xs); color: var(--text-dim);
  line-height: 1.8;
}
.social-feed-item .feed-name { color: var(--cyan); }
.social-message-item {
  padding: 0.5em; background: var(--surface);
  border: 2px solid var(--border); margin-bottom: 0.3rem;
  font-size: var(--fs-xs); color: var(--text-dim);
  display: flex; gap: 0.5rem; align-items: center;
}
.social-badge {
  display: inline-block; background: var(--red);
  color: #fff; font-size: 0.35rem;
  padding: 0.15em 0.4em; margin-left: 0.3em;
  border: 1px solid #000;
}

/* ===== P17 â€” LEADERBOARD ===== */
.screen-leaderboard {
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  background: var(--bg-void);
  padding: 3.75rem 1rem 2rem;
}
.leaderboard-title {
  font-size: var(--fs-lg); color: var(--gold);
  margin-bottom: 1rem; text-align: center;
  text-shadow: 2px 2px 0 rgba(0,0,0,0.5);
}
.leaderboard-list {
  max-width: 26rem; width: 100%;
  display: flex; flex-direction: column; gap: 0.4rem;
}
.leaderboard-item {
  display: flex; align-items: center; gap: 0.5rem;
  padding: 0.6em 0.75em; background: var(--surface-2);
  border: 3px solid var(--border);
  box-shadow: 3px 3px 0 rgba(0,0,0,0.3);
  cursor: pointer; transition: all 0.2s;
}
.leaderboard-item:hover { border-color: var(--cyan); }
.leaderboard-rank {
  font-size: var(--fs-sm); color: var(--gold);
  width: 2rem; text-align: center;
}
.leaderboard-rank.top-1 { color: var(--gold); text-shadow: 0 0 8px rgba(245,197,66,0.5); }
.leaderboard-rank.top-2 { color: #c0c0c0; }
.leaderboard-rank.top-3 { color: #cd7f32; }
.leaderboard-sprite { font-size: 1.25rem; }
.leaderboard-info { flex: 1; }
.leaderboard-name { font-size: var(--fs-xs); color: var(--text-primary); }
.leaderboard-type { font-size: 0.4rem; color: var(--text-dim); }
.leaderboard-progress {
  width: 3.5rem; height: 0.5rem;
  background: #111; border: 2px solid var(--border);
  overflow: hidden;
}
.leaderboard-progress-fill {
  height: 100%; background: var(--cyan);
}

/* ===== P18 â€” MI PERFIL ===== */
.screen-miperfil {
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  background: var(--bg-void);
  padding: 3.75rem 1.25rem 2rem;
  gap: 1rem;
}
.profile-card {
  max-width: 22rem; width: 100%;
  background: #111119; border: 4px solid var(--cyan);
  padding: 1.5rem; text-align: center;
  box-shadow: 6px 6px 0 rgba(0,240,255,0.15);
  position: relative;
}
.profile-card::after {
  content: ''; position: absolute; inset: 3px;
  border: 2px solid rgba(0,240,255,0.2);
  pointer-events: none;
}
.profile-sprite {
  font-size: 3.5rem; animation: breathe 3s infinite;
  margin-bottom: 0.5rem;
}
.profile-name {
  font-size: var(--fs-lg); color: var(--cyan);
  margin-bottom: 0.25rem;
}
.profile-type {
  font-size: var(--fs-xs); color: var(--text-dim);
  margin-bottom: 0.75rem;
}
.profile-stats-grid {
  display: grid; grid-template-columns: 1fr 1fr 1fr;
  gap: 0.5rem; margin-bottom: 0.75rem;
}
.profile-stat-cell {
  padding: 0.4em; background: var(--surface);
  border: 2px solid var(--border); text-align: center;
}
.profile-stat-cell .stat-val {
  font-size: var(--fs-sm); color: var(--cyan);
}
.profile-stat-cell .stat-lbl {
  font-size: 0.4rem; color: var(--text-dim); margin-top: 0.2em;
}
.profile-memories {
  font-size: var(--fs-xs); color: var(--gold);
  margin-bottom: 0.75rem;
}
.profile-visibility {
  font-size: var(--fs-xs); color: var(--text-dim);
  display: flex; align-items: center;
  justify-content: center; gap: 0.5rem;
}

/* ===== P19 â€” PERFIL PÃšBLICO ===== */
.screen-publicperfil {
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  background: var(--bg-void);
  padding: 3.75rem 1.25rem 2rem;
  gap: 1rem;
}
.public-profile-card {
  max-width: 22rem; width: 100%;
  background: #111119; border: 4px solid var(--purple);
  padding: 1.5rem; text-align: center;
  box-shadow: 6px 6px 0 rgba(180,74,255,0.15);
  position: relative;
}
.public-profile-card::after {
  content: ''; position: absolute; inset: 3px;
  border: 2px solid rgba(180,74,255,0.2);
  pointer-events: none;
}
.public-evolution {
  font-size: var(--fs-xs); color: var(--gold);
  margin-bottom: 0.5rem;
}
.public-actions {
  display: flex; flex-direction: column; gap: 0.4rem;
  margin-top: 0.75rem;
}
.public-action-btn {
  font-family: inherit; font-size: var(--fs-xs);
  padding: 0.6em; background: var(--surface);
  color: var(--text-dim); border: 3px solid var(--border);
  cursor: pointer; box-shadow: 3px 3px 0 #000;
  transition: all 0.1s; text-align: center;
}
.public-action-btn:hover { color: var(--purple); border-color: var(--purple); }
.public-action-btn:active { box-shadow: 0 0 0; transform: translate(3px,3px); }
.public-back-btn {
  font-family: inherit; font-size: var(--fs-xs);
  background: transparent; color: var(--text-dim);
  border: 1px dashed var(--text-dim);
  padding: 0.5em 1em; cursor: pointer;
  transition: all 0.2s;
}
.public-back-btn:hover { color: var(--cyan); border-color: var(--cyan); }

/* =========================================
   LIGHT THEME â€” BLOCK 2+3
   ========================================= */

/* P8 Tutorial light */
body.light .screen-tutorial { background: rgba(244,232,193,0.95); }
body.light .tutorial-modal {
  background: var(--surface-papiro); border-color: var(--border-papiro);
  box-shadow: 3px 3px 0 rgba(139,105,20,0.2);
}
body.light .tutorial-modal::after { border-color: var(--border-papiro); }
body.light .tutorial-step-title { color: var(--ink-red); text-shadow: none; }
body.light .tutorial-step-desc { color: var(--ink-dark); }
body.light .tutorial-step-badge { background: var(--ink-red); color: #fff; }
body.light .tutorial-dot { border-color: var(--border-papiro); }
body.light .tutorial-dot.active { background: var(--ink-red); border-color: var(--ink-red); box-shadow: none; }
body.light .tutorial-dot.completed { background: var(--border-papiro); }
body.light .tutorial-skip { color: var(--border-papiro); border-color: var(--border-papiro); }

/* P9 World light */
body.light .screen-world { background: var(--bg-papiro); }
body.light .world-hud { background: var(--surface-papiro); border-color: var(--border-papiro); }
body.light .world-hud-item { color: var(--ink-dark); }
body.light .world-hud-item span { color: var(--ink-red); }
body.light .world-landscape {
  background: linear-gradient(180deg, #e8d5a0 0%, #d4c08a 40%, var(--surface-papiro) 100%);
}
body.light .world-landscape-label { color: var(--border-papiro); }
body.light .world-stats { background: var(--surface-papiro); border-color: var(--border-papiro); }
body.light .stat-bar-track { background: var(--bg-papiro); border-color: var(--border-papiro); }
body.light .stat-bar-fill.spirit { background: var(--ink-red); }
body.light .stat-bar-fill.pulse { background: var(--ink-dark); }
body.light .stat-bar-fill.essence { background: var(--ink-green); }
body.light .stat-bar-label, body.light .stat-bar-value { color: var(--ink-dark); }
body.light .world-actions { background: transparent; }
body.light .world-action-btn {
  background: var(--bg-papiro); color: var(--ink-dark);
  border-color: var(--border-papiro); box-shadow: 2px 2px 0 rgba(139,105,20,0.15);
}
body.light .world-action-btn:hover { color: var(--ink-red); border-color: var(--ink-red); }
body.light .world-bottom-nav { background: var(--surface-papiro); border-color: var(--border-papiro); }
body.light .world-nav-btn { color: var(--ink-dark); border-color: var(--border-papiro); }
body.light .world-nav-btn:hover { color: var(--ink-red); background: rgba(139,37,0,0.03); }
body.light .world-nav-btn.active-tab { color: var(--ink-red); }

/* P10 Settings light */
body.light .screen-settings { background: var(--bg-papiro); }
body.light .settings-panel {
  background: var(--surface-papiro); border-color: var(--border-papiro);
  box-shadow: 3px 3px 0 rgba(139,105,20,0.15);
}
body.light .settings-panel::after { border-color: var(--border-papiro); }
body.light .settings-title { color: var(--ink-red); text-shadow: none; }
body.light .settings-row { border-color: var(--border-papiro); }
body.light .settings-label { color: var(--ink-dark); }
body.light .settings-toggle { background: var(--bg-papiro); border-color: var(--border-papiro); }
body.light .settings-toggle::after { background: var(--border-papiro); }
body.light .settings-toggle.on { border-color: var(--ink-red); }
body.light .settings-toggle.on::after { background: var(--ink-red); }
body.light .settings-action-btn {
  background: var(--bg-papiro); color: var(--ink-dark);
  border-color: var(--border-papiro); box-shadow: 2px 2px 0 rgba(139,105,20,0.1);
}
body.light .settings-action-btn:hover { color: var(--ink-red); border-color: var(--ink-red); }
body.light .settings-action-btn.danger { color: var(--ink-red); }

/* P11 History light */
body.light .screen-history { background: var(--bg-papiro); }
body.light .history-title { color: var(--ink-red); text-shadow: none; }
body.light .history-item {
  background: var(--surface-papiro); border-color: var(--border-papiro);
  box-shadow: 2px 2px 0 rgba(139,105,20,0.1);
}
body.light .history-desc { color: var(--ink-dark); }
body.light .history-delta { color: var(--ink-green); }
body.light .history-delta.negative { color: var(--ink-red); }

/* P12 Chat light */
body.light .screen-chat { background: var(--bg-papiro); }
body.light .chat-header { background: var(--surface-papiro); border-color: var(--border-papiro); }
body.light .chat-header-title { color: var(--ink-red); }
body.light .chat-header-btn { color: var(--ink-dark); border-color: var(--border-papiro); }
body.light .chat-compact-stats { background: var(--surface-papiro); border-color: var(--border-papiro); color: var(--ink-dark); }
body.light .chat-compact-stats span { color: var(--ink-red); }
body.light .chat-bubble.bot {
  background: var(--surface-papiro); border-color: var(--border-papiro);
  color: var(--ink-dark);
}
body.light .chat-bubble.user {
  background: rgba(139,37,0,0.05); border-color: var(--border-papiro);
  color: var(--ink-red);
}
body.light .chat-typing { color: var(--border-papiro); }
body.light .chat-input-bar { background: var(--surface-papiro); border-color: var(--border-papiro); }
body.light .chat-input {
  background: var(--bg-papiro); color: var(--ink-dark);
  border-color: var(--border-papiro);
}
body.light .chat-input:focus { border-color: var(--ink-red); }
body.light .chat-send-btn {
  background: var(--bg-papiro); color: var(--ink-red);
  border-color: var(--ink-red); box-shadow: 2px 2px 0 rgba(139,105,20,0.15);
}

/* P13 Camera light */
body.light .screen-camera { background: var(--bg-papiro); }
body.light .camera-frame {
  background: var(--surface-papiro); border-color: var(--border-papiro);
  box-shadow: 3px 3px 0 rgba(139,105,20,0.15);
}
body.light .camera-frame::after { border-color: var(--border-papiro); }
body.light .camera-prompt { color: var(--ink-dark); text-shadow: none; }
body.light .camera-mission {
  background: var(--bg-papiro); border-color: var(--ink-dark);
  color: var(--ink-dark); box-shadow: 2px 2px 0 rgba(139,105,20,0.1);
}
body.light .camera-privacy { color: var(--border-papiro); }

/* P14 Post-Photo light */
body.light .screen-postphoto { background: var(--bg-papiro); }
body.light .postphoto-result {
  background: var(--surface-papiro); border-color: var(--ink-green);
  box-shadow: 3px 3px 0 rgba(74,107,42,0.15);
}
body.light .postphoto-result::after { border-color: rgba(74,107,42,0.2); }
body.light .postphoto-title { color: var(--ink-green); }
body.light .postphoto-reaction { color: var(--ink-dark); }
body.light .postphoto-delta { background: var(--bg-papiro); border-color: var(--border-papiro); }
body.light .postphoto-delta.positive { color: var(--ink-green); border-color: var(--ink-green); }
body.light .postphoto-delta.negative { color: var(--ink-red); border-color: var(--ink-red); }
body.light .postphoto-diary { background: var(--bg-papiro); border-color: var(--border-papiro); color: var(--ink-dark); }

/* P15 Fractura light */
body.light .screen-fractura { background: var(--bg-papiro); }
body.light .fractura-flash-overlay { background: rgba(245,197,66,0.4); }
body.light .fractura-particle { background: var(--ink-dark); box-shadow: none; }
body.light .fractura-narrative { color: var(--ink-red); }

/* P16 Social light */
body.light .screen-social { background: var(--bg-papiro); }
body.light .social-tabs { background: var(--surface-papiro); border-color: var(--border-papiro); }
body.light .social-tab { color: var(--ink-dark); }
body.light .social-tab:hover { color: var(--ink-red); }
body.light .social-tab.active-tab { color: var(--ink-red); border-bottom-color: var(--ink-red); }
body.light .social-section-title { color: var(--ink-red); border-color: var(--border-papiro); }
body.light .social-feed-item { background: var(--surface-papiro); border-color: var(--border-papiro); color: var(--ink-dark); }
body.light .social-feed-item .feed-name { color: var(--ink-red); }
body.light .social-message-item { background: var(--bg-papiro); border-color: var(--border-papiro); color: var(--ink-dark); }
body.light .social-register-prompt p { color: var(--ink-dark); }

/* P17 Leaderboard light */
body.light .screen-leaderboard { background: var(--bg-papiro); }
body.light .leaderboard-title { color: var(--ink-red); text-shadow: none; }
body.light .leaderboard-item {
  background: var(--surface-papiro); border-color: var(--border-papiro);
  box-shadow: 2px 2px 0 rgba(139,105,20,0.1);
}
body.light .leaderboard-item:hover { border-color: var(--ink-red); }
body.light .leaderboard-rank { color: var(--ink-dark); }
body.light .leaderboard-rank.top-1 { color: var(--ink-red); text-shadow: none; }
body.light .leaderboard-name { color: var(--ink-dark); }
body.light .leaderboard-type { color: var(--border-papiro); }
body.light .leaderboard-progress { background: var(--bg-papiro); border-color: var(--border-papiro); }
body.light .leaderboard-progress-fill { background: var(--ink-red); }

/* P18 Mi Perfil light */
body.light .screen-miperfil { background: var(--bg-papiro); }
body.light .profile-card {
  background: var(--surface-papiro); border-color: var(--border-papiro);
  box-shadow: 3px 3px 0 rgba(139,105,20,0.15);
}
body.light .profile-card::after { border-color: var(--border-papiro); }
body.light .profile-name { color: var(--ink-red); }
body.light .profile-type { color: var(--ink-dark); }
body.light .profile-stat-cell { background: var(--bg-papiro); border-color: var(--border-papiro); }
body.light .profile-stat-cell .stat-val { color: var(--ink-red); }
body.light .profile-stat-cell .stat-lbl { color: var(--ink-dark); }
body.light .profile-memories { color: var(--ink-dark); }
body.light .profile-visibility { color: var(--ink-dark); }

/* P19 Perfil PÃºblico light */
body.light .screen-publicperfil { background: var(--bg-papiro); }
body.light .public-profile-card {
  background: var(--surface-papiro); border-color: var(--border-papiro);
  box-shadow: 3px 3px 0 rgba(139,105,20,0.15);
}
body.light .public-profile-card::after { border-color: var(--border-papiro); }
body.light .public-evolution { color: var(--ink-dark); }
body.light .public-action-btn {
  background: var(--bg-papiro); color: var(--ink-dark);
  border-color: var(--border-papiro); box-shadow: 2px 2px 0 rgba(139,105,20,0.1);
}
body.light .public-action-btn:hover { color: var(--ink-red); border-color: var(--ink-red); }
body.light .public-back-btn { color: var(--border-papiro); border-color: var(--border-papiro); }
body.light .public-back-btn:hover { color: var(--ink-red); border-color: var(--ink-red); }

/* =========================================
   RESPONSIVE â€” BLOCK 2+3
   ========================================= */
@media (min-width: 641px) {
  .tutorial-modal { max-width: 28rem; }
  .settings-panel { max-width: 26rem; }
  .camera-frame { max-width: 24rem; }
  .postphoto-result { max-width: 26rem; }
  .profile-card, .public-profile-card { max-width: 24rem; }
  .leaderboard-list { max-width: 28rem; }
  .fractura-sprite-area { font-size: 6rem; }
  .world-sprite { font-size: 5rem; }
}
@media (min-width: 1025px) {
  .tutorial-modal { max-width: 30rem; }
  .settings-panel { max-width: 28rem; }
  .camera-frame { max-width: 26rem; }
  .postphoto-result { max-width: 28rem; }
  .profile-card, .public-profile-card { max-width: 26rem; }
  .leaderboard-list { max-width: 32rem; }
  .fractura-sprite-area { font-size: 7rem; }
  .world-sprite { font-size: 6rem; }
  .chat-messages { max-width: 40rem; margin: 0 auto; }
}
</style>
</head>
<body>

<!-- ===== PREVIEW NAV ===== -->
<nav class="preview-nav">
  <button class="active" onclick="showScreen('loading')">1.Loading</button>
  <button onclick="showScreen('fullscreen')">2.Fullscreen</button>
  <button onclick="showScreen('title')">3.Title</button>
  <button onclick="showScreen('typewriter')">4.Historia</button>
  <button onclick="showScreen('login')">5.Login</button>
  <button onclick="showScreen('creation')">6.CreaciÃ³n</button>
  <button onclick="showScreen('transition')">7.TransiciÃ³n</button>
  <span style="color:var(--text-dim);font-size:0.35rem;padding:0 2px;">|</span>
  <button onclick="showScreen('tutorial')">8.Tutorial</button>
  <button onclick="showScreen('world')">9.World</button>
  <button onclick="showScreen('settings')">10.Settings</button>
  <button onclick="showScreen('history')">11.History</button>
  <button onclick="showScreen('chat')">12.Chat</button>
  <button onclick="showScreen('camera')">13.Camera</button>
  <button onclick="showScreen('postphoto')">14.PostPhoto</button>
  <span style="color:var(--text-dim);font-size:0.35rem;padding:0 2px;">|</span>
  <button onclick="showScreen('fractura')">15.Fractura</button>
  <button onclick="showScreen('social')">16.Social</button>
  <button onclick="showScreen('leaderboard')">17.Leader</button>
  <button onclick="showScreen('miperfil')">18.MiPerfil</button>
  <button onclick="showScreen('publicperfil')">19.PÃºblico</button>
  <button class="theme-toggle" onclick="toggleTheme()">ðŸŒ™ Dark</button>
</nav>

<!-- ===== P1: LOADING ===== -->
<section id="screen-loading" class="screen screen-loading active">
  <div class="vignette"></div>
  <div class="loading-particles fragment-particles">
    <div class="particle" style="left:10%; top:30%; animation-delay:0s;"></div>
    <div class="particle" style="left:25%; top:60%; animation-delay:1s;"></div>
    <div class="particle" style="left:50%; top:20%; animation-delay:0.5s;"></div>
    <div class="particle" style="left:70%; top:70%; animation-delay:1.5s;"></div>
    <div class="particle" style="left:85%; top:40%; animation-delay:0.8s;"></div>
    <div class="particle" style="left:40%; top:80%; animation-delay:2s;"></div>
    <div class="particle" style="left:60%; top:15%; animation-delay:1.2s;"></div>
    <div class="particle" style="left:15%; top:50%; animation-delay:0.3s;"></div>
  </div>
  <div class="loading-logo">
    REGGIE'S
    <span class="sub">ADVENTURE</span>
  </div>
  <div class="loading-bar-container">
    <div class="loading-bar-fill"></div>
    <div class="loading-sparks" id="loading-sparks"></div>
  </div>
  <div class="loading-text">PURIFICANDO DATOS...</div>
</section>

<!-- ===== P2: FULLSCREEN ===== -->
<section id="screen-fullscreen" class="screen screen-fullscreen">
  <div class="vignette"></div>
  <div class="fullscreen-icon">â›¶</div>
  <div class="fullscreen-title">Experiencia Completa</div>
  <div class="fullscreen-subtitle">
    Reggie's Adventure se disfruta mejor<br>
    en pantalla completa
  </div>
  <div class="fullscreen-buttons">
    <button class="glow-btn" onclick="showScreen('title')">â›¶ Pantalla Completa</button>
    <button class="glow-btn purple" onclick="showScreen('title')">Continuar AsÃ­</button>
  </div>
</section>

<!-- ===== P3: TITLE ===== -->
<section id="screen-title" class="screen screen-title">
  <div class="title-vignette"></div>
  <div class="title-bg-runes" id="title-rune-circle"></div>
  <div class="fragment-particles">
    <div class="fragment-particle" style="left:30%; top:35%; animation-delay:0s; animation-duration:6s;"></div>
    <div class="fragment-particle" style="left:65%; top:45%; animation-delay:2s; animation-duration:7s;"></div>
    <div class="fragment-particle" style="left:50%; top:55%; animation-delay:4s; animation-duration:5s;"></div>
  </div>
  <button class="title-music-toggle">ðŸŽµ ON</button>
  <div class="title-main">
    REGGIE'S
    <span class="adventure">ADVENTURE</span>
  </div>
  <div class="title-decorative-regenmons">
    <span>âš¡</span>
    <span>ðŸ”¥</span>
    <span>â„ï¸</span>
  </div>
  <div class="title-press-start" onclick="showScreen('login')">
    â–¶ PRESS START
  </div>
  <div class="title-version">v0.5 â€” El Encuentro</div>
</section>

<!-- ===== P4: TYPEWRITER ===== -->
<section id="screen-typewriter" class="screen screen-typewriter">
  <div class="vignette"></div>
  <div class="fragment-particles">
    <div class="fragment-particle" style="left:15%; top:25%; animation-delay:0s; animation-duration:7s;"></div>
    <div class="fragment-particle" style="left:80%; top:60%; animation-delay:2s; animation-duration:6s;"></div>
    <div class="fragment-particle" style="left:45%; top:80%; animation-delay:3.5s; animation-duration:5s;"></div>
  </div>
  <div class="typewriter-box">
    <div class="inner-border"></div>
    <span class="typewriter-rune-tl">áš¦</span>
    <div class="typewriter-text" id="typewriter-output"></div>
    <span class="typewriter-cursor" id="typewriter-cursor"></span>
  </div>
  <div class="typewriter-continue" id="typewriter-continue">
    <button class="glow-btn gold" onclick="showScreen('creation')">Continuar â–¶</button>
  </div>
</section>

<!-- ===== P5: LOGIN ===== -->
<section id="screen-login" class="screen screen-login">
  <div class="vignette"></div>
  <div class="fragment-particles">
    <div class="fragment-particle" style="left:5%; top:15%; animation-delay:0s; animation-duration:6s;"></div>
    <div class="fragment-particle" style="left:90%; top:25%; animation-delay:1.5s; animation-duration:7s;"></div>
    <div class="fragment-particle" style="left:8%; top:80%; animation-delay:3s; animation-duration:5s;"></div>
    <div class="fragment-particle" style="left:85%; top:70%; animation-delay:2s; animation-duration:6.5s;"></div>
    <div class="fragment-particle" style="left:50%; top:10%; animation-delay:0.5s; animation-duration:8s;"></div>
  </div>
  <div class="login-modal rune-corners">
    <span class="rune-tl">á›—</span>
    <span class="rune-tr">áš¨</span>
    <span class="rune-bl">á›ƒ</span>
    <span class="rune-br">á›ˆ</span>
    <div class="login-title">âŸ CONEXIÃ“N</div>
    <div class="login-subtitle">
      Vincula tu identidad<br>
      a La Red Primordial
    </div>
    <div class="login-options">
      <button class="login-btn">
        <span class="icon">ðŸ”µ</span>
        Continuar con Google
      </button>
      <button class="login-btn">
        <span class="icon">âœ‰ï¸</span>
        Continuar con Email
      </button>
      <button class="login-btn">
        <span class="icon">ðŸ”‘</span>
        Continuar con Passkey
      </button>
    </div>
    <div class="login-divider">o</div>
    <button class="login-demo" onclick="showScreen('typewriter')">
      ðŸ‘» Continuar sin cuenta (demo)
    </button>
  </div>
</section>

<!-- ===== P6: CREACIÃ“N ===== -->
<section id="screen-creation" class="screen screen-creation">
  <div class="vignette"></div>
  <div class="creation-title">Crea tu Regenmon</div>
  <div class="creation-subtitle">
    La energÃ­a antigua estÃ¡ lista para tomar forma.<br>
    Elige cuÃ¡l cristalizarÃ¡.
  </div>

  <div class="creation-carousel">
    <button class="carousel-arrow" onclick="prevType()">â—€</button>
    <div class="carousel-card type-rayo" id="carousel-card">
      <div class="type-particles type-rayo-particles" id="type-particles">
        <div class="type-particle"></div>
        <div class="type-particle"></div>
        <div class="type-particle"></div>
        <div class="type-particle"></div>
      </div>
      <span class="carousel-sprite" id="carousel-sprite">âš¡</span>
      <div class="carousel-type-name" id="carousel-name">Rayo</div>
      <div class="carousel-type-title" id="carousel-title">El Impulso</div>
      <div class="carousel-type-desc" id="carousel-desc">
        La corriente que alguna vez fue el flujo limpio de informaciÃ³n. Veloz, directo, chispeante.
      </div>
    </div>
    <button class="carousel-arrow" onclick="nextType()">â–¶</button>
  </div>

  <div class="carousel-dots">
    <div class="carousel-dot active" id="dot-0" onclick="setType(0)"></div>
    <div class="carousel-dot" id="dot-1" onclick="setType(1)"></div>
    <div class="carousel-dot" id="dot-2" onclick="setType(2)"></div>
  </div>

  <div class="creation-name-wrapper">
    <input
      type="text"
      class="creation-name-input"
      id="name-input"
      placeholder="Nombre de tu Regenmon"
      maxlength="15"
      oninput="updateCharCount()"
    >
    <div class="creation-char-count" id="char-count">0/15</div>
  </div>

  <button class="glow-btn gold disabled" id="awaken-btn" onclick="showScreen('transition')">
    Â¡DESPERTAR!
  </button>
</section>

<!-- ===== P7: TRANSICIÃ“N ===== -->
<section id="screen-transition" class="screen screen-transition">
  <div class="transition-flash"></div>
  <div class="vignette"></div>
  <div class="transition-energy-ring">
    <span class="ring-rune" style="position:absolute;top:-6px;left:50%;font-family:serif;font-size:10px;color:rgba(0,240,255,0.2);">áš±</span>
    <span class="ring-rune" style="position:absolute;bottom:-6px;left:50%;font-family:serif;font-size:10px;color:rgba(0,240,255,0.2);">á›Š</span>
    <span class="ring-rune" style="position:absolute;top:50%;left:-6px;font-family:serif;font-size:10px;color:rgba(0,240,255,0.2);">á›</span>
    <span class="ring-rune" style="position:absolute;top:50%;right:-6px;font-family:serif;font-size:10px;color:rgba(0,240,255,0.2);">áš²</span>
  </div>
  <div class="transition-energy-ring">
    <span class="ring-rune" style="position:absolute;top:-6px;left:50%;font-family:serif;font-size:10px;color:rgba(180,74,255,0.2);">á›‰</span>
    <span class="ring-rune" style="position:absolute;bottom:-6px;left:50%;font-family:serif;font-size:10px;color:rgba(180,74,255,0.2);">á›—</span>
    <span class="ring-rune" style="position:absolute;top:50%;left:-6px;font-family:serif;font-size:10px;color:rgba(180,74,255,0.2);">áš¨</span>
    <span class="ring-rune" style="position:absolute;top:50%;right:-6px;font-family:serif;font-size:10px;color:rgba(180,74,255,0.2);">áš¦</span>
  </div>
  <div class="fracture-lines">
    <div class="fracture-line"></div>
    <div class="fracture-line"></div>
    <div class="fracture-line"></div>
    <div class="fracture-line"></div>
    <div class="fracture-line"></div>
    <div class="fracture-line"></div>
    <div class="fracture-line"></div>
    <div class="fracture-line"></div>
  </div>
  <div class="transition-sprite" id="transition-sprite">âš¡</div>
  <div class="transition-text">Tu Regenmon estÃ¡ despertando</div>
  <div class="transition-dots">
    <span class="dot">.</span><span class="dot">.</span><span class="dot">.</span>
  </div>
</section>

<!-- ===== P8: TUTORIAL ===== -->
<section id="screen-tutorial" class="screen screen-tutorial">
  <div class="vignette"></div>
  <div class="tutorial-modal rune-corners">
    <span class="rune-tl">áš¦</span><span class="rune-tr">á›Š</span>
    <span class="rune-bl">á›—</span><span class="rune-br">áš¨</span>
    <div class="tutorial-step-title" id="tut-title">ðŸ‘‹ Meet Reggie</div>
    <div class="tutorial-step-icon" id="tut-icon">ðŸ£</div>
    <div class="tutorial-step-desc" id="tut-desc">Este es tu Regenmon. NaciÃ³ de un fragmento de energÃ­a antigua. CuÃ­dalo y crecerÃ¡.</div>
    <div class="tutorial-dots" id="tut-dots">
      <div class="tutorial-dot active" onclick="setTutStep(0)"></div>
      <div class="tutorial-dot" onclick="setTutStep(1)"></div>
      <div class="tutorial-dot" onclick="setTutStep(2)"></div>
      <div class="tutorial-dot" onclick="setTutStep(3)"></div>
      <div class="tutorial-dot" onclick="setTutStep(4)"></div>
    </div>
    <div class="tutorial-nav">
      <button class="tutorial-skip" onclick="showScreen('world')">Saltar â–¶</button>
      <button class="glow-btn" id="tut-next" onclick="nextTutStep()" style="width:auto;padding:0.5em 1.2em;font-size:var(--fs-xs);">Siguiente â–¶</button>
    </div>
  </div>
</section>

<!-- ===== P9: WORLD/HOME ===== -->
<section id="screen-world" class="screen screen-world">
  <div class="fragment-particles">
    <div class="fragment-particle" style="left:20%;top:30%;animation-delay:0s;animation-duration:6s;"></div>
    <div class="fragment-particle" style="left:70%;top:50%;animation-delay:2s;animation-duration:7s;"></div>
    <div class="fragment-particle" style="left:45%;top:70%;animation-delay:3.5s;animation-duration:5s;"></div>
  </div>
  <div class="world-hud">
    <div class="world-hud-left">
      <div class="world-hud-item">ðŸ’  <span>42</span></div>
      <div class="world-hud-item">ðŸ§  <span>7</span></div>
    </div>
    <div class="world-hud-right">
      <div class="world-hud-item" style="font-size:0.4rem;">v0.5</div>
      <div class="world-hud-item">ðŸ‘¤ <span>Anon</span></div>
    </div>
  </div>
  <div class="world-landscape">
    <div class="world-landscape-label">âš¡ Llanura ElÃ©ctrica</div>
    <div class="world-sprite" id="world-sprite" onclick="this.style.animation='none';setTimeout(()=>this.style.animation='breathe 3s infinite',50);">âš¡</div>
  </div>
  <div class="world-stats">
    <div class="stat-bar-row">
      <div class="stat-bar-label">ðŸ”® EspÃ­ritu</div>
      <div class="stat-bar-track"><div class="stat-bar-fill spirit" style="width:75%;"></div></div>
      <div class="stat-bar-value">75</div>
    </div>
    <div class="stat-bar-row">
      <div class="stat-bar-label">ðŸ’› Pulso</div>
      <div class="stat-bar-track"><div class="stat-bar-fill pulse" style="width:50%;"></div></div>
      <div class="stat-bar-value">50</div>
    </div>
    <div class="stat-bar-row">
      <div class="stat-bar-label">ðŸŒ± Esencia</div>
      <div class="stat-bar-track"><div class="stat-bar-fill essence" style="width:30%;"></div></div>
      <div class="stat-bar-value">30</div>
    </div>
  </div>
  <div class="world-actions">
    <button class="world-action-btn" onclick="showScreen('tutorial')">ðŸŒ€ Purificar</button>
    <button class="world-action-btn" onclick="showScreen('settings')">âš™ï¸ Settings</button>
    <button class="world-action-btn" onclick="showScreen('history')">ðŸ“œ History</button>
  </div>
  <nav class="world-bottom-nav">
    <button class="world-nav-btn active-tab" onclick="showScreen('chat')">ðŸ’¬ Chat</button>
    <button class="world-nav-btn" onclick="showScreen('camera')">ðŸ“· Photo</button>
    <button class="world-nav-btn" onclick="showScreen('social')">ðŸŒ Social</button>
  </nav>
</section>

<!-- ===== P10: SETTINGS ===== -->
<section id="screen-settings" class="screen screen-settings">
  <div class="vignette"></div>
  <div class="settings-panel rune-corners">
    <span class="rune-tl">á›ƒ</span><span class="rune-tr">á›ˆ</span>
    <span class="rune-bl">áš±</span><span class="rune-br">áš²</span>
    <div class="settings-title">âš™ï¸ Ajustes</div>
    <div class="settings-group">
      <div class="settings-row">
        <span class="settings-label">ðŸŽµ MÃºsica</span>
        <div class="settings-toggle on" onclick="this.classList.toggle('on')"></div>
      </div>
      <div class="settings-row">
        <span class="settings-label">ðŸŒ™ Tema</span>
        <div class="settings-toggle" onclick="this.classList.toggle('on');toggleTheme()"></div>
      </div>
      <div class="settings-row">
        <span class="settings-label">ðŸ”¤ Texto grande</span>
        <div class="settings-toggle" onclick="this.classList.toggle('on')"></div>
      </div>
      <div class="settings-row">
        <span class="settings-label">ðŸŒ Visible en La Red</span>
        <div class="settings-toggle on" onclick="this.classList.toggle('on')"></div>
      </div>
    </div>
    <div class="settings-group">
      <button class="settings-action-btn">ðŸ“ Cambiar nombre</button>
      <button class="settings-action-btn">ðŸ” Reiniciar tutorial</button>
      <button class="settings-action-btn danger">ðŸ”„ Reiniciar todo</button>
      <button class="settings-action-btn danger">ðŸšª Cerrar sesiÃ³n</button>
    </div>
    <div style="text-align:center;margin-top:0.75rem;">
      <button class="glow-btn purple" onclick="showScreen('world')" style="width:auto;padding:0.5em 1.5em;font-size:var(--fs-xs);">â† Volver</button>
    </div>
  </div>
</section>

<!-- ===== P11: HISTORY ===== -->
<section id="screen-history" class="screen screen-history">
  <div class="vignette"></div>
  <div class="history-title">ðŸ“œ Historial de Memorias</div>
  <div class="history-list">
    <div class="history-item"><span class="history-icon">ðŸ’¬</span><span class="history-desc">Conversaste con Reggie</span><span class="history-delta">+3 ðŸ’ </span><span class="history-time">2m</span></div>
    <div class="history-item"><span class="history-icon">ðŸ“·</span><span class="history-desc">Foto: parque al atardecer</span><span class="history-delta">+8 ðŸ’ </span><span class="history-time">15m</span></div>
    <div class="history-item"><span class="history-icon">ðŸŒ€</span><span class="history-desc">PurificaciÃ³n completada</span><span class="history-delta">+5 ðŸ’ </span><span class="history-time">1h</span></div>
    <div class="history-item"><span class="history-icon">ðŸ’¬</span><span class="history-desc">Chat profundo</span><span class="history-delta">+4 ðŸ’ </span><span class="history-time">2h</span></div>
    <div class="history-item"><span class="history-icon">ðŸ“·</span><span class="history-desc">Foto: cielo nublado</span><span class="history-delta negative">âˆ’2 ðŸ’ </span><span class="history-time">3h</span></div>
    <div class="history-item"><span class="history-icon">ðŸŠ</span><span class="history-desc">Recibiste fruta de Kai</span><span class="history-delta">+2 ðŸ’ </span><span class="history-time">5h</span></div>
    <div class="history-item"><span class="history-icon">ðŸ’¬</span><span class="history-desc">ConversaciÃ³n corta</span><span class="history-delta">+1 ðŸ’ </span><span class="history-time">8h</span></div>
    <div class="history-item"><span class="history-icon">âš¡</span><span class="history-desc">Â¡Fractura! Nivel 2</span><span class="history-delta">+15 ðŸ’ </span><span class="history-time">1d</span></div>
    <div class="history-item"><span class="history-icon">ðŸ“·</span><span class="history-desc">Foto: mascota dormida</span><span class="history-delta">+6 ðŸ’ </span><span class="history-time">1d</span></div>
    <div class="history-item"><span class="history-icon">ðŸŒ€</span><span class="history-desc">Primera purificaciÃ³n</span><span class="history-delta">+10 ðŸ’ </span><span class="history-time">2d</span></div>
  </div>
  <div style="text-align:center;margin-top:1rem;">
    <button class="glow-btn" onclick="showScreen('world')" style="width:auto;padding:0.5em 1.5em;font-size:var(--fs-xs);">â† Volver</button>
  </div>
</section>

<!-- ===== P12: CHAT ===== -->
<section id="screen-chat" class="screen screen-chat">
  <div class="chat-header">
    <div class="chat-header-title">ðŸ’¬ Chat con Reggie</div>
    <div class="chat-header-actions">
      <button class="chat-header-btn">ðŸ“Ž</button>
      <button class="chat-header-btn" onclick="showScreen('world')">âœ•</button>
    </div>
  </div>
  <div class="chat-compact-stats">
    ðŸ”® <span>75</span> &nbsp; ðŸ’› <span>50</span> &nbsp; ðŸŒ± <span>30</span>
  </div>
  <div class="chat-messages">
    <div class="chat-bubble bot">Â¡Hola! Siento la energÃ­a del dÃ­a fluyendo. Â¿CÃ³mo te sientes?</div>
    <div class="chat-bubble user">Bien, un poco cansado pero contento.</div>
    <div class="chat-bubble bot">La calma despuÃ©s del esfuerzo es una forma de energÃ­a tambiÃ©n. ðŸŒ™ Â¿Hiciste algo especial hoy?</div>
    <div class="chat-bubble user">SalÃ­ a caminar por el parque.</div>
    <div class="chat-bubble bot">Â¡Eso es genial! La naturaleza tiene fragmentos de energÃ­a pura. Puedo sentirlos a travÃ©s de ti. âœ¨</div>
    <div class="chat-typing">
      <span>Reggie estÃ¡ escribiendo</span>
      <span class="chat-typing-dots"><span>.</span><span>.</span><span>.</span></span>
    </div>
  </div>
  <div class="chat-input-bar">
    <input class="chat-input" type="text" placeholder="Escribe un mensaje...">
    <button class="chat-send-btn">â–¶</button>
  </div>
</section>

<!-- ===== P13: CAMERA ===== -->
<section id="screen-camera" class="screen screen-camera">
  <div class="vignette"></div>
  <div class="camera-frame rune-corners">
    <span class="rune-tl">áš²</span><span class="rune-tr">á›</span>
    <span class="rune-bl">á›‰</span><span class="rune-br">áš±</span>
    <div class="camera-icon">ðŸ“¸</div>
    <div class="camera-prompt">
      Reggie quiere ver el mundo a travÃ©s de tus ojos. MuÃ©strale algo que te inspire hoy.
    </div>
    <div class="camera-mission">
      ðŸŽ¯ MisiÃ³n: FotografÃ­a algo verde y vivo
    </div>
    <div class="camera-buttons">
      <button class="glow-btn" onclick="showScreen('postphoto')">ðŸ“¸ Tomar Foto</button>
      <button class="glow-btn purple">ðŸ–¼ï¸ Elegir de GalerÃ­a</button>
    </div>
  </div>
  <div class="camera-privacy">
    ðŸ”’ Tu foto se analiza con IA para resonancia emocional. No se almacena ni comparte. Solo Reggie la ve.
  </div>
</section>

<!-- ===== P14: POST-PHOTO ===== -->
<section id="screen-postphoto" class="screen screen-postphoto">
  <div class="vignette"></div>
  <div class="postphoto-result rune-corners">
    <span class="rune-tl">á›Š</span><span class="rune-tr">áš¦</span>
    <span class="rune-bl">á›ƒ</span><span class="rune-br">á›ˆ</span>
    <div class="postphoto-title">âœ¨ Resonancia Fuerte</div>
    <div class="postphoto-sprite">âš¡</div>
    <div class="postphoto-reaction">
      Â¡Reggie vibra con energÃ­a! Los colores del parque despiertan recuerdos ancestrales de corrientes verdes.
    </div>
    <div class="postphoto-deltas">
      <div class="postphoto-delta positive">ðŸ”® +8</div>
      <div class="postphoto-delta positive">ðŸ’› +5</div>
      <div class="postphoto-delta positive">ðŸŒ± +12</div>
    </div>
    <div class="postphoto-diary">
      ðŸ“– "Hoy vi algo verde y vivo. Me recordÃ³ que la energÃ­a no se crea ni se destruye... solo cambia de forma. Como yo."
    </div>
  </div>
  <div class="postphoto-buttons">
    <button class="glow-btn" onclick="showScreen('chat')">ðŸ’¬ Conversar</button>
    <button class="glow-btn purple" onclick="showScreen('world')">ðŸ  Volver</button>
  </div>
</section>

<!-- ===== P15: FRACTURA ===== -->
<section id="screen-fractura" class="screen screen-fractura">
  <div class="fractura-flash-overlay"></div>
  <div class="vignette"></div>
  <div class="fragment-particles">
    <div class="fragment-particle" style="left:15%;top:20%;animation-delay:0s;animation-duration:4s;"></div>
    <div class="fragment-particle" style="left:80%;top:30%;animation-delay:0.5s;animation-duration:5s;"></div>
    <div class="fragment-particle" style="left:40%;top:75%;animation-delay:1s;animation-duration:4.5s;"></div>
    <div class="fragment-particle" style="left:65%;top:15%;animation-delay:1.5s;animation-duration:6s;"></div>
    <div class="fragment-particle" style="left:25%;top:60%;animation-delay:2s;animation-duration:5s;"></div>
  </div>
  <div class="fractura-particle-burst">
    <div class="fractura-particle" style="top:50%;left:50%;--ex:60px;--ey:-50px;animation-delay:0.3s;"></div>
    <div class="fractura-particle" style="top:50%;left:50%;--ex:-55px;--ey:-40px;animation-delay:0.4s;"></div>
    <div class="fractura-particle" style="top:50%;left:50%;--ex:40px;--ey:50px;animation-delay:0.5s;"></div>
    <div class="fractura-particle" style="top:50%;left:50%;--ex:-60px;--ey:30px;animation-delay:0.6s;"></div>
    <div class="fractura-particle" style="top:50%;left:50%;--ex:30px;--ey:-60px;animation-delay:0.7s;"></div>
    <div class="fractura-particle" style="top:50%;left:50%;--ex:-40px;--ey:-55px;animation-delay:0.8s;"></div>
    <div class="fractura-particle" style="top:50%;left:50%;--ex:55px;--ey:40px;animation-delay:0.9s;"></div>
    <div class="fractura-particle" style="top:50%;left:50%;--ex:-30px;--ey:60px;animation-delay:1s;"></div>
  </div>
  <div class="fractura-sprite-area">âš¡</div>
  <div class="fractura-narrative">
    "Algo cambiÃ³ en mÃ­... Las corrientes que antes eran caÃ³ticas ahora fluyen con propÃ³sito. Puedo sentir los fragmentos reorganizÃ¡ndose."
  </div>
  <div class="fractura-continue">
    <button class="glow-btn gold" onclick="showScreen('world')">Continuar â–¶</button>
  </div>
</section>

<!-- ===== P16: SOCIAL ===== -->
<section id="screen-social" class="screen screen-social">
  <div class="fragment-particles">
    <div class="fragment-particle" style="left:10%;top:25%;animation-delay:0s;animation-duration:7s;"></div>
    <div class="fragment-particle" style="left:85%;top:60%;animation-delay:2s;animation-duration:6s;"></div>
    <div class="fragment-particle" style="left:50%;top:80%;animation-delay:3.5s;animation-duration:5s;"></div>
  </div>
  <div class="social-tabs">
    <button class="social-tab active-tab">ðŸŒ Red</button>
    <button class="social-tab">ðŸ“¨ Mensajes <span class="social-badge">3</span></button>
    <button class="social-tab">ðŸ”” Actividad</button>
  </div>
  <div class="social-content">
    <div class="social-section">
      <div class="social-section-title">ðŸŒ RegeneraciÃ³n Global</div>
      <button class="glow-btn" onclick="showScreen('leaderboard')" style="font-size:var(--fs-xs);padding:0.5em 1em;">Ver Leaderboard â–¶</button>
    </div>
    <div class="social-section">
      <div class="social-section-title">ðŸ“¨ Mensajes Recientes</div>
      <div class="social-message-item">ðŸŠ <span><span class="feed-name">Kai</span> te enviÃ³ fruta</span></div>
      <div class="social-message-item">ðŸ’¬ <span><span class="feed-name">Luna</span>: "Â¡Tu regenmon se ve genial!"</span></div>
      <div class="social-message-item">ðŸŽ <span><span class="feed-name">Ember</span> te regalÃ³ 5 $FRUTA</span></div>
    </div>
    <div class="social-section">
      <div class="social-section-title">ðŸ”” Actividad Reciente</div>
      <div class="social-feed-item"><span class="feed-name">Kai</span> evolucionÃ³ a Fractura 3 ðŸ”¥</div>
      <div class="social-feed-item"><span class="feed-name">Luna</span> alcanzÃ³ 100 memorias â„ï¸</div>
      <div class="social-feed-item"><span class="feed-name">Ember</span> se uniÃ³ a La Red âš¡</div>
      <div class="social-feed-item"><span class="feed-name">Frost</span> completÃ³ una purificaciÃ³n rara ðŸŒ€</div>
    </div>
  </div>
  <nav class="world-bottom-nav">
    <button class="world-nav-btn" onclick="showScreen('chat')">ðŸ’¬ Chat</button>
    <button class="world-nav-btn" onclick="showScreen('camera')">ðŸ“· Photo</button>
    <button class="world-nav-btn active-tab" onclick="showScreen('social')">ðŸŒ Social</button>
  </nav>
</section>

<!-- ===== P17: LEADERBOARD ===== -->
<section id="screen-leaderboard" class="screen screen-leaderboard">
  <div class="vignette"></div>
  <div class="leaderboard-title">ðŸ† RegeneraciÃ³n Global</div>
  <div class="leaderboard-list">
    <div class="leaderboard-item" onclick="showScreen('publicperfil')"><span class="leaderboard-rank top-1">1</span><span class="leaderboard-sprite">ðŸ”¥</span><div class="leaderboard-info"><div class="leaderboard-name">Pyra</div><div class="leaderboard-type">Flama Â· F4</div></div><div class="leaderboard-progress"><div class="leaderboard-progress-fill" style="width:95%;"></div></div></div>
    <div class="leaderboard-item" onclick="showScreen('publicperfil')"><span class="leaderboard-rank top-2">2</span><span class="leaderboard-sprite">â„ï¸</span><div class="leaderboard-info"><div class="leaderboard-name">Cryo</div><div class="leaderboard-type">Hielo Â· F3</div></div><div class="leaderboard-progress"><div class="leaderboard-progress-fill" style="width:82%;"></div></div></div>
    <div class="leaderboard-item" onclick="showScreen('publicperfil')"><span class="leaderboard-rank top-3">3</span><span class="leaderboard-sprite">âš¡</span><div class="leaderboard-info"><div class="leaderboard-name">Volt</div><div class="leaderboard-type">Rayo Â· F3</div></div><div class="leaderboard-progress"><div class="leaderboard-progress-fill" style="width:78%;"></div></div></div>
    <div class="leaderboard-item"><span class="leaderboard-rank">4</span><span class="leaderboard-sprite">ðŸ”¥</span><div class="leaderboard-info"><div class="leaderboard-name">Kai</div><div class="leaderboard-type">Flama Â· F3</div></div><div class="leaderboard-progress"><div class="leaderboard-progress-fill" style="width:65%;"></div></div></div>
    <div class="leaderboard-item"><span class="leaderboard-rank">5</span><span class="leaderboard-sprite">â„ï¸</span><div class="leaderboard-info"><div class="leaderboard-name">Luna</div><div class="leaderboard-type">Hielo Â· F2</div></div><div class="leaderboard-progress"><div class="leaderboard-progress-fill" style="width:52%;"></div></div></div>
    <div class="leaderboard-item"><span class="leaderboard-rank">6</span><span class="leaderboard-sprite">âš¡</span><div class="leaderboard-info"><div class="leaderboard-name">Ember</div><div class="leaderboard-type">Rayo Â· F2</div></div><div class="leaderboard-progress"><div class="leaderboard-progress-fill" style="width:45%;"></div></div></div>
    <div class="leaderboard-item"><span class="leaderboard-rank">7</span><span class="leaderboard-sprite">ðŸ”¥</span><div class="leaderboard-info"><div class="leaderboard-name">Frost</div><div class="leaderboard-type">Flama Â· F1</div></div><div class="leaderboard-progress"><div class="leaderboard-progress-fill" style="width:30%;"></div></div></div>
  </div>
  <div style="text-align:center;margin-top:1rem;">
    <button class="glow-btn purple" onclick="showScreen('social')" style="width:auto;padding:0.5em 1.5em;font-size:var(--fs-xs);">â† Volver</button>
  </div>
</section>

<!-- ===== P18: MI PERFIL ===== -->
<section id="screen-miperfil" class="screen screen-miperfil">
  <div class="vignette"></div>
  <div class="profile-card rune-corners">
    <span class="rune-tl">áš±</span><span class="rune-tr">á›Š</span>
    <span class="rune-bl">á›</span><span class="rune-br">áš²</span>
    <div class="profile-sprite">âš¡</div>
    <div class="profile-name">Sparky</div>
    <div class="profile-type">âš¡ Rayo Â· Fractura 2</div>
    <div class="profile-stats-grid">
      <div class="profile-stat-cell"><div class="stat-val">75</div><div class="stat-lbl">ðŸ”® EspÃ­ritu</div></div>
      <div class="profile-stat-cell"><div class="stat-val">50</div><div class="stat-lbl">ðŸ’› Pulso</div></div>
      <div class="profile-stat-cell"><div class="stat-val">30</div><div class="stat-lbl">ðŸŒ± Esencia</div></div>
    </div>
    <div class="profile-memories">ðŸ§  7 Memorias</div>
    <div class="profile-visibility">
      ðŸŒ Visible en La Red
      <div class="settings-toggle on" onclick="this.classList.toggle('on')" style="margin-left:0.3rem;"></div>
    </div>
  </div>
  <button class="glow-btn" onclick="showScreen('world')" style="width:auto;padding:0.5em 1.5em;font-size:var(--fs-xs);">â† Volver al Mundo</button>
</section>

<!-- ===== P19: PERFIL PÃšBLICO ===== -->
<section id="screen-publicperfil" class="screen screen-publicperfil">
  <div class="vignette"></div>
  <div class="public-profile-card rune-corners">
    <span class="rune-tl">á›—</span><span class="rune-tr">áš¨</span>
    <span class="rune-bl">á›ƒ</span><span class="rune-br">á›ˆ</span>
    <div class="profile-sprite">ðŸ”¥</div>
    <div class="profile-name" style="color:var(--purple);">Pyra</div>
    <div class="profile-type">ðŸ”¥ Flama Â· Fractura 4</div>
    <div class="public-evolution">ðŸ† Forma Final â€” 420 progreso</div>
    <div class="profile-memories">ðŸ§  156 Memorias</div>
    <div class="public-actions">
      <button class="public-action-btn">ðŸŠ Alimentar (gasta $FRUTA)</button>
      <button class="public-action-btn">ðŸŽ Regalar $FRUTA</button>
      <button class="public-action-btn">ðŸ’¬ Enviar Pulso</button>
    </div>
  </div>
  <button class="public-back-btn" onclick="showScreen('leaderboard')">â† Volver al Leaderboard</button>
</section>

<script>
// ===== SCREEN NAVIGATION =====
function showScreen(id) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById('screen-' + id).classList.add('active');

  document.querySelectorAll('.preview-nav button:not(.theme-toggle)').forEach(b => b.classList.remove('active'));
  const btns = document.querySelectorAll('.preview-nav button:not(.theme-toggle)');
  const screens = ['loading','fullscreen','title','typewriter','login','creation','transition','tutorial','world','settings','history','chat','camera','postphoto','fractura','social','leaderboard','miperfil','publicperfil'];
  const idx = screens.indexOf(id);
  if (idx >= 0 && btns[idx]) btns[idx].classList.add('active');

  // Start typewriter if needed
  if (id === 'typewriter') startTypewriter();
}

// ===== THEME TOGGLE =====
let isDark = true;
function toggleTheme() {
  isDark = !isDark;
  document.body.classList.toggle('light', !isDark);
  document.querySelector('.theme-toggle').textContent = isDark ? 'ðŸŒ™ Dark' : 'â˜€ï¸ Light';
}

// ===== TYPEWRITER =====
const storyText = "En un rincÃ³n olvidado del mundo digital, una seÃ±al se enciende... algo quiere despertar. Un fragmento de energÃ­a antigua â€” de un tiempo en que la informaciÃ³n fluÃ­a como rÃ­os de luz y las conexiones eran puras â€” espera a alguien que le dÃ© forma. Ese alguien... eres tÃº.";
let typewriterStarted = false;

function startTypewriter() {
  if (typewriterStarted) return;
  typewriterStarted = true;
  const output = document.getElementById('typewriter-output');
  const cursor = document.getElementById('typewriter-cursor');
  const continueBtn = document.getElementById('typewriter-continue');
  output.textContent = '';
  let i = 0;

  function type() {
    if (i < storyText.length) {
      output.textContent += storyText[i];
      i++;
      setTimeout(type, 40);
    } else {
      cursor.style.display = 'none';
      continueBtn.classList.add('visible');
    }
  }
  type();
}

// ===== CAROUSEL =====
const types = [
  { name: 'Rayo', title: 'El Impulso', sprite: 'âš¡', desc: 'La corriente que alguna vez fue el flujo limpio de informaciÃ³n. Veloz, directo, chispeante.', class: 'type-rayo' },
  { name: 'Flama', title: 'La PasiÃ³n', sprite: 'ðŸ”¥', desc: 'El calor que alguna vez fue la conexiÃ³n genuina entre seres. CÃ¡lido, emotivo, intenso.', class: 'type-flama' },
  { name: 'Hielo', title: 'La Memoria', sprite: 'â„ï¸', desc: 'Los archivos donde el conocimiento vivÃ­a eterno. Sabio, reflexivo, sereno.', class: 'type-hielo' },
];
let currentType = 0;

function setType(idx) {
  currentType = idx;
  const t = types[idx];
  const card = document.getElementById('carousel-card');
  card.className = 'carousel-card ' + t.class;
  document.getElementById('carousel-sprite').textContent = t.sprite;
  document.getElementById('carousel-name').textContent = t.name;
  document.getElementById('carousel-title').textContent = t.title;
  document.getElementById('carousel-desc').textContent = t.desc;
  document.getElementById('transition-sprite').textContent = t.sprite;

  // Update type particles
  const particles = document.getElementById('type-particles');
  particles.className = 'type-particles ' + t.class + '-particles';

  document.querySelectorAll('.carousel-dot').forEach((d, i) => {
    d.classList.toggle('active', i === idx);
  });
  checkAwaken();
}

function nextType() { setType((currentType + 1) % 3); }
function prevType() { setType((currentType + 2) % 3); }

// ===== NAME INPUT =====
function updateCharCount() {
  const input = document.getElementById('name-input');
  const count = document.getElementById('char-count');
  const len = input.value.length;
  count.textContent = len + '/15';
  count.className = 'creation-char-count';
  if (len >= 2 && len <= 15) count.classList.add('valid');
  else if (len > 0) count.classList.add('invalid');
  checkAwaken();
}

function checkAwaken() {
  const len = document.getElementById('name-input').value.trim().length;
  const btn = document.getElementById('awaken-btn');
  if (len >= 2 && len <= 15) {
    btn.classList.remove('disabled');
  } else {
    btn.classList.add('disabled');
  }
}

// ===== TITLE RUNE CIRCLE (generate on load) =====
(function() {
  const runes = ['áš±','áš²','áš¦','á›Š','á›','á›‰','á›—','áš¨','á›ƒ','á›ˆ'];
  const container = document.getElementById('title-rune-circle');
  container.innerHTML = '';
  runes.forEach((r, i) => {
    const span = document.createElement('span');
    span.className = 'rune-circle-char';
    span.textContent = r;
    span.style.transform = 'rotate(' + (i * 36) + 'deg)';
    container.appendChild(span);
  });
})();

// ===== LOADING SPARKS =====
(function() {
  const sparksContainer = document.getElementById('loading-sparks');
  let sparkCount = 0;
  const interval = setInterval(() => {
    if (sparkCount > 8) { clearInterval(interval); return; }
    const spark = document.createElement('div');
    spark.className = 'loading-spark';
    spark.style.left = (sparkCount * 12 + 5) + '%';
    spark.style.top = '50%';
    spark.style.setProperty('--sx', (Math.random() * 20 - 10) + 'px');
    spark.style.setProperty('--sy', (-10 - Math.random() * 20) + 'px');
    sparksContainer.appendChild(spark);
    sparkCount++;
    setTimeout(() => spark.remove(), 600);
  }, 280);
})();

// ===== TUTORIAL STEPS =====
const tutSteps = [
  { title: 'ðŸ‘‹ Meet Reggie', icon: 'ðŸ£', desc: 'Este es tu Regenmon. NaciÃ³ de un fragmento de energÃ­a antigua. CuÃ­dalo y crecerÃ¡.' },
  { title: 'ðŸ’¬ Chat', icon: 'ðŸ’¬', desc: 'Habla con Reggie. Cada conversaciÃ³n genuina fortalece su espÃ­ritu y tu vÃ­nculo.' },
  { title: 'ðŸŒ€ Care', icon: 'ðŸŒ€', desc: 'Purifica la energÃ­a corrupta. Cuida sus stats: EspÃ­ritu, Pulso y Esencia.' },
  { title: 'ðŸ“¸ Photos âœ¨', icon: 'ðŸ“·', desc: 'MuÃ©strale el mundo real. Las fotos generan resonancia emocional y fragmentos.', badge: true },
  { title: 'âš¡ Evolution âœ¨', icon: 'ðŸŒŸ', desc: 'Al acumular suficiente progreso, Reggie experimentarÃ¡ una Fractura â€” una evoluciÃ³n dramÃ¡tica.', badge: true },
];
let tutStep = 0;
function setTutStep(i) {
  tutStep = i;
  const s = tutSteps[i];
  document.getElementById('tut-title').innerHTML = s.title + (s.badge ? ' <span class="tutorial-step-badge">âœ¨ Nuevo</span>' : '');
  document.getElementById('tut-icon').textContent = s.icon;
  document.getElementById('tut-desc').textContent = s.desc;
  document.querySelectorAll('.tutorial-dot').forEach((d, j) => {
    d.className = 'tutorial-dot' + (j === i ? ' active' : j < i ? ' completed' : '');
  });
  document.getElementById('tut-next').textContent = i === tutSteps.length - 1 ? 'Â¡Listo! â–¶' : 'Siguiente â–¶';
}
function nextTutStep() {
  if (tutStep < tutSteps.length - 1) setTutStep(tutStep + 1);
  else showScreen('world');
}
</script>

</body>
</html>
